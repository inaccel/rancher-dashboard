(self["webpackChunkdashboard"]=self["webpackChunkdashboard"]||[]).push([[1917],{91835:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>i});var s=t(45522),l=t.n(s),o=t(67643),r=t.n(o),d=r()(l());d.push([e.id,".collapsible-card[data-v-0ab5e3ea]{min-width:570px;border-radius:5px;border:1px solid var(--sortable-table-top-divider)}.collapsible-card.isCollapsed .collapsible-card-header[data-v-0ab5e3ea]{border-bottom:none}.collapsible-card.isCollapsed .collapsible-card-body[data-v-0ab5e3ea]{visibility:hidden;display:none}.collapsible-card-header[data-v-0ab5e3ea]{background-color:var(--sortable-table-header-bg);border-bottom:1px solid var(--sortable-table-top-divider);border-top-left-radius:5px;border-top-right-radius:5px;padding:20px;justify-content:space-between;cursor:pointer}.collapsible-card-header[data-v-0ab5e3ea],.collapsible-card-header h2[data-v-0ab5e3ea]{display:flex;align-items:center}.collapsible-card-header h2 span.isTitleClickable[data-v-0ab5e3ea]:hover{text-decoration:underline}.collapsible-card-header>div[data-v-0ab5e3ea]{display:flex;justify-content:space-between;align-items:center}.collapsible-card-collapse-icon[data-v-0ab5e3ea]{color:#b7b8bb}.collapsible-card-body[data-v-0ab5e3ea]{padding:20px;transition:all .25s ease-in-out;visibility:visible;display:block}",""]);const i=d},50633:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>i});var s=t(45522),l=t.n(s),o=t(67643),r=t.n(o),d=r()(l());d.push([e.id,".compound-cluster-badge[data-v-fa6a8f44]{padding:4px 12px;border-radius:16px;display:flex;align-items:center;width:-moz-fit-content;width:fit-content;cursor:default}.compound-cluster-badge i[data-v-fa6a8f44]{font-size:16px;margin-right:6px}",""]);const i=d},36061:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>i});var s=t(45522),l=t.n(s),o=t(67643),r=t.n(o),d=r()(l());d.push([e.id,".fleet-dashboard[data-v-876539da]{min-height:100vh}.fleet-empty-dashboard[data-v-876539da]{flex:1;display:flex;align-items:center;justify-content:center;flex-direction:column;min-height:100%}.fleet-empty-dashboard .icon-fleet[data-v-876539da]{font-size:100px;color:var(--disabled-text)}.fleet-empty-dashboard>p>span[data-v-876539da]{color:var(--disabled-text)}.fleet-dashboard-data .title[data-v-876539da]{justify-content:space-between;min-height:48px}.fleet-dashboard-data .title[data-v-876539da],.fleet-dashboard-data .title>div[data-v-876539da]{display:flex;align-items:center}.fleet-dashboard-data .title>div p[data-v-876539da]{color:var(--primary)}.fleet-dashboard-data .title>div p[data-v-876539da]:hover{text-decoration:underline;cursor:pointer}.fleet-dashboard-data .title-footnote[data-v-876539da]{display:flex;align-items:center;color:var(--darker)}.fleet-dashboard-data .header-icons[data-v-876539da]{display:flex;align-items:center}.fleet-dashboard-data .header-icons p[data-v-876539da]{margin-right:30px;display:flex;align-items:center}.fleet-dashboard-data .header-icons p>span[data-v-876539da]{color:var(--disabled-text)}.fleet-dashboard-data .header-icons p>span>span[data-v-876539da]{color:var(--body-text)}.fleet-dashboard-data .header-icons p i[data-v-876539da]{color:var(--disabled-text);font-size:20px;margin-right:10px}",""]);const i=d},91917:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>Q});var s=t(20641),l=t(90033);const o=e=>((0,s.Qi)("data-v-876539da"),e=e(),(0,s.jt)(),e),r={class:"fleet-dashboard"},d={key:2,class:"fleet-empty-dashboard"},i=o((()=>(0,s.Lk)("i",{class:"icon-fleet mb-30"},null,-1))),n={class:"mb-30"},c=["href"],p=o((()=>(0,s.Lk)("i",{class:"icon icon-external-link"},null,-1))),u={class:"mb-30"},b={key:3,class:"fleet-dashboard-data"},g={class:"title"},h={key:0,class:"title-footnote"},v={key:0},y={class:"header-icons"},f=o((()=>(0,s.Lk)("i",{class:"icon icon-repository"},null,-1))),m=o((()=>(0,s.Lk)("i",{class:"icon icon-storage"},null,-1))),k=o((()=>(0,s.Lk)("i",{class:"icon icon-folder"},null,-1))),C={key:0},x={key:0};function j(e,a,t,o,j,E){const W=(0,s.g2)("Loading"),R=(0,s.g2)("FleetNoWorkspaces"),I=(0,s.g2)("router-link"),T=(0,s.g2)("t"),A=(0,s.g2)("CompoundStatusBadge"),D=(0,s.g2)("ResourceTable"),S=(0,s.g2)("CollapsibleCard");return(0,s.uX)(),(0,s.CE)("div",r,[e.$fetchState.pending?((0,s.uX)(),(0,s.Wv)(W,{key:0})):j.fleetWorkspacesData.length?j.gitRepos.length?((0,s.uX)(),(0,s.CE)("div",b,[(0,s.Lk)("div",g,[(0,s.Lk)("h1",null,[(0,s.bF)(T,{k:"fleet.dashboard.pageTitle"})]),(0,s.eW)(),(0,s.Lk)("div",null,[E.areAllCardsExpanded?((0,s.uX)(),(0,s.CE)("p",{key:0,onClick:a[0]||(a[0]=e=>E.toggleAll("collapse"))},(0,l.toDisplayString)(e.t("fleet.dashboard.collapseAll")),1)):((0,s.uX)(),(0,s.CE)("p",{key:1,onClick:a[1]||(a[1]=e=>E.toggleAll("expand"))},(0,l.toDisplayString)(e.t("fleet.dashboard.expandAll")),1))])]),(0,s.eW)(),E.emptyWorkspaces.length?((0,s.uX)(),(0,s.CE)("div",h,[(0,s.Lk)("p",null,(0,l.toDisplayString)(e.t("fleet.dashboard.thereIsMore",{count:E.emptyWorkspaces.length}))+": ",1),(0,s.eW)(),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(E.emptyWorkspaces,((e,a)=>((0,s.uX)(),(0,s.CE)("p",{key:a},[(0,s.eW)((0,l.toDisplayString)(e.nameDisplay),1),a!=E.emptyWorkspaces.length-1?((0,s.uX)(),(0,s.CE)("span",v,", ")):(0,s.Q3)("",!0)])))),128))])):(0,s.Q3)("",!0),(0,s.eW)(),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(E.workspacesData,((a,t)=>((0,s.uX)(),(0,s.Wv)(S,{key:t,class:"mt-20 mb-40",title:`${e.t("resourceDetail.masthead.workspace")}: ${a.nameDisplay}`,"is-collapsed":j.isCollapsed[a.id],"is-title-clickable":!0,"data-testid":`collapsible-card-${a.id}`,onToggleCollapse:e=>E.toggleCollapse(e,a.id),onTitleClick:e=>E.setWorkspaceFilterAndLinkToGitRepo(a.id)},{"header-right":(0,s.k6)((()=>[(0,s.Lk)("div",y,[(0,s.Lk)("p",null,[f,(0,s.eW)(),(0,s.Lk)("span",null,[(0,s.eW)((0,l.toDisplayString)(e.t("tableHeaders.repositories"))+": ",1),(0,s.Lk)("span",null,(0,l.toDisplayString)(a.counts.gitRepos),1)])]),(0,s.eW)(),(0,s.Lk)("p",null,[m,(0,s.eW)(),(0,s.Lk)("span",null,[(0,s.eW)((0,l.toDisplayString)(e.t("tableHeaders.clusters"))+": ",1),(0,s.Lk)("span",null,(0,l.toDisplayString)(a.counts.clusters),1)])]),(0,s.eW)(),(0,s.Lk)("p",null,[k,(0,s.eW)(),(0,s.Lk)("span",null,[(0,s.eW)((0,l.toDisplayString)(e.t("tableHeaders.clusterGroups"))+": ",1),(0,s.Lk)("span",null,(0,l.toDisplayString)(a.counts.clusterGroups),1)])])])])),content:(0,s.k6)((()=>[(0,s.bF)(D,{schema:j.schema,headers:j.headers,rows:a.repos,"key-field":"_key",search:!1,"table-actions":!1},{"cell:clustersReady":(0,s.k6)((({row:e})=>["namespace"===a.type?((0,s.uX)(),(0,s.CE)("span",C," - ")):((0,s.uX)(),(0,s.Wv)(A,{key:1,"data-testid":"clusters-ready","tooltip-text":E.getTooltipInfo("clusters",e),"badge-class":E.getStatusInfo("clusters",e).badgeClass,icon:E.getStatusInfo("clusters",e).icon,value:E.getBadgeValue("clusters",e)},null,8,["tooltip-text","badge-class","icon","value"]))])),"cell:bundlesReady":(0,s.k6)((({row:e})=>["namespace"===a.type?((0,s.uX)(),(0,s.CE)("span",x," - ")):((0,s.uX)(),(0,s.Wv)(A,{key:1,"data-testid":"bundles-ready","tooltip-text":E.getTooltipInfo("bundles",e),"badge-class":E.getStatusInfo("bundles",e).badgeClass,icon:E.getStatusInfo("bundles",e).icon,value:E.getBadgeValue("bundles",e)},null,8,["tooltip-text","badge-class","icon","value"]))])),"cell:resourcesReady":(0,s.k6)((({row:e})=>[(0,s.bF)(A,{"data-testid":"resources-ready","tooltip-text":E.getTooltipInfo("resources",e),"badge-class":E.getStatusInfo("resources",e).badgeClass,icon:E.getStatusInfo("resources",e).icon,value:E.getBadgeValue("resources",e)},null,8,["tooltip-text","badge-class","icon","value"])])),"cell:target":(0,s.k6)((({row:e})=>[(0,s.eW)((0,l.toDisplayString)(e.targetInfo.modeDisplay),1)])),_:2},1032,["schema","headers","rows"])])),_:2},1032,["title","is-collapsed","data-testid","onToggleCollapse","onTitleClick"])))),128))])):((0,s.uX)(),(0,s.CE)("div",d,[i,(0,s.eW)(),(0,s.Lk)("h1",null,(0,l.toDisplayString)(e.t("fleet.dashboard.welcome")),1),(0,s.eW)(),(0,s.Lk)("p",n,[(0,s.Lk)("span",null,(0,l.toDisplayString)(e.t("fleet.dashboard.gitOpsScale")),1),(0,s.eW)(),(0,s.Lk)("a",{href:e.t("fleet.dashboard.learnMoreLink"),target:"_blank",rel:"noopener noreferrer nofollow"},[(0,s.eW)((0,l.toDisplayString)(e.t("fleet.dashboard.learnMore"))+" ",1),p],8,c)]),(0,s.eW)(),j.permissions.gitRepos?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[(0,s.Lk)("h3",u,(0,l.toDisplayString)(e.t("fleet.dashboard.noRepo",null,!0)),1),(0,s.eW)(),(0,s.bF)(I,{to:j.getStartedLink,class:"btn role-secondary"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.toDisplayString)(e.t("fleet.dashboard.getStarted")),1)])),_:1},8,["to"])],64)):(0,s.Q3)("",!0)])):((0,s.uX)(),(0,s.Wv)(R,{key:1,"can-view":j.permissions.workspaces},null,8,["can-view"]))])}var E=t(66278),W=t(45848),R=t(97486),I=t(39147),T=t(45016);const A={class:"mb-0"},D={class:"collapsible-card-body"};function S(e,a,t,o,r,d){return(0,s.uX)(),(0,s.CE)("div",{class:(0,l.normalizeClass)(["collapsible-card",{isCollapsed:t.isCollapsed}])},[(0,s.Lk)("div",{class:"collapsible-card-header",onClick:a[1]||(a[1]=(...e)=>d.toggleCollapse&&d.toggleCollapse(...e))},[(0,s.Lk)("h2",A,[(0,s.Lk)("span",{class:(0,l.normalizeClass)({isTitleClickable:t.isTitleClickable}),onClick:a[0]||(a[0]=(...e)=>d.titleClick&&d.titleClick(...e))},(0,l.toDisplayString)(t.title),3)]),(0,s.eW)(),(0,s.Lk)("div",null,[(0,s.RG)(e.$slots,"header-right",{},void 0,!0),(0,s.eW)(),(0,s.Lk)("i",{class:(0,l.normalizeClass)(["collapsible-card-collapse-icon",{"icon-chevron-up":!t.isCollapsed,"icon-chevron-down":t.isCollapsed}])},null,2)])]),(0,s.eW)(),(0,s.Lk)("div",D,[(0,s.RG)(e.$slots,"content",{},void 0,!0)])],2)}const L={name:"CollapsibleCard",emits:["toggleCollapse","titleClick"],props:{isCollapsed:{type:Boolean,default:!1},title:{type:String,default:""},isTitleClickable:{type:Boolean,default:!1}},methods:{toggleCollapse(){this.$emit("toggleCollapse",!this.isCollapsed)},titleClick(e){this.isTitleClickable&&(e.stopPropagation(),this.$emit("titleClick"))}}};t(88637);var N=t(66262);const _=(0,N.A)(L,[["render",S],["__scopeId","data-v-0ab5e3ea"]]),w=_;var $=t(2803);function O(e,a,t,o,r,d){const i=(0,s.gN)("clean-tooltip");return(0,s.bo)(((0,s.uX)(),(0,s.CE)("div",{class:(0,l.normalizeClass)(["compound-cluster-badge",`bg-${t.badgeClass}`])},[t.icon?((0,s.uX)(),(0,s.CE)("i",{key:0,class:(0,l.normalizeClass)(`icon-${t.icon}`)},null,2)):(0,s.Q3)("",!0),(0,s.eW)(),(0,s.Lk)("span",null,(0,l.toDisplayString)(t.value),1)],2)),[[i,t.tooltipText,void 0,{bottom:!0}]])}const P={name:"CompoundStatusBadge",props:{tooltipText:{type:String,default:""},badgeClass:{type:String,default:""},icon:{type:String,default:""},value:{type:String,default:""}}};t(46103);const X=(0,N.A)(P,[["render",O],["__scopeId","data-v-fa6a8f44"]]),H=X;var K=t(87445),V=t(68497),B=t(26358),M=t(83762),F=t(19572),G=t(45363),U=t(96763);const Y={name:"FleetDashboard",components:{Loading:T.A,ResourceTable:$.A,CollapsibleCard:w,CompoundStatusBadge:H,FleetNoWorkspaces:M.A},async fetch(){const e=await(0,K.eT)({fleetWorkspaces:{inStoreType:"management",type:W.Hs.WORKSPACE,schemaValidator:e=>!!e?.links?.collection},clusterGroups:{inStoreType:"management",type:W.Hs.CLUSTER_GROUP},allBundles:{inStoreType:"management",type:W.Hs.BUNDLE,opt:{excludeFields:["metadata.managedFields","spec.resources"]}},gitRepos:{inStoreType:"management",type:W.Hs.GIT_REPO},fleetClusters:{inStoreType:"management",type:W.Hs.CLUSTER}},this.$store);this.gitRepos=e.gitRepos,this.fleetWorkspacesData=e.fleetWorkspaces||[];try{const e=await(0,K.RS)({workspaces:{type:W.Hs.WORKSPACE},gitRepos:{type:W.Hs.GIT_REPO,schemaValidator:e=>e.resourceMethods.includes("PUT")}},this.$store.getters);this.permissions=e}catch(a){U.error(a)}},data(){return{admissableAreas:["clusters","bundles","resources"],headers:[{name:"name",labelKey:"tableHeaders.repoName",value:"nameDisplay",sort:["nameSort"],formatter:"LinkDetail",canBeVariable:!0},{name:"clustersReady",labelKey:"tableHeaders.clustersReady",value:"status.readyClusters",sort:"status.readyClusters",search:!1},{name:"bundlesReady",labelKey:"tableHeaders.bundlesReady",value:"status.readyClusters",sort:"status.readyClusters",search:!1},{name:"resourcesReady",labelKey:"tableHeaders.resourcesReady",value:"status.resourceCounts.ready",sort:"status.resourceCounts.ready"}],schema:{},allBundles:[],gitRepos:[],fleetWorkspacesData:[],isCollapsed:{},permissions:{},getStartedLink:{name:"c-cluster-product-resource-create",params:{product:F.NAME,resource:W.Hs.GIT_REPO}}}},computed:{...(0,E.aH)(["workspace","allNamespaces"]),fleetWorkspaces(){return this.fleetWorkspacesData?.length?this.fleetWorkspacesData:this.allNamespaces.filter((e=>e.metadata.annotations[V.IY]===R.WORKSPACE)).map((e=>{const a=(0,B.WP)(this.gitRepos,"metadata.namespace",e.id);return{...e,counts:{clusters:"-",clusterGroups:"-",gitRepos:a.length},repos:a,nameDisplay:e.id}}))},workspacesData(){return this.fleetWorkspaces.filter((e=>e.repos&&e.repos.length))},emptyWorkspaces(){return this.fleetWorkspaces.filter((e=>!e.repos||!e.repos.length))},areAllCardsExpanded(){return Object.keys(this.isCollapsed).every((e=>!this.isCollapsed[e]))}},methods:{setWorkspaceFilterAndLinkToGitRepo(e){this.$store.commit("updateWorkspace",{value:e,getters:this.$store.getters}),this.$store.dispatch("prefs/set",{key:R.WORKSPACE,value:e}),this.$router.push({name:"c-cluster-product-resource",params:{product:F.NAME,resource:W.Hs.GIT_REPO}})},getStatusInfo(e,a){const t={badgeClass:`${I.xj[I.jv.NOT_READY].color} badge-class-default`,icon:I.xj[I.jv.NOT_READY].compoundIcon};return this.getBadgeClassAndIcon(e,a)||t},getBadgeClassAndIcon(e,a){let t;if(!this.admissableAreas.includes(e))return!1;if("clusters"===e){if(a.clusterInfo?.ready===a.clusterInfo?.total&&a.clusterInfo?.ready)return{badgeClass:I.xj[I.jv.ACTIVE].color,icon:I.xj[I.jv.ACTIVE].compoundIcon}}else"bundles"===e?t=a.bundles:"resources"===e&&(t=a.status?.resources);return t?.length&&t?.every((e=>e.state?.toLowerCase()===I.jv.ACTIVE))?{badgeClass:I.xj[I.jv.ACTIVE].color?I.xj[I.jv.ACTIVE].color:`${I.xj[I.jv.UNKNOWN].color} bg-unmapped-state`,icon:I.xj[I.jv.ACTIVE].compoundIcon?I.xj[I.jv.ACTIVE].compoundIcon:`${I.xj[I.jv.UNKNOWN].compoundIcon} unmapped-icon`}:t?.length&&t?.some((e=>e.state?.toLowerCase()===I.jv.ERR_APPLIED))?{badgeClass:I.xj[I.jv.ERR_APPLIED].color?I.xj[I.jv.ERR_APPLIED].color:`${I.xj[I.jv.UNKNOWN].color} bg-unmapped-state`,icon:I.xj[I.jv.ERR_APPLIED].compoundIcon?I.xj[I.jv.ERR_APPLIED].compoundIcon:`${I.xj[I.jv.UNKNOWN].compoundIcon} unmapped-icon`}:t?.length&&t?.some((e=>e.state?.toLowerCase()===I.jv.NOT_READY))?{badgeClass:I.xj[I.jv.NOT_READY].color?I.xj[I.jv.NOT_READY].color:`${I.xj[I.jv.UNKNOWN].color} bg-unmapped-state`,icon:I.xj[I.jv.NOT_READY].compoundIcon?I.xj[I.jv.NOT_READY].compoundIcon:`${I.xj[I.jv.UNKNOWN].compoundIcon} unmapped-icon`}:"resources"===e&&a.status?.resourceCounts?.desiredReady===a.status?.resourceCounts?.ready&&a.status?.resourceCounts?.desiredReady?{badgeClass:I.xj[I.jv.ACTIVE].color,icon:I.xj[I.jv.ACTIVE].compoundIcon}:{badgeClass:`${I.xj[I.jv.NOT_READY].color} badge-class-area-${e}`,icon:I.xj[I.jv.NOT_READY].compoundIcon}},getTooltipInfo(e,a){let t;return this.admissableAreas.includes(e)?("clusters"===e?t="":"bundles"===e?t=a.bundles:"resources"===e&&(t=a.status?.resources),t?.length?this.generateTooltipData(t):""):{}},generateTooltipData(e){const a={};let t="";return e.forEach((e=>{a[e.state]||(a[e.state]=0),a[e.state]++})),Object.keys(a).forEach((e=>{t+=`${(0,I.C5)(e)}: ${a[e]}<br>`})),t},getBadgeValue(e,a){let t;return this.admissableAreas.includes(e)?"clusters"===e?`${a.clusterInfo.ready}/${a.clusterInfo.total}`:("bundles"===e?t=(0,G.TD)(a.bundlesReady?.length,a.bundles?.length):"resources"===e&&(t=(0,G.TD)(a.status?.resourceCounts?.ready,a.status?.resourceCounts?.desiredReady)),t):"N/A"},toggleCollapse(e,a){this.isCollapsed[a]=e},toggleAll(e){const a="expand"!==e;Object.keys(this.isCollapsed).forEach((e=>{this.isCollapsed[e]=a}))}},watch:{fleetWorkspaces(e){e?.filter((e=>e.repos?.length)).forEach((e=>{this.isCollapsed[e.id]=!1}))}}};t(20955);const z=(0,N.A)(Y,[["render",j],["__scopeId","data-v-876539da"]]),Q=z},88637:(e,a,t)=>{var s=t(91835);s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);var l=t(99548).A;l("f6e0575a",s,!0,{sourceMap:!1,shadowMode:!1})},46103:(e,a,t)=>{var s=t(50633);s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);var l=t(99548).A;l("28b48b65",s,!0,{sourceMap:!1,shadowMode:!1})},20955:(e,a,t)=>{var s=t(36061);s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);var l=t(99548).A;l("c07715f0",s,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=1917.1a623f24.js.map