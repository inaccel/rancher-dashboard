(self["webpackChunkdashboard"]=self["webpackChunkdashboard"]||[]).push([[3368],{9518:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var a=r(45522),s=r.n(a),o=r(67643),c=r.n(o),n=c()(s());n.push([e.id,".project-namespaces[data-v-6a828e6f]  .project-namespaces-table table{table-layout:fixed}.project-namespaces[data-v-6a828e6f]  .project-name{line-height:30px}.project-namespaces[data-v-6a828e6f]  .project-bar{display:flex;flex-direction:row;justify-content:space-between}.project-namespaces[data-v-6a828e6f]  .project-bar .group-tab{max-width:calc(100% - 230px)}.project-namespaces[data-v-6a828e6f]  .project-bar .project-name{display:flex;flex-direction:row;align-items:center}.project-namespaces[data-v-6a828e6f]  .project-bar .project-name span:first-child{padding-right:8px}.project-namespaces[data-v-6a828e6f]  .project-bar .project-name span:last-child{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.project-namespaces[data-v-6a828e6f]  .project-bar.has-description .right{margin-top:5px}.project-namespaces[data-v-6a828e6f]  .project-bar.has-description .group-tab,.project-namespaces[data-v-6a828e6f]  .project-bar.has-description .group-tab:after{height:50px}.project-namespaces[data-v-6a828e6f]  .project-bar.has-description .group-tab:after{right:-20px}.project-namespaces[data-v-6a828e6f]  .project-bar.has-description .group-tab .description{margin-top:-20px}.project-namespaces[data-v-6a828e6f]  .namespace-name{display:flex;align-items:center}.project-namespaces[data-v-6a828e6f]  .namespace-name .icon-istio{color:var(--primary)}",""]);const i=n},94664:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var a=r(45522),s=r.n(a),o=r(67643),c=r.n(o),n=c()(s());n.push([e.id,".psa-tooltip{margin:3px 0;padding:0 8px 0 22px}",""]);const i=n},1978:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(20641);const s={key:0};function o(e,t,r,o,c,n){return c.extensionData.length?((0,a.uX)(),(0,a.CE)("div",s,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(c.extensionData,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:`extensionData${r.location}${t}`},[((0,a.uX)(),(0,a.Wv)((0,a.$y)(e.component),{resource:r.resource},null,8,["resource"]))])))),128))])):(0,a.Q3)("",!0)}var c=r(76270);const n={name:"ExtensionPanel",props:{resource:{type:Object,default:()=>({})},type:{type:String,default:""},location:{type:String,default:""}},data(){return{extensionData:(0,c.A)(this,this.type,this.location,this.$route)}}};var i=r(66262);const p=(0,i.A)(n,[["render",o]]),l=p},43368:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>G});var a=r(20641),s=r(90033);function o(e,t,r,o,c,n){const i=(0,a.g2)("ExplorerProjectsNamespaces");return(0,a.uX)(),(0,a.Wv)(i,(0,s.normalizeProps)((0,a.Ng)(e.$attrs)),null,16)}const c={class:"project-namespaces outlet"},n={class:"group-tab"},i={class:"project-name"},p={key:0,class:"description text-muted text-small"},l={class:"right"},u={key:0},m={key:1,class:"text-muted"},d={class:"namespace-name"},h={key:1},j={key:2,class:"icon icon-istio ml-5"},g={key:3,class:"icon icon-lock ml-5"},f={class:"main-row"},b=["colspan"],y={class:"main-row"},v=["colspan"];function P(e,t,r,o,P,N){const w=(0,a.g2)("router-link"),L=(0,a.g2)("Masthead"),k=(0,a.g2)("ExtensionPanel"),C=(0,a.g2)("ButtonMultiAction"),S=(0,a.g2)("ResourceTable"),$=(0,a.g2)("MoveModal"),x=(0,a.gN)("clean-html"),A=(0,a.gN)("trim-whitespace"),E=(0,a.gN)("clean-tooltip");return(0,a.uX)(),(0,a.CE)("div",c,[(0,a.bF)(L,{schema:P.projectSchema,"type-display":e.t("projectNamespaces.label"),resource:P.MANAGEMENT.PROJECT,"favorite-resource":P.VIRTUAL_TYPES.PROJECT_NAMESPACES,"create-location":N.createProjectLocation,"create-button-label":e.t("projectNamespaces.createProject"),"show-incremental-loading-indicator":N.showIncrementalLoadingIndicator,"load-resources":P.loadResources,"load-indeterminate":P.loadIndeterminate},(0,a.eX)({_:2},[N.showCreateNsButton?{name:"extraActions",fn:(0,a.k6)((()=>[(0,a.bF)(w,{to:N.createNamespaceLocationFlatList(),class:"btn role-primary mr-10","data-testid":"create_project_namespaces"},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.toDisplayString)(e.t("projectNamespaces.createNamespace")),1)])),_:1},8,["to"])])),key:"0"}:void 0]),1032,["schema","type-display","resource","favorite-resource","create-location","create-button-label","show-incremental-loading-indicator","load-resources","load-indeterminate"]),(0,a.eW)(),(0,a.bF)(k,{resource:{},type:P.extensionType,location:P.extensionLocation},null,8,["type","location"]),(0,a.eW)(),(0,a.bF)(S,(0,a.v6)({ref:"table"},{...e.$attrs,class:null},{class:"table project-namespaces-table",schema:P.schema,headers:N.headers,rows:N.filteredRows,groupable:!0,"sort-generation-fn":N.sortGenerationFn,loading:N.loading,"group-tooltip":"resourceTable.groupBy.project","key-field":"_key"}),(0,a.eX)({"group-by":(0,a.k6)((t=>[(0,a.Lk)("div",{class:(0,s.normalizeClass)(["project-bar",{"has-description":N.projectDescription(t.group)}])},[(0,a.bo)(((0,a.uX)(),(0,a.CE)("div",n,[(0,a.bo)((0,a.Lk)("div",i,null,512),[[x,N.projectLabel(t.group)]]),(0,a.eW)(),N.projectDescription(t.group)?((0,a.uX)(),(0,a.CE)("div",p,(0,s.toDisplayString)(N.projectDescription(t.group)),1)):(0,a.Q3)("",!0)])),[[A]]),(0,a.eW)(),(0,a.Lk)("div",l,[N.isNamespaceCreatable&&(N.canSeeProjectlessNamespaces||t.group.key!==N.notInProjectKey)?((0,a.uX)(),(0,a.Wv)(w,{key:0,class:"create-namespace btn btn-sm role-secondary mr-5",to:N.createNamespaceLocation(t.group)},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.toDisplayString)(e.t("projectNamespaces.createNamespace")),1)])),_:2},1032,["to"])):(0,a.Q3)("",!0),(0,a.eW)(),(0,a.bF)(C,{class:"project-action mr-10",borderless:!0,invisible:!N.showProjectActionButton(t.group),onClick:e=>N.showProjectAction(e,t.group)},null,8,["invisible","onClick"])])],2)])),"cell:project":(0,a.k6)((({row:e})=>[e.project?((0,a.uX)(),(0,a.CE)("span",u,(0,s.toDisplayString)(e.project.nameDisplay),1)):((0,a.uX)(),(0,a.CE)("span",m,"â€“"))])),"cell:name":(0,a.k6)((({row:t})=>[(0,a.Lk)("div",d,[t.detailLocation&&!t.hideDetailLocation?((0,a.uX)(),(0,a.Wv)(w,{key:0,to:t.detailLocation},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.toDisplayString)(t.name),1)])),_:2},1032,["to"])):((0,a.uX)(),(0,a.CE)("span",h,(0,s.toDisplayString)(t.name),1)),(0,a.eW)(),t.injectionEnabled?(0,a.bo)(((0,a.uX)(),(0,a.CE)("i",j,null,512)),[[E,e.t("projectNamespaces.isIstioInjectionEnabled")]]):(0,a.Q3)("",!0),(0,a.eW)(),t.hasSystemLabels?(0,a.bo)(((0,a.uX)(),(0,a.CE)("i",g,null,512)),[[E,N.getPsaTooltip(t)]]):(0,a.Q3)("",!0)])])),"main-row:fake-empty":(0,a.k6)((({fullColspan:t})=>[(0,a.Lk)("tr",y,[(0,a.Lk)("td",{class:"empty text-center",colspan:t},(0,s.toDisplayString)(e.t("projectNamespaces.noProjectNoNamespaces")),9,v)])])),_:2},[(0,a.pI)(N.projectsWithoutNamespaces,((t,r)=>({name:N.slotName(t),fn:(0,a.k6)((({fullColspan:t})=>[(0,a.Lk)("tr",f,[(0,a.Lk)("td",{class:"empty text-center",colspan:t},(0,s.toDisplayString)(e.t("projectNamespaces.noNamespaces")),9,b)])]))})))]),1040,["schema","headers","rows","sort-generation-fn","loading"]),(0,a.eW)(),(0,a.bF)($,{onMoving:N.clearSelection},null,8,["onMoving"])])}var N=r(66278),w=r(2803),L=r(53806),k=r(26358),C=r(45848),S=r(77444),$=r(67576),x=r(1978),A=r(24718),E=r(97486),F=r(21735),M=r(68392),I=r(37014),T=r(84430),O=r(42838),W=r.n(O);const D={name:"ListProjectNamespace",components:{ExtensionPanel:x.A,Masthead:A.A,MoveModal:F.A,ResourceTable:w.A,ButtonMultiAction:M.A},mixins:[T.A],props:{createProjectLocationOverride:{type:Object,default:()=>null},createNamespaceLocationOverride:{type:Object,default:()=>null}},async fetch(){const e=this.$store.getters["currentStore"](C.CU);this.schema=this.$store.getters[`${e}/schemaFor`](C.CU),this.projectSchema=this.$store.getters["management/schemaFor"](C.Mc.PROJECT),this.schema&&(await this.$fetchType(C.CU),this.projects=await this.$store.dispatch("management/findAll",{type:C.Mc.PROJECT,opt:{force:!0}}))},data(){return{loadResources:[C.CU],loadIndeterminate:!0,schema:null,projects:[],projectSchema:null,extensionType:$.c7.PANEL,extensionLocation:$.W7.RESOURCE_LIST,MANAGEMENT:C.Mc,VIRTUAL_TYPES:C.cG,defaultCreateProjectLocation:{name:"c-cluster-product-resource-create",params:{product:this.$store.getters["currentProduct"].name,resource:C.Mc.PROJECT}}}},computed:{...(0,N.L8)(["currentCluster","currentProduct"]),namespaces(){const e=this.$store.getters["currentStore"](C.CU);return this.$store.getters[`${e}/all`](C.CU)},loading(){return!(!this.currentCluster||this.namespaces.length)&&this.$fetchState.pending},showIncrementalLoadingIndicator(){return this.perfConfig?.incrementalLoading?.enabled},isNamespaceCreatable(){return(this.schema?.collectionMethods||[]).includes("POST")},headers(){const e={name:"project",label:this.t("tableHeaders.project"),value:"project.nameDisplay",sort:["projectNameSort","nameSort"]};return[L.c4,L.o_,"none"===this.groupPreference?e:null,L.K].filter((e=>e))},projectIdsWithNamespaces(){const e=this.rows.map((e=>e.projectId)).filter((e=>e));return(0,k.sb)(e)},clusterProjects(){const e=this.currentCluster.id,t=this.$store.getters["management/all"](C.Mc.PROJECT);if(this.currentProduct?.customNamespaceFilter&&this.currentProduct?.inStore&&this.$store.getters[`${this.currentProduct.inStore}/filterProject`])return this.$store.getters[`${this.currentProduct.inStore}/filterProject`];const r=t.filter((t=>t.spec.clusterName===e));return r},projectsWithoutNamespaces(){return this.activeProjects.filter((e=>!this.projectIdsWithNamespaces.find((t=>e?.id?.endsWith(`/${t}`)))))},rowsWithFakeNamespaces(){const e=this.projectsWithoutNamespaces.map((e=>({groupByLabel:`resourceTable.groupLabel.notInAProject-${e.id}`,isFake:!0,mainRowKey:e.id,nameDisplay:e.spec?.displayName,project:e,availableActions:[]})));return this.showMockNotInProjectGroup&&e.push({groupByLabel:this.t("resourceTable.groupLabel.notInAProject"),mainRowKey:"fake-empty"}),[...this.rows,...e]},createProjectLocation(){return this.createProjectLocationOverride||this.defaultCreateProjectLocation},groupPreference:(0,E.mapPref)(E.GROUP_RESOURCES),activeNamespaceFilters(){return this.$store.getters["activeNamespaceFilters"]},activeProjectFilters(){const e={};for(const t of this.activeNamespaceFilters){const[r,a]=t.split("://",2);"project"===r&&(e[a]=!0)}return e},activeProjects(){const e=this.$store.getters["activeNamespaceFilters"];return e.includes(I.pF)&&0===Object.keys(this.activeProjectFilters).length?[]:this.userIsFilteringForSpecificNamespaceOrProject()?this.clusterProjects.filter((e=>{const t=e.id.split("/")[1];return!!this.activeProjectFilters[t]})):this.clusterProjects},activeNamespaces(){const e=this.$store.getters["namespaces"]();return this.namespaces.filter((t=>!!e[t.metadata.name]))},filteredRows(){return"none"===this.groupPreference?this.rows:this.rowsWithFakeNamespaces},rows(){return this.$store.getters["prefs/get"](E.ALL_NAMESPACES)?this.activeNamespaces:this.activeNamespaces.filter((e=>{const t=this.$store.getters["systemNamespaces"].includes(e.metadata.name),r=e.isSystem||e.isFleetManaged||t;return!this.currentProduct?.hideSystemResources||!r}))},canSeeProjectlessNamespaces(){return this.currentCluster.canUpdate},showMockNotInProjectGroup(){if(!this.canSeeProjectlessNamespaces)return!1;const e=!this.rows.some((e=>!e.project)),t=this.userIsFilteringForSpecificNamespaceOrProject();return!t&&e},notInProjectKey(){return this.$store.getters["i18n/t"]("resourceTable.groupLabel.notInAProject")},showCreateNsButton(){return"namespace"!==this.groupPreference}},methods:{getPsaTooltip(e){const t=e.psaTooltipsDescription,r=Object.values(t).sort().map((e=>`<li>${e}</li>`)).join(""),a=`<p>${this.t("podSecurityAdmission.name")}: </p>`;return`${a}<ul class="psa-tooltip">${r}</ul>`},userIsFilteringForSpecificNamespaceOrProject(){const e=this.$store.getters["namespaceFilters"];for(let t=0;t<e.length;t++){const r=e[t],a=r.split("://")[0];if("ns"===a||"project"===a)return!0}return!1},slotName(e){return`main-row:${e.id}`},createNamespaceLocation(e){const t=e.rows[0].project,r=this.createNamespaceLocationOverride?{...this.createNamespaceLocationOverride}:{name:"c-cluster-product-resource-create",params:{product:this.$store.getters["currentProduct"].name,resource:C.CU}};return r.query={[S.iJ]:t?.metadata.name},r},createNamespaceLocationFlatList(){const e=this.createNamespaceLocationOverride?{...this.createNamespaceLocationOverride}:{name:"c-cluster-product-resource-create",params:{product:this.$store.getters["currentProduct"]?.name,resource:C.CU}};return e.query={[S._N]:!0},e},showProjectAction(e,t){const r=t.rows[0].project;this.$store.commit("action-menu/show",{resources:[r],elem:e.target})},showProjectActionButton(e){const t=e.rows[0].project;return!!t},projectLabel(e){const t=e.rows[0];return t.isFake?W().sanitize(this.t("resourceTable.groupLabel.project",{name:t.project?.nameDisplay},!0),{ALLOWED_TAGS:["span"]}):t.groupByLabel},projectDescription(e){const t=e.rows[0].project;return t?.description},clearSelection(){this.$refs.table.clearSelection()},sortGenerationFn(){const e=(0,w.S)(this.schema,this.$store);return e+(this.showMockNotInProjectGroup?"-mock":"")}}};r(3380),r(6482);var _=r(66262);const R=(0,_.A)(D,[["render",P],["__scopeId","data-v-6a828e6f"]]),X=R,U={components:{ExplorerProjectsNamespaces:X}},B=(0,_.A)(U,[["render",o]]),G=B},3380:(e,t,r)=>{var a=r(9518);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals);var s=r(99548).A;s("c05cf60a",a,!0,{sourceMap:!1,shadowMode:!1})},6482:(e,t,r)=>{var a=r(94664);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals);var s=r(99548).A;s("2fc8cbe7",a,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=3368.edde41f4.js.map