{"version":3,"file":"js/352.1b479cc9.js","mappings":"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","sources":["webpack://dashboard/./shell/components/ExplorerMembers.vue?91b0","webpack://dashboard/./shell/pages/c/_cluster/_product/members/index.vue","webpack://dashboard/./shell/components/ExplorerMembers.vue","webpack://dashboard/./shell/components/ExplorerMembers.vue?75cf","webpack://dashboard/./shell/pages/c/_cluster/_product/members/index.vue?7f64","webpack://dashboard/./shell/components/ExplorerMembers.vue?2973"],"sourcesContent":["// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../node_modules/@vue/cli-service/node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/@vue/cli-service/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.role[data-v-005ac0af]{align-items:center;background-color:rgba(0,0,0,.05);border:1px solid var(--header-border);border-radius:5px;color:var(--tag-text);line-height:20px;padding:2px 5px;white-space:nowrap;display:inline-flex;margin-right:3px}.role-value.text-link-enabled[data-v-005ac0af]{cursor:pointer}.role-value.text-link-enabled[data-v-005ac0af]:hover{color:var(--primary)}.role-value+.icon-close[data-v-005ac0af]{margin-left:3px;cursor:pointer}.role-value+.icon-close[data-v-005ac0af]:hover{color:var(--primary)}.project-members[data-v-005ac0af]  .group-bar{display:flex;justify-content:space-between}.cluster-add[data-v-005ac0af]{justify-content:flex-end}`, \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","<script>\nimport ExplorerMembers from '@shell/components/ExplorerMembers';\nexport default { components: { ExplorerMembers } };\n</script>\n\n<template>\n  <ExplorerMembers v-bind=\"$attrs\" />\n</template>\n","<script>\nimport { MANAGEMENT, NORMAN, VIRTUAL_TYPES } from '@shell/config/types';\nimport ResourceTable from '@shell/components/ResourceTable';\nimport Masthead from '@shell/components/ResourceList/Masthead';\nimport { AGE, ROLE, STATE, PRINCIPAL } from '@shell/config/table-headers';\nimport { canViewClusterPermissionsEditor } from '@shell/components/form/Members/ClusterPermissionsEditor.vue';\nimport Banner from '@components/Banner/Banner.vue';\nimport Tabbed from '@shell/components/Tabbed/index.vue';\nimport Tab from '@shell/components/Tabbed/Tab.vue';\nimport SortableTable from '@shell/components/SortableTable';\nimport { mapGetters } from 'vuex';\nimport { canViewProjectMembershipEditor } from '@shell/components/form/Members/ProjectMembershipEditor.vue';\nimport { allHash } from '@shell/utils/promise';\n\n/**\n * Explorer members page.\n * Route: /c/local/explorer/members\n */\nexport default {\n  name: 'ExplorerMembers',\n\n  components: {\n    Banner,\n    Masthead,\n    ResourceTable,\n    Tabbed,\n    Tab,\n    SortableTable\n  },\n\n  props: {\n    // Cluster tole template binding create route - defaults to the explorer route\n    createLocationOverride: {\n      type:    Object,\n      default: () => {\n        return {\n          name:   'c-cluster-product-resource-create',\n          params: { resource: MANAGEMENT.CLUSTER_ROLE_TEMPLATE_BINDING }\n        };\n      }\n    }\n  },\n\n  async fetch() {\n    const clusterRoleTemplateBindingSchema = this.$store.getters[\n      `rancher/schemaFor`\n    ](NORMAN.CLUSTER_ROLE_TEMPLATE_BINDING);\n\n    const projectRoleTemplateBindingSchema = this.$store.getters['rancher/schemaFor'](NORMAN.PROJECT_ROLE_TEMPLATE_BINDING);\n\n    this['normanClusterRTBSchema'] = clusterRoleTemplateBindingSchema;\n    this['normanProjectRTBSchema'] = projectRoleTemplateBindingSchema;\n\n    if (clusterRoleTemplateBindingSchema) {\n      Promise.all([\n        this.$store.dispatch(`rancher/findAll`, { type: NORMAN.CLUSTER_ROLE_TEMPLATE_BINDING }, { root: true }),\n        this.$store.dispatch(`management/findAll`, { type: MANAGEMENT.CLUSTER_ROLE_TEMPLATE_BINDING })\n      ]).then(([normanBindings]) => {\n        this['normanClusterRoleTemplateBindings'] = normanBindings;\n        this.loadingClusterBindings = false;\n      });\n    }\n\n    if (projectRoleTemplateBindingSchema) {\n      this.$store.dispatch('rancher/findAll', { type: NORMAN.PROJECT_ROLE_TEMPLATE_BINDING }, { root: true })\n        .then((bindings) => {\n          this['projectRoleTemplateBindings'] = bindings;\n          this.loadingProjectBindings = false;\n        });\n    }\n\n    this.$store.dispatch('management/findAll', { type: MANAGEMENT.PROJECT })\n      .then((projects) => (this['projects'] = projects));\n\n    const hydration = {\n      normanPrincipals:  this.$store.dispatch('rancher/findAll', { type: NORMAN.PRINCIPAL }),\n      mgmt:              this.$store.dispatch(`management/findAll`, { type: MANAGEMENT.USER }),\n      mgmtRoleTemplates: this.$store.dispatch(`management/findAll`, { type: MANAGEMENT.ROLE_TEMPLATE }),\n    };\n\n    await allHash(hydration);\n  },\n\n  data() {\n    return {\n      schema: this.$store.getters[`management/schemaFor`](\n        MANAGEMENT.CLUSTER_ROLE_TEMPLATE_BINDING\n      ),\n      headers:        [STATE, PRINCIPAL, ROLE, AGE],\n      createLocation: {\n        ...this.createLocationOverride,\n        params: {\n          ...this.createLocationOverride.params,\n          cluster: this.$store.getters['currentCluster'].id\n        }\n      },\n      resource:                          MANAGEMENT.CLUSTER_ROLE_TEMPLATE_BINDING,\n      normanClusterRTBSchema:            null,\n      normanProjectRTBSchema:            null,\n      normanClusterRoleTemplateBindings: [],\n      projectRoleTemplateBindings:       [],\n      projects:                          [],\n      VIRTUAL_TYPES,\n      projectRoleTemplateColumns:        [\n        STATE,\n        {\n          name:      'member',\n          labeKey:   'generic.name',\n          value:     'principalId',\n          formatter: 'Principal'\n        },\n        {\n          name:     'role',\n          labelKey: 'tableHeaders.role',\n          value:    'roleTemplate.nameDisplay'\n        },\n      ],\n      loadingProjectBindings: true,\n      loadingClusterBindings: true\n    };\n  },\n\n  computed: {\n    ...mapGetters(['currentCluster']),\n    clusterRoleTemplateBindings() {\n      return this.normanClusterRoleTemplateBindings.map((b) => b.clusterroletemplatebinding) ;\n    },\n    filteredClusterRoleTemplateBindings() {\n      return this.clusterRoleTemplateBindings.filter(\n        (b) => b?.clusterName === this.$store.getters['currentCluster'].id\n      );\n    },\n    filteredProjects() {\n      return this.projects.reduce((all, p) => {\n        if (p?.spec?.clusterName === this.currentCluster.id) {\n          all[p.id] = p;\n        }\n\n        return all;\n      }, {});\n    },\n    filteredProjectRoleTemplateBindings() {\n      const out = this.projectRoleTemplateBindings.filter((rb) => {\n        const projectId = rb.projectId.replace(':', '/');\n\n        return !!this.filteredProjects[projectId];\n      });\n\n      return out;\n    },\n    projectsWithoutRoles() {\n      const inUse = this.filteredProjectRoleTemplateBindings.reduce((projects, binding) => {\n        const thisProjectId = (binding.projectId || '').replace(':', '/');\n\n        if (!projects.includes(thisProjectId)) {\n          projects.push(thisProjectId);\n        }\n\n        return projects;\n      }, []);\n\n      return Object.keys(this.filteredProjects).reduce((all, projectId) => {\n        const project = this.filteredProjects[projectId];\n\n        if ( !inUse.includes(projectId)) {\n          all.push(project);\n        }\n\n        return all;\n      }, []);\n    },\n\n    // We're using this because we need to show projects as groups even if the project doesn't have any role bindings\n    rowsWithFakeProjects() {\n      const fakeRows = this.projectsWithoutRoles.map((project) => {\n        return {\n          groupByLabel:     `${ ('resourceTable.groupLabel.notInAProject') }-${ project.id }`,\n          isFake:           true,\n          mainRowKey:       project.id,\n          nameDisplay:      project.spec?.displayName, // Enable filtering by the project name\n          project,\n          availableActions: [],\n          projectId:        project.id\n        };\n      });\n\n      // We need to group each of the TemplateRoleBindings by the user + project\n      const userRoles = [...fakeRows, ...this.filteredProjectRoleTemplateBindings].reduce((rows, curr) => {\n        const {\n          userId, groupPrincipalId, roleTemplate, projectId\n        } = curr;\n\n        const userOrGroup = userId || groupPrincipalId;\n\n        if (!userOrGroup) {\n          return rows;\n        }\n\n        const userOrGroupKey = userOrGroup + projectId;\n\n        if (!rows[userOrGroupKey] ) {\n          rows[userOrGroupKey] = curr;\n          rows[userOrGroupKey].allRoles = [];\n        }\n\n        if (roleTemplate) {\n          rows[userOrGroupKey].allRoles.push(curr.roleTemplate);\n        }\n\n        return rows;\n      }, {});\n\n      return Object.values(userRoles);\n    },\n    canManageMembers() {\n      return canViewClusterPermissionsEditor(this.$store);\n    },\n    canManageProjectMembers() {\n      return canViewProjectMembershipEditor(this.$store);\n    },\n    isLocal() {\n      return this.$store.getters['currentCluster'].isLocal;\n    },\n    canEditProjectMembers() {\n      return this.normanProjectRTBSchema?.collectionMethods.find((x) => x.toLowerCase() === 'post');\n    },\n    canEditClusterMembers() {\n      return this.normanClusterRTBSchema?.collectionMethods.find((x) => x.toLowerCase() === 'post');\n    },\n  },\n  methods: {\n    getMgmtProjectId(group) {\n      return group.group.key.replace(':', '/');\n    },\n    getMgmtProject(group) {\n      return this.$store.getters['management/byId'](MANAGEMENT.PROJECT, this.getMgmtProjectId(group));\n    },\n    getProjectLabel(group) {\n      return this.getMgmtProject(group)?.spec?.displayName;\n    },\n    addProjectMember(group) {\n      this.$store.dispatch('cluster/promptModal', {\n        component:      'AddProjectMemberDialog',\n        componentProps: {\n          projectId:   group.group.key.replace('/', ':'),\n          saveInModal: true\n        },\n        modalSticky: true\n      });\n    },\n\n    getProjectRoleBinding(row, role) {\n      // Each row is a combination of project, role and user/group\n      // So find the specfic roleBindingTemplate corresponding to the specific project, role + user/group\n      const userOrGroupKey = row.userId ? 'userId' : 'groupPrincipalId';\n\n      return this.projectRoleTemplateBindings.find((r) => {\n        return r.projectId === row.projectId && r.roleTemplateId === role.id && r[userOrGroupKey] === row[userOrGroupKey];\n      });\n    },\n\n    async removeRole(row, role, event) {\n      const resource = this.getProjectRoleBinding(row, role);\n\n      await resource.promptRemove();\n    },\n\n    viewRoleInAPI(row, role) {\n      const resource = this.getProjectRoleBinding(row, role);\n\n      if (resource?.canViewInApi) {\n        resource.viewInApi();\n      }\n    },\n    slotName(project) {\n      return `main-row:${ project.id }`;\n    },\n  }\n};\n</script>\n\n<template>\n  <div class=\"project-members\">\n    <Masthead\n      :schema=\"schema\"\n      :resource=\"resource\"\n      :favorite-resource=\"VIRTUAL_TYPES.CLUSTER_MEMBERS\"\n      :create-location=\"createLocation\"\n      :create-button-label=\"t('members.createActionLabel')\"\n      :is-creatable=\"false\"\n      :type-display=\"t('members.clusterAndProject')\"\n    />\n    <Banner\n      v-if=\"isLocal\"\n      color=\"error\"\n      :label=\"t('members.localClusterWarning')\"\n    />\n    <Tabbed>\n      <Tab\n        name=\"cluster-membership\"\n        :label=\"t('members.clusterMembership')\"\n      >\n        <div\n          v-if=\"canEditClusterMembers\"\n          class=\"row mb-10 cluster-add\"\n        >\n          <router-link\n            :to=\"createLocation\"\n            class=\"btn role-primary pull-right\"\n          >\n            {{ t('members.createActionLabel') }}\n          </router-link>\n        </div>\n        <ResourceTable\n          :schema=\"schema\"\n          :headers=\"headers\"\n          :rows=\"filteredClusterRoleTemplateBindings\"\n          :groupable=\"true\"\n          :show-grouping=\"true\"\n          :namespaced=\"false\"\n          :loading=\"$fetchState.pending || !currentCluster || loadingClusterBindings\"\n          sub-search=\"subSearch\"\n          :sub-fields=\"['nameDisplay']\"\n        />\n      </Tab>\n      <Tab\n        v-if=\"canManageProjectMembers\"\n        name=\"project-membership\"\n        :label=\"t('members.projectMembership')\"\n      >\n        <SortableTable\n          group-by=\"projectId\"\n          :loading=\"$fetchState.pending || !currentCluster || loadingProjectBindings\"\n          :rows=\"rowsWithFakeProjects\"\n          :headers=\"projectRoleTemplateColumns\"\n          :table-actions=\"false\"\n          :row-actions=\"false\"\n        >\n          <template #group-by=\"group\">\n            <div class=\"group-bar\">\n              <div\n                v-trim-whitespace\n                class=\"group-tab\"\n              >\n                <div\n                  v-clean-html=\"getProjectLabel(group)\"\n                  class=\"project-name\"\n                />\n              </div>\n              <div class=\"right\">\n                <button\n                  v-if=\"canEditProjectMembers\"\n                  type=\"button\"\n                  class=\"create-namespace btn btn-sm role-secondary mr-10 right\"\n                  @click=\"addProjectMember(group)\"\n                >\n                  {{ t('members.createActionLabel') }}\n                </button>\n              </div>\n            </div>\n          </template>\n          <template\n            #cell:role=\"{row}\"\n          >\n            <span\n              v-for=\"(role, j) in row.allRoles\"\n              :key=\"j\"\n              ref=\"value\"\n              :data-testid=\"`role-value-${j}`\"\n              class=\"role\"\n            >\n              <span\n                class=\"role-value\"\n                :class=\"{'text-link-enabled' : row.canViewInApi}\"\n                @click=\"viewRoleInAPI(row, role)\"\n              >\n                {{ role.nameDisplay }}\n              </span>\n              <i\n                class=\"icon icon-close\"\n                :data-testid=\"`role-values-close-${j}`\"\n                @click=\"removeRole(row, role, $event)\"\n              />\n            </span>\n          </template>\n          <template\n            v-for=\"(project, i) in projectsWithoutRoles\"\n            :key=\"i\"\n            v-slot:[slotName(project)]\n          >\n            <tr\n              class=\"main-row\"\n            >\n              <td\n                class=\"empty text-center\"\n                colspan=\"100%\"\n              >\n                {{ t('members.noRolesAssigned') }}\n              </td>\n            </tr>\n          </template>\n        </SortableTable>\n      </Tab>\n    </Tabbed>\n  </div>\n</template>\n\n<style lang='scss' scoped>\n\n.role {\n  align-items: center;\n    background-color: rgba(0, 0, 0, 0.05);\n    border: 1px solid var(--header-border);\n    border-radius: 5px;\n    color: var(--tag-text);\n    line-height: 20px;\n    padding: 2px 5px;\n    white-space: nowrap;\n    display: inline-flex;\n    margin-right: 3px;\n}\n\n.role-value {\n  &.text-link-enabled {\n    cursor: pointer;\n    &:hover {\n      color: var(--primary);\n    }\n  }\n  + .icon-close {\n    margin-left: 3px;\n    cursor: pointer;\n    &:hover {\n      color: var(--primary);\n    }\n  }\n}\n\n.project-members {\n  & :deep() .group-bar{\n    display: flex;\n    justify-content: space-between;\n  }\n}\n.cluster-add {\n  justify-content: flex-end;\n}\n</style>\n","import { render } from \"./ExplorerMembers.vue?vue&type=template&id=005ac0af&scoped=true\"\nimport script from \"./ExplorerMembers.vue?vue&type=script&lang=js\"\nexport * from \"./ExplorerMembers.vue?vue&type=script&lang=js\"\n\nimport \"./ExplorerMembers.vue?vue&type=style&index=0&id=005ac0af&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-005ac0af\"]])\n\nexport default __exports__","import { render } from \"./index.vue?vue&type=template&id=5a45b633\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??clonedRuleSet-22.use[1]!../../node_modules/vue-loader/dist/stylePostLoader.js!../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-22.use[2]!../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-22.use[3]!../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-22.use[4]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[1]!./ExplorerMembers.vue?vue&type=style&index=0&id=005ac0af&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"51d79743\", content, true, {\"sourceMap\":false,\"shadowMode\":false});"],"names":["___CSS_LOADER_EXPORT___","push","module","id","$attrs","class","colspan","schema","resource","VIRTUAL_TYPES","CLUSTER_MEMBERS","createLocation","t","color","label","name","to","headers","rows","filteredClusterRoleTemplateBindings","groupable","namespaced","loading","$fetchState","pending","currentCluster","loadingClusterBindings","loadingProjectBindings","rowsWithFakeProjects","projectRoleTemplateColumns","group","getProjectLabel","type","addProjectMember","row","allRoles","role","j","key","ref","canViewInApi","viewRoleInAPI","nameDisplay","removeRole","$event","projectsWithoutRoles","project","i","components","Banner","Masthead","ResourceTable","Tabbed","Tab","SortableTable","props","createLocationOverride","Object","default","params","CLUSTER_ROLE_TEMPLATE_BINDING","fetch","clusterRoleTemplateBindingSchema","this","$store","getters","projectRoleTemplateBindingSchema","PROJECT_ROLE_TEMPLATE_BINDING","Promise","all","dispatch","root","then","normanBindings","bindings","PROJECT","projects","hydration","normanPrincipals","PRINCIPAL","mgmt","USER","mgmtRoleTemplates","ROLE_TEMPLATE","data","cluster","normanClusterRTBSchema","normanProjectRTBSchema","normanClusterRoleTemplateBindings","projectRoleTemplateBindings","labeKey","value","formatter","labelKey","computed","clusterRoleTemplateBindings","map","b","clusterroletemplatebinding","filter","clusterName","filteredProjects","reduce","p","spec","filteredProjectRoleTemplateBindings","out","rb","projectId","replace","inUse","binding","thisProjectId","includes","keys","fakeRows","groupByLabel","isFake","mainRowKey","displayName","availableActions","userRoles","curr","userId","groupPrincipalId","roleTemplate","userOrGroup","userOrGroupKey","values","canManageMembers","canManageProjectMembers","isLocal","canEditProjectMembers","collectionMethods","find","x","toLowerCase","canEditClusterMembers","methods","getMgmtProjectId","getMgmtProject","component","componentProps","saveInModal","modalSticky","getProjectRoleBinding","r","roleTemplateId","event","promptRemove","viewInApi","slotName","__exports__","ExplorerMembers","render","content","__esModule","locals","exports","add"],"sourceRoot":""}