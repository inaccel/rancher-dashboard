(self["webpackChunkdashboard"]=self["webpackChunkdashboard"]||[]).push([[3909],{36949:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>c});var i=t(45522),o=t.n(i),a=t(67643),n=t.n(a),s=n()(o());s.push([e.id,".header[data-v-4651841c]{border-bottom:1px solid var(--border);margin-bottom:0;padding-bottom:20px}.header H1[data-v-4651841c]{flex:1}",""]);const c=s},23909:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>T});var i=t(20641),o=t(90033);const a=e=>((0,i.Qi)("data-v-4651841c"),e=e(),(0,i.jt)(),e),n={class:"header"},s={class:"title"},c={class:"primaryheader"},l={class:"actions-container"},u={class:"actions"},g=a((()=>(0,i.Lk)("i",{class:"icon icon-actions"},null,-1))),m=[g];function d(e,r,t,a,g,d){const h=(0,i.g2)("ButtonGroup"),v=(0,i.g2)("ResourceYaml"),f=(0,i.g2)("ReceiverConfig"),p=(0,i.g2)("ActionMenu");return(0,i.uX)(),(0,i.CE)("div",null,[(0,i.Lk)("header",n,[(0,i.Lk)("div",s,[(0,i.Lk)("div",c,[(0,i.Lk)("h1",null,(0,o.toDisplayString)(d.heading),1)])]),(0,i.eW)(),(0,i.Lk)("div",l,[(0,i.Lk)("div",u,[g.viewOptions&&d.mode===g.view?((0,i.uX)(),(0,i.Wv)(h,{key:0,value:d.currentView,options:g.viewOptions,"onUpdate:value":d.handleButtonGroupClick},null,8,["value","options","onUpdate:value"])):(0,i.Q3)("",!0),(0,i.eW)(),d.mode===g.view?((0,i.uX)(),(0,i.CE)("button",{key:1,ref:"actions","aria-haspopup":"true",type:"button",class:"btn role-multi-action actions",onClick:r[0]||(r[0]=(...e)=>d.handleReceiverActionMenuClick&&d.handleReceiverActionMenuClick(...e))},m,512)):(0,i.Q3)("",!0)])])]),(0,i.eW)(),d.currentView===g.yaml&&g.alertmanagerConfigResource?((0,i.uX)(),(0,i.Wv)(v,{key:0,ref:"resourceyaml",value:g.alertmanagerConfigResource,mode:d.mode,"initial-yaml-for-diff":null,yaml:d.resourceYaml,"offer-preview":d.mode===g.edit,"done-route":JSON.stringify(d.redirectToReceiverDetail(g.receiverName)),"done-override":g.alertmanagerConfigDetailRoute,"apply-hooks":g.alertmanagerConfigResource.applyHooks,onError:r[1]||(r[1]=r=>e.$emit("error",r))},null,8,["value","mode","yaml","offer-preview","done-route","done-override","apply-hooks"])):(0,i.Q3)("",!0),(0,i.eW)(),d.currentView!==g.config&&d.currentView!==g.detail||!g.alertmanagerConfigResource?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.Wv)(f,{key:1,ref:"config",value:g.receiverValue,mode:d.mode,"alertmanager-config-id":g.alertmanagerConfigId,"alertmanager-config-resource":g.alertmanagerConfigResource,"save-override":d.saveOverride},null,8,["value","mode","alertmanager-config-id","alertmanager-config-resource","save-override"])),(0,i.eW)(),(0,i.bF)(p,{"custom-actions":d.receiverActions,open:g.receiverActionMenuIsOpen,"use-custom-target-element":!0,"custom-target-element":g.actionMenuTargetElement,"custom-target-event":g.actionMenuTargetEvent,onClose:r[2]||(r[2]=e=>g.receiverActionMenuIsOpen=!1),onGoToEdit:d.goToEdit,onGoToEditYaml:d.goToEditYaml,onPromptRemove:d.promptRemove},null,8,["custom-actions","open","custom-target-element","custom-target-event","onGoToEdit","onGoToEditYaml","onPromptRemove"])])}var h=t(97284),v=t(24513),f=t(63788),p=t(41586),C=t(39784),R=t(32891),y=t(45848),E=t(77444),A=t(13097);const w={name:"AlertmanagerConfigReceiverCreateEdit",emits:["error"],components:{ActionMenu:h.A,ButtonGroup:f.A,ReceiverConfig:v["default"],ResourceYaml:p.A},async fetch(){const e=this.$store.getters["currentProduct"].inStore,r=this.$store.getters[`${e}/schemaFor`](y.Rp.ALERTMANAGERCONFIG);this.receiverName=this.$route.query.receiverName;const t=this.$route.params.alertmanagerconfigid,i=await this.$store.dispatch(`${e}/find`,{type:y.Rp.ALERTMANAGERCONFIG,id:t}),o=await this.$store.dispatch(`${e}/clone`,{resource:i});await r.fetchResourceFields();const a=this.$route.query.mode;if(a!==E.YQ){const e=(o.spec.receivers||[]).find((e=>e.name===this.receiverName));e&&(this.receiverValue=e)}this.alertmanagerConfigId=o.id,this.alertmanagerConfigResource=o,this.alertmanagerConfigDetailRoute=o._detailLocation},data(){return{actionMenuTargetElement:null,actionMenuTargetEvent:null,alertmanagerConfigId:"",alertmanagerConfigResource:null,alertmanagerConfigDetailRoute:null,config:E.au,create:E.YQ,detail:E.fS,edit:E.G5,receiverActionMenuIsOpen:!1,receiverName:"",receiverValue:{},showPreview:!1,view:E.nW,viewOptions:[{labelKey:"resourceDetail.masthead.config",value:"config"},{labelKey:"resourceDetail.masthead.yaml",value:E.zD}],yaml:E.zD}},computed:{currentView(){return this.$route.query.currentView},receiverActions(){const e=this.alertmanagerConfigResource?.availableActions;return e?this.alertmanagerConfigResource.getReceiverActions(e):[]},resourceYaml(){const e=this.alertmanagerConfigResource,r=this.$store.getters["currentStore"](e),t=this.$store.getters[`${r}/all`](y.yx),i=(0,A.clone)(e),o=(0,C.mH)(t,y.Rp.ALERTMANAGERCONFIG,i);return o},mode(){return this.$route.query.mode},editorMode(){return this.mode===this.view?R.j.VIEW_CODE:this.showPreview?R.j.DIFF_CODE:R.j.EDIT_CODE},heading(){switch(this.$route.query.mode){case this.create:return this.t("monitoring.alertmanagerConfig.receiverFormNames.create");case this.edit:return this.currentView===this.yaml||this.$route.query.as===this.yaml?this.t("monitoring.alertmanagerConfig.receiverFormNames.editYaml"):this.t("monitoring.alertmanagerConfig.receiverFormNames.edit");default:return this.t("monitoring.alertmanagerConfig.receiverFormNames.detail")}}},methods:{async saveOverride(e){if(this.alertmanagerConfigResource.yamlError)return this.alertmanagerConfigResource.errors=this.alertmanagerConfigResource.errors||[],this.alertmanagerConfigResource.errors.push(this.alertmanagerConfigResource.yamlError),void e(!1);try{await this.alertmanagerConfigResource.save(...arguments),e(!0),this.redirectToAlertmanagerConfigDetail()}catch(r){const t=r?.message?r.message:this.t("monitoring.alertmanagerConfig.error");this.$refs.config.setError(t),e(!1)}},handleButtonGroupClick(e){e===this.yaml&&this.goToEditYaml(this.view),e===this.config&&this.goToEdit(this.view)},toggleReceiverActionMenu(){this.receiverActionMenuIsOpen=!this.receiverActionMenuIsOpen},handleReceiverActionMenuClick(e){this.actionMenuTargetElement=this.$refs.actions,this.actionMenuTargetEvent=e,this.toggleReceiverActionMenu()},goToEdit(){this.$router.push(this.alertmanagerConfigResource.getEditReceiverConfigRoute(this.receiverValue.name,E.G5))},goToEditYaml(){this.$router.push(this.alertmanagerConfigResource.getEditReceiverYamlRoute(this.receiverValue.name,E.G5))},promptRemove(e){const r=e.route.query.receiverName,t=this.alertmanagerConfigResource.spec.receivers||[],i=t.filter((e=>e.name!==r));this.alertmanagerConfigResource.spec.receivers=i,this.alertmanagerConfigResource.save(...arguments),this.$router.push(this.alertmanagerConfigResource._detailLocation)},redirectToReceiverDetail(e){return this.alertmanagerConfigResource.getReceiverDetailLink(e)},redirectToAlertmanagerConfigDetail(){const e=this.alertmanagerConfigResource._detailLocation;this.$router.push(e)}}};t(32543);var k=t(66262);const M=(0,k.A)(w,[["render",d],["__scopeId","data-v-4651841c"]]),T=M},32543:(e,r,t)=>{var i=t(36949);i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);var o=t(99548).A;o("41fc1686",i,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=3909.6b0c6859.js.map