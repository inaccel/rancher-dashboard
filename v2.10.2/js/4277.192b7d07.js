"use strict";(self["webpackChunkdashboard"]=self["webpackChunkdashboard"]||[]).push([[4277],{44277:(e,a,t)=>{t.r(a),t.d(a,{default:()=>w});var s=t(20641);const r={key:1,class:"outlet"};function n(e,a,t,n,o,l){const c=(0,s.g2)("Loading"),i=(0,s.g2)("TypeDescription"),d=(0,s.g2)("Masthead"),u=(0,s.g2)("Banner"),m=(0,s.g2)("BadgeState"),h=(0,s.g2)("ResourceTable");return e.$fetchState.pending?((0,s.uX)(),(0,s.Wv)(c,{key:0})):((0,s.uX)(),(0,s.CE)("div",r,[(0,s.bF)(d,{schema:o.schema,resource:o.resource,isCreatable:!1,"type-display":e.t("jwt.title")},{typeDescription:(0,s.k6)((()=>[(0,s.bF)(i,{resource:"jwt.authentication"},null,8,["resource"])])),_:1},8,["schema","resource","type-display"]),(0,s.eW)(),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.errors,((e,a)=>((0,s.uX)(),(0,s.Wv)(u,{key:a,color:"error",label:e,closable:!0,onClose:e=>l.closeError(a)},null,8,["label","onClose"])))),128)),(0,s.eW)(),(0,s.bF)(h,{schema:o.schema,headers:l.headers,"key-field":"id",namespaced:!1,rows:l.rows,tableActions:!0,"force-update-live-and-delayed":o.forceUpdateLiveAndDelayed,"use-query-params-for-simple-filtering":o.useQueryParamsForSimpleFiltering,"sort-generation-fn":l.sortGenerationFn,"data-testid":"jwt-authentication-list"},{"col:state":(0,s.k6)((({row:e})=>[(0,s.Lk)("td",null,[(0,s.bF)(m,{color:e.stateBackground,label:e.stateLabel,class:"state-bagde"},null,8,["color","label"])])])),_:1},8,["schema","headers","rows","force-update-live-and-delayed","use-query-params-for-simple-filtering","sort-generation-fn"])]))}var o=t(45848),l=t(53806),c=t(39147),i=t(2803),d=t(45016),u=t(24718),m=t(57735),h=t(84430),p=t(82964),b=t(86973),g=t(95510),y=t(15203);const f={name:"ClusterProxyConfig",components:{ResourceTable:i.A,Loading:d.A,Masthead:u.A,BadgeState:p.j,Banner:y.A,TypeDescription:b.A},mixins:[h.A],async fetch(){const e={mgmtClusters:this.$fetchType(o.Mc.CLUSTER),proxyConfig:this.$store.dispatch("management/findAll",{type:o.Mc.CLUSTER_PROXY_CONFIG,opt:{omitExcludeFields:["metadata.managedFields"]}})},a=await(0,m.kR)(e);this.clusters=a.mgmtClusters,this.proxyConfigs=a.proxyConfig},data(){return{clusters:[],proxyConfigs:[],resource:o.Mc.CLUSTER_PROXY_CONFIG,schema:this.$store.getters["management/schemaFor"](o.Mc.CLUSTER_PROXY_CONFIG),useQueryParamsForSimpleFiltering:!1,errors:[],forceUpdateLiveAndDelayed:5}},methods:{closeError(e){this.errors=this.errors.filter(((a,t)=>t!==e))},sortGenerationFn(){const e=(0,i.S)(this.schema,this.$store);return e+this.forceUpdateLiveAndDelayed}},computed:{headers(){const e=[{...l.c4,value:"value"},{name:"clusterName",labelKey:"jwt.headers.clusterName",value:"clusterName",sort:"clusterName",search:["clusterName"],formatter:"LinkDetail"},{name:"updatedOn",labelKey:"jwt.headers.updatedOn",value:"updatedOn",sort:"updatedOn",formatter:"Date"},{...l.K,labelKey:"jwt.headers.clusterAge"}];return e},rows(){const e=new Map,a=[],t={action:"activate",allEnabled:!1,anyEnabled:!0,bulkable:!0,enabled:!0,icon:"icon icon-checkmark",label:this.t("jwt.actions.activate"),invoke:async(e,a)=>{const t=[];try{a.forEach((e=>{const a=e.enable();t.push(a)})),await Promise.all(t)}catch(s){this.errors=(0,g.rz)(s)}}},s={action:"deactivate",allEnabled:!1,anyEnabled:!0,bulkable:!0,enabled:!0,icon:"icon icon-x",label:this.t("jwt.actions.deactivate"),invoke:async(e,a)=>{const t=[];try{a.forEach((e=>{const a=e.disable();t.push(a)})),await Promise.all(t)}catch(s){this.errors=(0,g.rz)(s)}}};return this.proxyConfigs.forEach((a=>{const t=a.metadata.namespace;e.set(t,{config:a})})),this.clusters.forEach((r=>{const n=r.id,o=r.spec.displayName;if("local"!==n){const l=e.get(n)?.config,i=l?.enabled||"",d=l?.metadata?.name||"";let u="";i&&(u=l?.metadata?.managedFields?.find((e=>"Update"===e.operation))?.time||"");const m=i?(0,c.uU)(c.jv.ACTIVE).replace("text","bg"):(0,c.uU)(c.jv.INFO).replace("text","bg"),h=i?this.t("jwt.state.enabled"):this.t("jwt.state.disabled"),p=r.metadata.creationTimestamp,b=i?[s]:[t],g=async()=>{if(d)return l.enabled=!0,l.save();{const e=await this.$store.dispatch("management/create",{enabled:!0,metadata:{namespace:n,name:"clusterproxyconfig"}});return e.save({url:"v1/management.cattle.io.clusterproxyconfigs",method:"POST"})}},y=async()=>(l.enabled=!1,l.save());a.push({id:n,clusterName:o,value:i,stateBackground:m,stateLabel:h,creationTimestamp:p,updatedOn:u,availableActions:b,enable:g,disable:y})}})),this.forceUpdateLiveAndDelayed=(new Date).getTime(),a}}};var v=t(66262);const C=(0,v.A)(f,[["render",n]]),w=C}}]);
//# sourceMappingURL=4277.192b7d07.js.map