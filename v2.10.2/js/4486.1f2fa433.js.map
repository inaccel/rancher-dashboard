{"version":3,"file":"js/4486.1f2fa433.js","mappings":"uLAGIA,EAA0B,IAA4B,KAE1DA,EAAwBC,KAAK,CAACC,EAAOC,GAAI,4FAA6F,KAEtI,S,gKC6HYC,MAAM,O,GACPA,MAAM,e,GAaNA,MAAM,6B,GACJA,MAAM,sB,yBAaFA,MAAM,mB,GACJA,MAAM,S,GACJA,MAAM,4B,UAQX,QAEM,OAFDA,MAAM,cAAY,EACrB,QAAqC,KAAlCA,MAAM,8B,eAGb,QAAI,qB,GACCA,MAAM,e,gLA7CR,EAAAC,YAAmB,U,WAAlC,QAAsC,c,WACtC,QA8DU,cA7DR,QAYS,SAZT,EAYS,EAXP,QAUM,MAVN,EAUM,EATJ,QAEK,YADH,QAAmC,GAAhCC,EAAE,iC,WAEP,QAKM,aAJJ,QAGE,GAFAA,EAAE,+BACDC,KAAK,W,WAKd,QAuCM,aAtCJ,QAqCM,MArCN,EAqCM,EApCJ,QAmCM,MAnCN,EAmCM,G,aAlCJ,QAiCI,mBAhCiB,EAAAC,eAAa,CAAxBC,EAAKC,K,qBADf,QAiCI,KA/BDC,IAAKD,EAILE,KAAMH,EAAII,QAAUJ,EAAIK,UAAO,EAC/BC,UAAWN,EAAII,SAAiB,KACjCG,OAAO,SACPC,IAAI,sBACHb,OAAK,mDAAuCK,EAAII,W,EAEjD,QAoBM,MApBN,EAoBM,EAnBJ,QAYM,MAZN,EAYM,EAXJ,QAEM,MAFN,EAEM,EADJ,QAAgC,GAApBK,IAAKT,EAAIU,S,8BAEvB,QAIK,YAHH,QAEO,cADL,QAAoB,GAAhBb,EAAGG,EAAIW,O,6BAGf,K,UAIF,G,WACA,QAIM,MAJN,EAIM,EAHJ,QAEO,cADL,QAA0B,GAAtBd,EAAGG,EAAIY,a,gCA1BgB,EAAI,aAAmD,EAAzC,IAAC,0C,wBAkCxD,QAOM,aANJ,QAKY,GAJVjB,MAAM,QACLkB,MAAO,EAAAC,EAAE,yC,mBAEV,IAAc,EAAd,QAAc,M,kJAlLtB,SACEC,WAAY,CACVC,UAAS,IACTC,UAAS,IACTC,WAAU,IACVC,QAAO,KAGT,WAAMC,SACEC,KAAKC,WACb,EAEA,IAAAC,GACE,MAAMC,EAAa,EAAQ,OACrBC,EAAgB,EAAQ,OACxBC,EAAiBL,KAAKM,OAAOC,QAAQ,kBAE3C,MAAO,CACLC,eAAgB,CACdC,cAAc,EACdC,SAAc,EACdC,YAAc,GAEhBC,UAAe,CAAC,KAAWC,aAAc,KAAWC,YACpDpC,cAAe,CACb,CACEK,SAAa,EACbgC,MAAa,eACb1B,QAAae,EACbd,MAAa,oDACbC,YACE,0DACFP,KAAM,iBAAkBqB,EAAehC,0GAEzC,CACEU,SAAa,EACbgC,MAAa,UACb1B,QAAac,EACbb,MAAa,+CACbC,YAAa,qDACbP,KAAa,IAEf,CACED,SAAa,EACbgC,MAAa,aACb1B,QAAae,EACbd,MAAa,wDACbC,YACE,8DACFP,KAAM,iBAAkBqB,EAAehC,8GAEzC,CACEU,SAAa,EACbgC,MAAa,aACb1B,QAAae,EACbd,MAAa,uDACbC,YACE,6DACFP,KAAM,iBAAkBqB,EAAehC,8GAEzC,CACEU,SAAa,EACbgC,MAAa,aACb1B,QAAae,EACbd,MAAa,yDACbC,YACE,+DACFP,KAAM,iBAAkBqB,EAAehC,iHAI/C,EAEA2C,QAAS,CACP,eAAMf,GACJ,MAAM,OAAEK,EAAM,cAAE5B,GAAkBsB,KAC5BiB,EAAO,CAAC,EAEVX,EAAOC,QAAQ,mBAAmB,KAAQW,OAC5CD,EAAKE,KAAOb,EAAOc,SAAS,kBAAmB,CAAEC,KAAM,KAAQH,OAEjE,MAAMI,QAAY,QAAQL,GAEpBM,QAA4B,QAAwBvB,KAAKM,QACzDkB,QAAuB,QAAmBxB,KAAKM,QAC/CmB,QAA0B,QAAsBzB,KAAKM,QAE3D,GAAIiB,EAAqB,CACvB,MAAMG,GAAU,QAAOhD,EAAe,QAAS,gBAE/CgD,EAAQ3C,SAAU,CACpB,CACA,GAAIyC,EAAgB,CAClB,MAAMG,GAAe,QAAOjD,EAAe,QAAS,WAE9C2B,EAAiBL,KAAKM,OAAOC,QAAQ,kBACrCqB,EAAqB,IAAQN,EAAIH,MAAgF,IAAxE,QAAOG,EAAIH,KAAM,KAAM,+CAChEU,GAAgB,QAAiBD,GAAmBE,gBAAkB,GAAIzB,EAAehC,IAE/FsD,EAAa3C,KAAO,GAAI6C,kGACxBF,EAAa5C,SAAU,CACzB,CAEA,GAAI0C,EAAmB,CACrB,MAAMM,EAAarD,EAAcsD,QAC9BC,GAAoB,eAAbA,EAAGlB,QAGbgB,EAAWG,SAASC,IAClBA,EAAMpD,SAAU,CAAI,GAExB,CACF,I,wBCrHJ,MAAMqD,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAEzF,G,kBCNA,IAAIC,EAAU,EAAQ,OACnBA,EAAQC,aAAYD,EAAUA,EAAQE,SACnB,kBAAZF,IAAsBA,EAAU,CAAC,CAAClE,EAAOC,GAAIiE,EAAS,MAC7DA,EAAQG,SAAQrE,EAAOsE,QAAUJ,EAAQG,QAE5C,IAAIE,EAAM,WACGA,EAAI,WAAYL,GAAS,EAAM,CAAC,WAAY,EAAM,YAAa,G","sources":["webpack://dashboard/./shell/pages/c/_cluster/monitoring/index.vue?4d96","webpack://dashboard/./shell/pages/c/_cluster/monitoring/index.vue","webpack://dashboard/./shell/pages/c/_cluster/monitoring/index.vue?8b7a","webpack://dashboard/./shell/pages/c/_cluster/monitoring/index.vue?fcda"],"sourcesContent":["// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.create-resource-container .subtype-banner[data-v-7933252e]{min-height:80px;padding:10px}`, \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","<script>\nimport isEmpty from 'lodash/isEmpty';\nimport AlertTable from '@shell/components/AlertTable';\nimport { CATALOG, MONITORING } from '@shell/config/types';\nimport { allHash } from '@shell/utils/promise';\nimport { findBy } from '@shell/utils/array';\nimport { getClusterPrefix } from '@shell/utils/grafana';\nimport LazyImage from '@shell/components/LazyImage';\nimport SimpleBox from '@shell/components/SimpleBox';\nimport { canViewAlertManagerLink, canViewGrafanaLink, canViewPrometheusLink } from '@shell/utils/monitoring';\nimport Loading from '@shell/components/Loading';\n\nexport default {\n  components: {\n    LazyImage,\n    SimpleBox,\n    AlertTable,\n    Loading\n  },\n\n  async fetch() {\n    await this.fetchDeps();\n  },\n\n  data() {\n    const grafanaSrc = require('~shell/assets/images/vendor/grafana.svg');\n    const prometheusSrc = require('~shell/assets/images/vendor/prometheus.svg');\n    const currentCluster = this.$store.getters['currentCluster'];\n\n    return {\n      availableLinks: {\n        alertmanager: false,\n        grafana:      false,\n        prometheus:   false,\n      },\n      resources:     [MONITORING.ALERTMANAGER, MONITORING.PROMETHEUS],\n      externalLinks: [\n        {\n          enabled:     false,\n          group:       'alertmanager',\n          iconSrc:     prometheusSrc,\n          label:       'monitoring.overview.linkedList.alertManager.label',\n          description:\n            'monitoring.overview.linkedList.alertManager.description',\n          link: `/k8s/clusters/${ currentCluster.id }/api/v1/namespaces/cattle-monitoring-system/services/http:rancher-monitoring-alertmanager:9093/proxy`,\n        },\n        {\n          enabled:     false,\n          group:       'grafana',\n          iconSrc:     grafanaSrc,\n          label:       'monitoring.overview.linkedList.grafana.label',\n          description: 'monitoring.overview.linkedList.grafana.description',\n          link:        '',\n        },\n        {\n          enabled:     false,\n          group:       'prometheus',\n          iconSrc:     prometheusSrc,\n          label:       'monitoring.overview.linkedList.prometheusPromQl.label',\n          description:\n            'monitoring.overview.linkedList.prometheusPromQl.description',\n          link: `/k8s/clusters/${ currentCluster.id }/api/v1/namespaces/cattle-monitoring-system/services/http:rancher-monitoring-prometheus:9090/proxy/graph`,\n        },\n        {\n          enabled:     false,\n          group:       'prometheus',\n          iconSrc:     prometheusSrc,\n          label:       'monitoring.overview.linkedList.prometheusRules.label',\n          description:\n            'monitoring.overview.linkedList.prometheusRules.description',\n          link: `/k8s/clusters/${ currentCluster.id }/api/v1/namespaces/cattle-monitoring-system/services/http:rancher-monitoring-prometheus:9090/proxy/rules`,\n        },\n        {\n          enabled:     false,\n          group:       'prometheus',\n          iconSrc:     prometheusSrc,\n          label:       'monitoring.overview.linkedList.prometheusTargets.label',\n          description:\n            'monitoring.overview.linkedList.prometheusTargets.description',\n          link: `/k8s/clusters/${ currentCluster.id }/api/v1/namespaces/cattle-monitoring-system/services/http:rancher-monitoring-prometheus:9090/proxy/targets`,\n        },\n      ]\n    };\n  },\n\n  methods: {\n    async fetchDeps() {\n      const { $store, externalLinks } = this;\n      const hash = {};\n\n      if ($store.getters['cluster/canList'](CATALOG.APP)) {\n        hash.apps = $store.dispatch('cluster/findAll', { type: CATALOG.APP });\n      }\n      const res = await allHash(hash);\n\n      const canViewAlertManager = await canViewAlertManagerLink(this.$store);\n      const canViewGrafana = await canViewGrafanaLink(this.$store);\n      const canViewPrometheus = await canViewPrometheusLink(this.$store);\n\n      if (canViewAlertManager) {\n        const amMatch = findBy(externalLinks, 'group', 'alertmanager');\n\n        amMatch.enabled = true;\n      }\n      if (canViewGrafana) {\n        const grafanaMatch = findBy(externalLinks, 'group', 'grafana');\n        // Generate Grafana link\n        const currentCluster = this.$store.getters['currentCluster'];\n        const rancherMonitoring = !isEmpty(res.apps) ? findBy(res.apps, 'id', 'cattle-monitoring-system/rancher-monitoring') : '';\n        const clusterPrefix = getClusterPrefix(rancherMonitoring?.currentVersion || '', currentCluster.id);\n\n        grafanaMatch.link = `${ clusterPrefix }/api/v1/namespaces/cattle-monitoring-system/services/http:rancher-monitoring-grafana:80/proxy/`;\n        grafanaMatch.enabled = true;\n      }\n\n      if (canViewPrometheus) {\n        const promeMatch = externalLinks.filter(\n          (el) => el.group === 'prometheus'\n        );\n\n        promeMatch.forEach((match) => {\n          match.enabled = true;\n        });\n      }\n    },\n  },\n};\n</script>\n\n<template>\n  <Loading v-if=\"$fetchState.pending\" />\n  <section v-else>\n    <header class=\"row\">\n      <div class=\"col span-12\">\n        <h1>\n          <t k=\"monitoring.overview.title\" />\n        </h1>\n        <div>\n          <t\n            k=\"monitoring.overview.subtitle\"\n            :raw=\"true\"\n          />\n        </div>\n      </div>\n    </header>\n    <div>\n      <div class=\"create-resource-container\">\n        <div class=\"subtypes-container\">\n          <a\n            v-for=\"(fel, i) in externalLinks\"\n            :key=\"i\"\n            v-clean-tooltip=\"\n              !fel.enabled ? t('monitoring.overview.linkedList.na') : undefined\n            \"\n            :href=\"fel.enabled ? fel.link : void 0\"\n            :disabled=\"!fel.enabled ? true : null\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            :class=\"{ 'subtype-banner': true, disabled: !fel.enabled }\"\n          >\n            <div class=\"subtype-content\">\n              <div class=\"title\">\n                <div class=\"subtype-logo round-image\">\n                  <LazyImage :src=\"fel.iconSrc\" />\n                </div>\n                <h5>\n                  <span>\n                    <t :k=\"fel.label\" />\n                  </span>\n                </h5>\n                <div class=\"flex-right\">\n                  <i class=\"icon icon-external-link\" />\n                </div>\n              </div>\n              <hr>\n              <div class=\"description\">\n                <span>\n                  <t :k=\"fel.description\" />\n                </span>\n              </div>\n            </div>\n          </a>\n        </div>\n      </div>\n    </div>\n    <div>\n      <SimpleBox\n        class=\"mt-30\"\n        :title=\"t('monitoring.overview.alertsList.label')\"\n      >\n        <AlertTable />\n      </SimpleBox>\n    </div>\n  </section>\n</template>\n\n<style lang=\"scss\" scoped>\n  .create-resource-container .subtype-banner {\n    min-height: 80px;\n    padding: 10px;\n  }\n</style>\n","import { render } from \"./index.vue?vue&type=template&id=7933252e&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=7933252e&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-7933252e\"]])\n\nexport default __exports__","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??clonedRuleSet-22.use[1]!../../../../../node_modules/vue-loader/dist/stylePostLoader.js!../../../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-22.use[2]!../../../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-22.use[3]!../../../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-22.use[4]!../../../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[1]!./index.vue?vue&type=style&index=0&id=7933252e&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"08af0a0a\", content, true, {\"sourceMap\":false,\"shadowMode\":false});"],"names":["___CSS_LOADER_EXPORT___","push","module","id","class","$fetchState","k","raw","externalLinks","fel","i","key","href","enabled","link","disabled","target","rel","src","iconSrc","label","description","title","t","components","LazyImage","SimpleBox","AlertTable","Loading","fetch","this","fetchDeps","data","grafanaSrc","prometheusSrc","currentCluster","$store","getters","availableLinks","alertmanager","grafana","prometheus","resources","ALERTMANAGER","PROMETHEUS","group","methods","hash","APP","apps","dispatch","type","res","canViewAlertManager","canViewGrafana","canViewPrometheus","amMatch","grafanaMatch","rancherMonitoring","clusterPrefix","currentVersion","promeMatch","filter","el","forEach","match","__exports__","render","content","__esModule","default","locals","exports","add"],"sourceRoot":""}