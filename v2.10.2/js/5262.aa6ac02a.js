"use strict";(self["webpackChunkdashboard"]=self["webpackChunkdashboard"]||[]).push([[5262],{65262:(t,e,r)=>{r.r(e),r.d(e,{default:()=>b});var o=r(20641);const s={class:"main-layout"},i={class:"text-center mt-50"},n={key:0},u={key:1},a={key:2};function c(t,e,r,c,l,h){return(0,o.uX)(),(0,o.CE)("main",s,[(0,o.Lk)("h1",i,[l.testing?((0,o.uX)(),(0,o.CE)("span",n,"\n        Testing Configuration…\n      ")):l.isSlo?((0,o.uX)(),(0,o.CE)("span",u,"\n        Logging Out…\n      ")):((0,o.uX)(),(0,o.CE)("span",a,"\n        Logging In…\n      "))])])}var l=r(77444),h=r(13097),p=r(89305),d=r(27150),g=r(96763);const $=["ping","adfs","keycloak","okta","shibboleth"];function w(t,e){try{window.opener.window.onAuthTest(t,e),setTimeout((()=>{window.close()}),250)}catch(r){window.close()}}function f(t){const{query:e}=t,r=(0,h.get)(e,"config");return $.includes(r)}const y={async fetch(){const t=this.$route.query[l.Wt],e=this.$route.query[l.Mg],{error:r,error_description:o,errorCode:s,errorMsg:i}=this.$route.query;if(r||o||s||i){let t=o||r||s;if(this.isSlo){g.error("Failed to log out of auth provider",r,o,s,i);let t=this.$store.getters["i18n/withFallback"]("logout.specificError.unknown");return s&&(t=this.$store.getters["i18n/withFallback"](`logout.specificError.${s}`,null,t)),void this.$router.replace(`/auth/login?${l.kM}&err=${escape(t)}`)}return i&&(t=this.$store.getters["i18n/withFallback"](`login.serverError.${i}`,null,i)),void this.$router.replace(`/auth/login?err=${escape(t)}`)}if(this.isSlo)return void this.$store.dispatch("auth/uiLogout");let n;try{n=JSON.parse((0,p.u)(e))}catch(h){if(f(this.$route))return;const t=this.$store.getters["i18n/t"]("login.error");return g.error("Failed to parse nonce",e,h),void this.$router.replace(`/auth/login?err=${escape(t)}`)}const{test:u,provider:a,nonce:c}=n;if(!u)try{const e=await this.$store.dispatch("auth/verifyOAuth",{code:t,nonce:c,provider:a});if(200===e._status){const t=this.$route.query[l.MW]||"/";await(0,d.A)({app:this.$store.app,store:this.$store,$plugin:this.$store.$plugin}),this.$router.replace(t)}else this.$router.replace(`/auth/login?err=${escape(e)}`)}catch(h){this.$router.replace(`/auth/login?err=${escape(h)}`)}},data(){const t=this.$route.query[l.Mg]||"";let e={};try{e=JSON.parse((0,p.u)(t))}catch{}const{test:r}=e,o=this.$route.query[l.kM]===l.Qp;return{testing:r,isSlo:o}},mounted(){if(this.testing)try{const{error:t,error_description:e,[l.Wt]:r,errorMsg:o}=this.$route.query;let s=e||t||(r?null:"No code supplied by auth provider");o&&(s=this.$store.getters["i18n/withFallback"](`login.serverError.${o}`,null,o)),w(s,r)}catch(t){window.close()}else window.opener&&f(this.$route)&&(window.opener.window.onAuthTest?w(null,null):w({err:"failure"}))}};var k=r(66262);const v=(0,k.A)(y,[["render",c]]),b=v}}]);
//# sourceMappingURL=5262.aa6ac02a.js.map