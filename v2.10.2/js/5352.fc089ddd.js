(self["webpackChunkdashboard"]=self["webpackChunkdashboard"]||[]).push([[5352],{74777:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>l});var s=a(45522),r=a.n(s),o=a(67643),n=a.n(o),i=n()(r());i.push([e.id,".pin-effect-area[data-v-821cd8e8]{position:absolute;z-index:997;width:0;height:0;border-style:hidden}.pin-effect-area.right[data-v-821cd8e8]{right:0;background-image:linear-gradient(to right,var(--drag-over-outer-bg),var(--drag-over-inner-bg));border-left:1px;border-style:hidden hidden hidden dashed}.pin-effect-area.left[data-v-821cd8e8],.pin-effect-area.right[data-v-821cd8e8]{top:55px;width:300px;transition:width .5s ease;height:100%}.pin-effect-area.left[data-v-821cd8e8]{left:0;background-image:linear-gradient(to left,var(--drag-over-outer-bg),var(--drag-over-inner-bg));border-right:1px;border-style:hidden dashed hidden hidden}.pin-effect-area.bottom[data-v-821cd8e8]{bottom:0;height:270px;transition:height .5s ease;width:100%;background-image:linear-gradient(to top,var(--drag-over-inner-bg),var(--drag-over-outer-bg));border-top:1px;border-style:dashed hidden hidden hidden}.drag-area[data-v-821cd8e8],.pin-effect-area.center[data-v-821cd8e8]{width:0;height:0}.drag-area[data-v-821cd8e8]{position:absolute;z-index:999;opacity:0}.drag-area.center[data-v-821cd8e8]{top:0;right:0;width:100%;height:100%;z-index:998}.drag-area.right[data-v-821cd8e8]{top:55px;right:0;width:300px;height:100%}.drag-area.left[data-v-821cd8e8]{top:55px;left:0;width:300px;height:100%}.drag-area.bottom[data-v-821cd8e8]{bottom:0;height:270px;width:100%}",""]);const l=i},18401:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>l});var s=a(45522),r=a.n(s),o=a(67643),n=a.n(o),i=n()(r());i.push([e.id,".promptrestore-modal[data-v-1983552e]{border-radius:var(--border-radius);overflow:scroll;max-height:100vh}.promptrestore-modal[data-v-1983552e] ::-webkit-scrollbar-corner{background:transparent}.promptrestore-modal .prompt-restore form p[data-v-1983552e]{min-height:16px}.promptrestore-modal .dialog-actions[data-v-1983552e]{display:flex;justify-content:flex-end}.prompt-restore[data-v-1983552e]  .card-wrap .card-actions{display:block}.prompt-restore[data-v-1983552e]  .card-wrap .card-actions button:not(:last-child){margin-right:10px}.prompt-restore[data-v-1983552e]  .card-wrap .card-actions .banner{display:flex}",""]);const l=i},53202:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>l});var s=a(45522),r=a.n(s),o=a(67643),n=a.n(o),i=n()(r());i.push([e.id,".side-nav[data-v-2cbfa658]{display:flex;flex-direction:column;position:relative;background-color:var(--nav-bg);border-right:var(--nav-border-size) solid var(--nav-border);overflow-y:auto}.side-nav .nav[data-v-2cbfa658]{flex:1;overflow-y:auto}.side-nav[data-v-2cbfa658]  h6{margin:0;letter-spacing:normal;line-height:15px}.side-nav[data-v-2cbfa658]  h6 A{padding-left:0}.side-nav .tools[data-v-2cbfa658]{display:flex;margin:10px;text-align:center}.side-nav .tools A[data-v-2cbfa658]{align-items:center;border:1px solid var(--border);border-radius:5px;color:var(--body-text);display:flex;justify-content:center;outline:0;flex:1;padding:10px}.side-nav .tools A[data-v-2cbfa658]:hover{background:var(--nav-hover);text-decoration:none}.side-nav .tools A>I[data-v-2cbfa658]{margin-right:4px}.side-nav .tools.router-link-active:not(:hover) A[data-v-2cbfa658]{background-color:var(--nav-active)}.side-nav .version[data-v-2cbfa658]{cursor:default;margin:0 10px 10px 10px}.side-nav .footer[data-v-2cbfa658]{margin:20px;display:flex;flex:0;flex-direction:row}.side-nav .footer>*[data-v-2cbfa658]{flex:1;color:var(--link);text-align:center}.side-nav .footer[data-v-2cbfa658]>:last-child{text-align:right}.side-nav .footer[data-v-2cbfa658]>:first-child{text-align:left}.side-nav .footer .version[data-v-2cbfa658]{cursor:default;margin:0}.side-nav .footer .locale-chooser[data-v-2cbfa658]{cursor:pointer}.flex[data-v-2cbfa658]{display:flex}",""]);const l=i},25556:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});const s="pageActions",r={created(){this.updatePageActions();const e=e=>{this.handlePageAction&&this.handlePageAction(e)};this.$store.commit("pageActionHandler",e)},beforeUnmount(){this.pageActions&&this.$store.commit(s,[]),this.$store.commit("clearPageActionHandler")},methods:{updatePageActions(){this.pageActions&&this.$store.commit(s,this.pageActions)}},watch:{pageActions(e,t){this.updatePageActions()}}}},95352:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>Fe});var s=a(20641),r=a(90033);const o={class:"dashboard-root"},n={key:1,class:"main-layout"},i={key:2,class:"main-layout"},l=["draggable"];function d(e,t,a,d,c,u){const h=(0,s.g2)("FixedBanner"),p=(0,s.g2)("AwsComplianceBanner"),g=(0,s.g2)("AzureWarning"),m=(0,s.g2)("Header"),v=(0,s.g2)("SideNav"),f=(0,s.g2)("router-view"),b=(0,s.g2)("ActionMenu"),y=(0,s.g2)("PromptRemove"),k=(0,s.g2)("PromptRestore"),S=(0,s.g2)("AssignTo"),A=(0,s.g2)("PromptModal"),w=(0,s.g2)("WindowManager"),x=(0,s.g2)("GrowlManager"),R=(0,s.g2)("Inactivity"),P=(0,s.g2)("DraggableZone"),$=(0,s.gN)("shortkey");return(0,s.uX)(),(0,s.CE)("div",o,[(0,s.bF)(h,{header:!0}),(0,s.eW)(),e.managementReady?((0,s.uX)(),(0,s.Wv)(p,{key:0})):(0,s.Q3)("",!0),(0,s.eW)(),e.managementReady?((0,s.uX)(),(0,s.Wv)(g,{key:1})):(0,s.Q3)("",!0),(0,s.eW)(),e.managementReady?((0,s.uX)(),(0,s.CE)("div",{key:2,class:(0,r.normalizeClass)(["dashboard-content",{[u.pinClass]:!0,"dashboard-padding-left":e.showTopLevelMenu}])},[(0,s.bF)(m),(0,s.eW)(),e.clusterReady?((0,s.uX)(),(0,s.Wv)(v,{key:0,class:"default-side-nav"})):(0,s.Q3)("",!0),(0,s.eW)(),u.clusterAndRouteReady?((0,s.uX)(),(0,s.CE)("main",n,[((0,s.uX)(),(0,s.Wv)(f,{key:e.$route.path,class:"outlet"})),(0,s.eW)(),(0,s.bF)(b),(0,s.eW)(),(0,s.bF)(y),(0,s.eW)(),(0,s.bF)(k),(0,s.eW)(),(0,s.bF)(S),(0,s.eW)(),(0,s.bF)(A),(0,s.eW)(),c.noLocaleShortcut?(0,s.bo)(((0,s.uX)(),(0,s.CE)("button",{key:0,class:"hide",onShortkey:t[0]||(t[0]=e=>u.toggleNoneLocale())},null,544)),[[$,["shift","l"],void 0,{once:!0}]]):(0,s.Q3)("",!0),(0,s.eW)(),u.themeShortcut?(0,s.bo)(((0,s.uX)(),(0,s.CE)("button",{key:1,class:"hide",onShortkey:t[1]||(t[1]=e=>u.toggleTheme())},null,544)),[[$,["shift","t"],void 0,{once:!0}]]):(0,s.Q3)("",!0),(0,s.eW)(),(0,s.bo)((0,s.Lk)("button",{class:"hide",onShortkey:t[2]||(t[2]=e=>u.wheresMyDebugger())},null,544),[[$,["f8"],void 0,{once:!0}]]),(0,s.eW)(),(0,s.bo)((0,s.Lk)("button",{class:"hide",onShortkey:t[3]||(t[3]=(...e)=>u.toggleShell&&u.toggleShell(...e))},null,544),[[$,["`"],void 0,{once:!0}]])])):u.unmatchedRoute?((0,s.uX)(),(0,s.CE)("main",i,[((0,s.uX)(),(0,s.Wv)(f,{key:e.$route.path,class:"outlet"}))])):(0,s.Q3)("",!0),(0,s.eW)(),e.$refs.draggableZone?((0,s.uX)(),(0,s.CE)("div",{key:3,class:(0,r.normalizeClass)(["wm",{"drag-end":!e.$refs.draggableZone.drag.active,"drag-start":e.$refs.draggableZone.drag.active}]),draggable:c.draggable,onDragstart:t[5]||(t[5]=t=>e.$refs.draggableZone.onDragStart(t)),onDragend:t[6]||(t[6]=t=>e.$refs.draggableZone.onDragEnd(t))},[(0,s.bF)(w,{onDraggable:t[4]||(t[4]=e=>c.draggable=e)})],42,l)):(0,s.Q3)("",!0)],2)):(0,s.Q3)("",!0),(0,s.eW)(),(0,s.bF)(h,{footer:!0}),(0,s.eW)(),(0,s.bF)(x),(0,s.eW)(),(0,s.bF)(R),(0,s.eW)(),(0,s.bF)(P,{ref:"draggableZone"},null,512)])}var c=a(66278),u=a(97486),h=a(97284),p=a(87244),g=a(29914),m=a(13386);const v=e=>((0,s.Qi)("data-v-1983552e"),e=e(),(0,s.jt)(),e),f={class:"text-default-text"},b={class:"pl-10 pr-10"},y={key:0},k=v((()=>(0,s.Lk)("div",{class:"spacer"},null,-1))),S=v((()=>(0,s.Lk)("div",{class:"spacer"},null,-1))),A={class:"dialog-actions"};function w(e,t,a,o,n,i){const l=(0,s.g2)("LabeledSelect"),d=(0,s.g2)("Date"),c=(0,s.g2)("RadioGroup"),u=(0,s.g2)("AsyncButton"),h=(0,s.g2)("Banner"),p=(0,s.g2)("Card"),g=(0,s.g2)("app-modal"),m=(0,s.gN)("clean-html"),v=(0,s.gN)("t");return n.loaded?((0,s.uX)(),(0,s.Wv)(g,{key:0,"custom-class":"promptrestore-modal",name:"promptRestore",styles:"background-color: var(--nav-bg); border-radius: var(--border-radius); max-height: 100vh;",height:"auto",scrollable:!0,onClose:i.close},{default:(0,s.k6)((()=>[n.loaded?((0,s.uX)(),(0,s.Wv)(p,{key:0,class:"prompt-restore","show-highlight-border":!1},{title:(0,s.k6)((()=>[(0,s.bo)((0,s.Lk)("h4",f,null,512),[[m,e.t("promptRestore.title",null,!0)]])])),body:(0,s.k6)((()=>[(0,s.Lk)("div",b,[(0,s.Lk)("form",null,[(0,s.bo)((0,s.Lk)("h3",null,null,512),[[v,"promptRestore.name"]]),(0,s.eW)(),i.isCluster?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",y,(0,r.toDisplayString)(i.snapshot.nameDisplay),1)),(0,s.eW)(),i.isCluster?((0,s.uX)(),(0,s.Wv)(l,{key:1,value:n.selectedSnapshot,"onUpdate:value":t[0]||(t[0]=e=>n.selectedSnapshot=e),label:e.t("promptRestore.label"),placeholder:e.t("promptRestore.placeholder"),options:i.clusterSnapshots},null,8,["value","label","placeholder","options"])):(0,s.Q3)("",!0),(0,s.eW)(),k,(0,s.eW)(),(0,s.bo)((0,s.Lk)("h3",null,null,512),[[v,"promptRestore.date"]]),(0,s.eW)(),(0,s.Lk)("div",null,[(0,s.Lk)("p",null,[i.snapshot?((0,s.uX)(),(0,s.Wv)(d,{key:0,value:i.snapshot.createdAt||i.snapshot.created||i.snapshot.metadata.creationTimestamp},null,8,["value"])):(0,s.Q3)("",!0)])]),(0,s.eW)(),S,(0,s.eW)(),(0,s.bF)(c,{value:n.restoreMode,"onUpdate:value":t[1]||(t[1]=e=>n.restoreMode=e),name:"restoreMode",label:"Restore Type",labels:["Only etcd","Kubernetes version and etcd","Cluster config, Kubernetes version and etcd"],options:i.restoreModeOptions},null,8,["value","options"])])])])),actions:(0,s.k6)((()=>[(0,s.Lk)("div",A,[(0,s.Lk)("button",{class:"btn role-secondary",onClick:t[2]||(t[2]=(...e)=>i.close&&i.close(...e))},(0,r.toDisplayString)(e.t("generic.cancel")),1),(0,s.eW)(),(0,s.bF)(u,{mode:"restore",disabled:!i.hasSnapshot,onClick:i.apply},null,8,["disabled","onClick"]),(0,s.eW)(),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.errors,((e,t)=>((0,s.uX)(),(0,s.Wv)(h,{key:t,color:"error",label:e},null,8,["label"])))),128))])])),_:1})):(0,s.Q3)("",!0)])),_:1},8,["onClose"])):(0,s.Q3)("",!0)}var x=a(17793),R=a(99910),P=a(17899),$=a(57697),C=a(66199),E=a(66070),L=a(95510),W=a(45848),I=a(13097),M=a(66383),D=a(45363),T=a(74353),F=a.n(T),N=a(7958),_=a(39147),X=a(79922);const G={components:{Card:R.Z,AsyncButton:x.A,Banner:P.l,Date:$["default"],LabeledSelect:E.A,RadioGroup:C.A,AppModal:X.A},name:"PromptRestore",mixins:[M.Ay],data(){return{errors:[],labels:{},restoreMode:"all",loaded:!1,allSnapshots:{},sortedSnapshots:[],selectedSnapshot:null}},computed:{...(0,c.aH)("action-menu",["showPromptRestore","toRestore"]),...(0,c.L8)({t:"i18n/t"}),isCluster(){const e=this.toRestore[0]?.type.toLowerCase()===W.k$.ETCD_BACKUP||this.toRestore[0]?.type.toLowerCase()===W.xO;return!e},snapshot(){return this.isCluster?this.allSnapshots[this.selectedSnapshot]:this.toRestore[0]},hasSnapshot(){return!!this.snapshot},isRke2(){return!!this.snapshot?.rke2},clusterSnapshots(){return this.sortedSnapshots?this.sortedSnapshots.map((e=>({label:this.snapshotLabel(e),value:e.name}))):[]},restoreModeOptions(){const e=this.isRke2?"none":"etcd";return[e,"kubernetesVersion","all"]}},watch:{async showPromptRestore(e){e?(this.loaded=!0,await this.fetchSnapshots(),this.selectDefaultSnapshot()):this.loaded=!1}},methods:{close(){this.errors=[],this.labels={},this.$store.commit("action-menu/togglePromptRestore"),this.selectedSnapshot=null},async fetchSnapshots(){if(!this.isCluster)return;const e=this.toRestore?.[0];let t;t=e?.isRke2?this.$store.dispatch("management/findAll",{type:W.xO}).then((t=>{const a=e?.clusterName||e?.metadata?.name;return t.filter((e=>e?.snapshotFile?.status===_.jv.SUCCESSFUL&&e.clusterName===a))})):this.$store.dispatch("rancher/findAll",{type:W.k$.ETCD_BACKUP}).then((t=>t.filter((t=>t.state===_.jv.ACTIVE&&t.clusterId===e.metadata.name))));const a=await t.then((e=>e.reduce(((e,t)=>(e[t.name]=t,e)),{}))).catch((e=>{this.errors=(0,L.rz)(e)}));this.allSnapshots=a,this.sortedSnapshots=(0,N.Ul)(Object.values(this.allSnapshots),["snapshotFile.createdAt","created","metadata.creationTimestamp"],!0)},selectDefaultSnapshot(){if(this.selectedSnapshot)return;const e=this.toRestore[0]?.type===W.xO?this.toRestore[0].name:this.clusterSnapshots[0]?.value;this["selectedSnapshot"]=e},async apply(e){try{if(this.isRke2){const e=this.$store.getters["management/byId"](W.qt.RANCHER_CLUSTER,this.snapshot.clusterId);await this.applyHooks(M.Fm);const t=e.spec?.rkeConfig?.etcdSnapshotRestore?.generation||0;(0,I.set)(e,"spec.rkeConfig.etcdSnapshotRestore",{generation:t+1,name:this.snapshot.name,restoreRKEConfig:this.restoreMode}),await e.save()}else await this.$store.dispatch("rancher/request",{url:`/v3/clusters/${escape(this.snapshot.clusterId)}?action=restoreFromEtcdBackup`,method:"post",data:{etcdBackupId:this.snapshot.id,restoreRkeConfig:this.restoreMode}});this.$store.dispatch("growl/success",{title:this.t("promptRestore.notification.title"),message:this.t("promptRestore.notification.message",{selectedSnapshot:this.selectedSnapshot})},{root:!0}),e(!0),this.close()}catch(t){this.errors=(0,L.rz)(t),e(!1)}},snapshotLabel(e){const t=(0,D.ZD)(this.$store.getters["prefs/get"](u.DATE_FORMAT)),a=(0,D.ZD)(this.$store.getters["prefs/get"](u.TIME_FORMAT)),s=e.createdAt||e.created||e.metadata.creationTimestamp,r=F()(s).format(t),o=F()(s).format(a);return`${r} ${o} : ${e.nameDisplay}`}}};a(40939);var U=a(66262);const Q=(0,U.A)(G,[["render",w],["__scopeId","data-v-1983552e"]]),V=Q;var O=a(22518),z=a(65983),H=a(29758),B=a(46377),Z=a(32868),K=a(23895),q=a(97587),j=a(98883);const Y={key:0};function J(e,t,a,o,n,i){return e.drag.active?((0,s.uX)(),(0,s.CE)("div",Y,[e.drag.zone!=e.pin?((0,s.uX)(),(0,s.CE)("span",{key:0,class:(0,r.normalizeClass)(["pin-effect-area",e.drag.zone])},null,2)):(0,s.Q3)("",!0),(0,s.eW)(),(0,s.Lk)("span",{class:"drag-area center",onDragover:t[0]||(t[0]=t=>e.onDragOver(t,"center"))},null,32),(0,s.eW)(),(0,s.Lk)("span",{class:"drag-area right",onDragover:t[1]||(t[1]=t=>e.onDragOver(t,"right"))},null,32),(0,s.eW)(),(0,s.Lk)("span",{class:"drag-area bottom",onDragover:t[2]||(t[2]=t=>e.onDragOver(t,"bottom"))},null,32),(0,s.eW)(),(0,s.Lk)("span",{class:"drag-area left",onDragover:t[3]||(t[3]=t=>e.onDragOver(t,"left"))},null,32)])):(0,s.Q3)("",!0)}var ee=a(65017);const te=(0,s.pM)({data(){return{drag:{active:!1,zone:ee.Q7}}},computed:{...(0,c.aH)("wm",["userPin"]),pin:{get(){return this.userPin},set(e){e!==ee.Q7&&(window.localStorage.setItem("wm-pin",e),this.$store.commit("wm/setUserPin",e))}}},methods:{onDragStart(){this.drag.active=!0},onDragOver(e,t){this.drag.zone=t,t!==ee.Q7&&e.preventDefault()},onDragEnd(){this.pin=this.drag.zone,this.drag={active:!1,zone:ee.Q7}}}});a(29559);const ae=(0,U.A)(te,[["render",J],["__scopeId","data-v-821cd8e8"]]),se=ae;var re=a(2404),oe=a.n(re),ne=a(63360),ie=a(25556),le=a(66216),de=a(44151);const ce={class:"side-nav"},ue={class:"nav"},he={key:0,class:"footer"},pe={class:"clip version text-muted"},ge={key:0},me={"data-testid":"locale-selector",class:"locale-chooser"},ve={class:"list-unstyled dropdown",style:{margin:"-1px"}},fe=["onClick"],be={key:1,class:"version text-muted flex"},ye={key:0,class:"clip text-muted ml-5"};function ke(e,t,a,o,n,i){const l=(0,s.g2)("Group"),d=(0,s.g2)("router-link"),c=(0,s.g2)("v-dropdown"),u=(0,s.gN)("clean-tooltip");return(0,s.uX)(),(0,s.CE)("nav",ce,[(0,s.Lk)("div",ue,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.groups,(e=>((0,s.uX)(),(0,s.Wv)(l,{key:e.name,ref_for:!0,ref:"groups","id-prefix":"",class:"package",group:e,"can-collapse":!e.isRoot,"show-header":!e.isRoot,onSelected:t[0]||(t[0]=e=>i.groupSelected(e)),onExpand:t[1]||(t[1]=e=>i.groupSelected(e))},null,8,["group","can-collapse","show-header"])))),128))]),(0,s.eW)(),i.showProductFooter?((0,s.uX)(),(0,s.CE)("div",he,[(0,s.bF)(d,{to:i.supportLink,class:"pull-right"},{default:(0,s.k6)((()=>[(0,s.eW)((0,r.toDisplayString)(e.t("nav.support",{hasSupport:!0})),1)])),_:1},8,["to"]),(0,s.eW)(),(0,s.bo)(((0,s.uX)(),(0,s.CE)("span",pe,[(0,s.eW)((0,r.toDisplayString)(i.displayVersion),1)])),[[u,{content:i.displayVersion,placement:"top"}]]),(0,s.eW)(),e.isSingleProduct?((0,s.uX)(),(0,s.CE)("span",ge,[(0,s.bF)(c,{popperClass:"localeSelector",placement:"top",triggers:["click"]},{popper:(0,s.k6)((()=>[(0,s.Lk)("ul",ve,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.availableLocales,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t,class:"hand",onClick:e=>i.switchLocale(t)},(0,r.toDisplayString)(e),9,fe)))),128))])])),default:(0,s.k6)((()=>[(0,s.Lk)("a",me,(0,r.toDisplayString)(e.locale),1),(0,s.eW)()])),_:1})])):(0,s.Q3)("",!0)])):((0,s.uX)(),(0,s.CE)("div",be,[i.singleProductAbout?((0,s.uX)(),(0,s.Wv)(d,{key:0,to:i.singleProductAbout},{default:(0,s.k6)((()=>[(0,s.eW)((0,r.toDisplayString)(i.displayVersion),1)])),_:1},8,["to"])):((0,s.uX)(),(0,s.CE)(s.FK,{key:1},[e.isVirtualCluster&&e.isExplorer?(0,s.bo)(((0,s.uX)(),(0,s.CE)("span",ye,[(0,s.eW)("\n          (Harvester-"+(0,r.toDisplayString)(i.harvesterVersion)+")\n        ",1)])),[[u,{content:i.harvesterVersion,placement:"top"}]]):(0,s.Q3)("",!0)],64))]))])}var Se=a(38221),Ae=a.n(Se),we=a(26358),xe=a(85414),Re=a(98918),Pe=a(1677),$e=a(95299),Ce=a(35985);const Ee={name:"SideNav",components:{Group:Ce.A},data(){return{groups:[],gettingGroups:!1}},created(){this.queueUpdate=Ae()(this.getGroups,500),this.getGroups()},mounted(){this.$nextTick((()=>this.syncNav()))},watch:{allSchemasIds(e,t){(0,we.P1)(e,t)||this.queueUpdate()},allNavLinksIds(e,t){(0,we.P1)(e,t)||this.queueUpdate()},favoriteTypes(e,t){oe()(e,t)||this.queueUpdate()},locale(e,t){oe()(e,t)||this.getGroups()},namespaceMode(e,t){e!==t&&this.queueUpdate()},namespaces(e,t){oe()(e,t)||this.queueUpdate()},clusterReady(e,t){oe()(e,t)||this.getGroups()},rootProduct(e,t){e?.name!==t?.name&&this.getGroups()},$route(e,t){this.$nextTick((()=>this.syncNav()))}},computed:{...(0,c.aH)(["managementReady","clusterReady"]),...(0,c.L8)(["productId","clusterId","currentProduct","rootProduct","isSingleProduct","namespaceMode","isExplorer","isVirtualCluster"]),...(0,c.L8)({locale:"i18n/selectedLocaleLabel",availableLocales:"i18n/availableLocales"}),...(0,c.L8)("type-map",["activeProducts"]),favoriteTypes:(0,u.mapPref)(u.FAVORITE_TYPES),supportLink(){const e=this.rootProduct;return e?.supportRoute?{...e.supportRoute,params:{...e.supportRoute.params,cluster:this.clusterId}}:{name:`c-cluster-${e?.name}-support`}},displayVersion(){if(this.isSingleProduct?.getVersionInfo)return this.isSingleProduct?.getVersionInfo(this.$store);const{displayVersion:e}=(0,ne.hQ)(this.$store);return e},singleProductAbout(){return this.isSingleProduct?.aboutPage},harvesterVersion(){return this.$store.getters["cluster/byId"](W.rk.SETTING,"server-version")?.value||"unknown"},showProductFooter(){return!!this.isVirtualProduct},isVirtualProduct(){return this.rootProduct.name===xe.T},allNavLinks(){return this.clusterId&&this.$store.getters["cluster/schemaFor"](W.UI.NAV_LINK)?this.$store.getters["cluster/all"](W.UI.NAV_LINK):[]},allSchemasIds(){const e=this.managementReady,t=this.currentProduct;return e&&t?this.$store.getters[`${t.inStore}/all`](W.yx).map((e=>e.id)).sort():[]},namespaces(){return this.$store.getters["activeNamespaceCache"]},allNavLinksIds(){return this.allNavLinks.map((e=>e.id))}},methods:{getGroups(){if(this.gettingGroups)return;if(this.gettingGroups=!0,!this.clusterReady)return(0,we.IU)(this.groups),void(this.gettingGroups=!1);const e=this.$store.getters["productId"],t="both",a=[],s=this.isExplorer?[Re.NAME]:[],r=this.activeProducts.reduce(((e,t)=>({...e,[t.name]:t})),{});if(this.isExplorer)for(const o of this.activeProducts)"cluster"===o.inStore&&(0,we.PG)(s,o.name);(0,we.PG)(s,e),this.getProductsGroups(a,s,t,r),this.getExplorerGroups(a),(0,we.bG)(this.groups,...(0,N.Ul)(a,["weight:desc","label"])),this.gettingGroups=!1},getProductsGroups(e,t,a,s){const r=this.$store.getters["clusterId"],o=this.$route.params.resource||"";for(const n of t){const t=[Pe.TYPE_MODES.BASIC];if(n===$e.NAME)continue;n===Re.NAME&&(t.push(Pe.TYPE_MODES.FAVORITE),t.push(Pe.TYPE_MODES.USED));const i=this.$store.getters["type-map/allTypes"](n,t);for(const l of t){const t=i[l]||{},d=this.$store.getters["type-map/getTree"](n,l,t,r,a,o);if(n!==Re.NAME&&this.isExplorer){const t=d.find((e=>"root"===e.name)),a=d.filter((e=>"root"!==e.name)),r={name:n,label:this.$store.getters["i18n/withFallback"](`product.${n}`,null,(0,D.TF)(n)),children:[...t?.children||[],...a],weight:s[n]?.weight||0};(0,we.PG)(e,r)}else(0,we.cn)(e,d)}}},getExplorerGroups(e){if(this.isExplorer){const t=this.allNavLinks,a=[],s={};for(const e of t){if(!e.link)continue;const t=e.spec.group,r=e.normalizedGroup,o={name:`link-${e._key}`,link:e.link,target:e.actualTarget,label:e.labelDisplay,sideLabel:e.spec.sideLabel,iconSrc:e.spec.iconSrc,description:e.spec.description};if(r){if(s[r])continue;s[r]=!0,a.push({name:`navlink-group-${r}`,label:t,isRoot:!0,children:[{name:`navlink-child-${r}`,label:t,route:{name:"c-cluster-navlinks-group",params:{cluster:this.clusterId,group:r}}}],weight:-100})}else a.push({name:`navlink-${o.name}`,label:o.label,isRoot:!0,children:[o],weight:-100})}(0,we.cn)(e,a)}},groupSelected(e){this.$refs.groups.forEach((t=>{t.canCollapse&&(t.isExpanded=t.group.name===e.name)}))},collapseAll(){this.$refs.groups.forEach((e=>{e.isExpanded=!1}))},switchLocale(e){this.$store.dispatch("i18n/switchTo",e)},syncNav(){const e=this.$refs.groups;if(e){let t=!0;const a=e.filter((e=>e.isExpanded))[0];if(a&&a.hasActiveRoute())return void this.$nextTick((()=>a.syncNav()));e.forEach((e=>{if(!e.group.isRoot&&(e.isExpanded=!1,t)){const a=e.hasActiveRoute();a&&(e.isExpanded=!0,t=!1,this.$nextTick((()=>e.syncNav())))}}))}}}};a(24492);const Le=(0,U.A)(Ee,[["render",ke],["__scopeId","data-v-2cbfa658"]]),We=Le;var Ie=a(57949);const Me="set-as-login",De={components:{PromptRemove:m.A,PromptRestore:V,AssignTo:z.A,PromptModal:O.A,Header:H.A,ActionMenu:h.A,GrowlManager:p.A,WindowManager:g["default"],FixedBanner:K.A,AwsComplianceBanner:q.A,AzureWarning:j.A,DraggableZone:se,Inactivity:B.A,SideNav:We},mixins:[ie.A,Z.A,le.A],data(){return{noLocaleShortcut:!1,wantNavSync:!1,unwatchPin:void 0,wmPin:null,draggable:!1}},computed:{...(0,c.aH)(["managementReady","clusterReady"]),...(0,c.L8)(["clusterId","currentProduct","rootProduct","isRancherInHarvester","showTopLevelMenu"]),afterLoginRoute:(0,u.mapPref)(u.AFTER_LOGIN_ROUTE),themeShortcut:(0,u.mapPref)(u.THEME_SHORTCUT),pageActions(){const e=[],t=this.rootProduct;if(!t)return[];const a="cluster"===t.inStore||"management"===t.inStore&&"configuration"!==t.category||this.isRancherInHarvester;return a&&e.push({labelKey:"nav.header.setLoginPage",action:Me}),e},unmatchedRoute(){return!this.$route?.matched?.length},clusterAndRouteReady(){const e=this.$store.getters["targetRoute"],t=e?this.currentProduct?.name===(0,de.P)(this.$route)&&this.currentProduct?.name===(0,de.P)(e):this.currentProduct?.name===(0,de.P)(this.$route);return this.clusterReady&&this.clusterId===(0,de.Ij)(this.$route)&&t},pinClass(){return`pin-${this.wmPin}`}},watch:{clusterId(e,t){oe()(e,t)||this.setClusterAsLastRoute()},async currentProduct(e,t){if(!oe()(e,t)&&(e.inStore!==t.inStore||"cluster"!==e.inStore)&&this.clusterId&&e.name){const t={name:"c-cluster-product",params:{cluster:this.clusterId,product:e.name}};await this.$store.dispatch("prefs/setLastVisited",t)}}},async created(){await this.$store.dispatch("prefs/setLastVisited",this.$route)},mounted(){this.wmPin=window.localStorage.getItem("wm-pin")||ee._N,this.$refs.draggableZone.pin=this.wmPin,this.unwatchPin=this.$watch("$refs.draggableZone.pin",(e=>{this.wmPin=e}))},unmounted(){this.unwatchPin()},methods:{async setClusterAsLastRoute(){if(!this.clusterId||this.clusterId===Ie.w)return;const e={name:this.$route.name,params:{...this.$route.params,cluster:this.clusterId}};await this.$store.dispatch("prefs/setLastVisited",e)},handlePageAction(e){e.action===Me&&(this.afterLoginRoute=this.getLoginRoute(),(0,ne.FM)(this.$store))},getLoginRoute(){return{name:this.$route.name,params:this.$route.params}},toggleNoneLocale(){this.$store.dispatch("i18n/toggleNone")},toggleTheme(){this.$store.dispatch("prefs/toggleTheme")},wheresMyDebugger(){},async toggleShell(){const e=this.$route.params.cluster;if(!e)return;const t=await this.$store.dispatch("management/find",{type:W.Mc.CLUSTER,id:e});t&&t.openShell()}}},Te=(0,U.A)(De,[["render",d]]),Fe=Te},29559:(e,t,a)=>{var s=a(74777);s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);var r=a(99548).A;r("4bd603a8",s,!0,{sourceMap:!1,shadowMode:!1})},40939:(e,t,a)=>{var s=a(18401);s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);var r=a(99548).A;r("171acc6a",s,!0,{sourceMap:!1,shadowMode:!1})},24492:(e,t,a)=>{var s=a(53202);s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);var r=a(99548).A;r("24e7b898",s,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=5352.fc089ddd.js.map