{"version":3,"file":"js/6469.511df972.js","mappings":"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","sources":["webpack://dashboard/./shell/pages/c/_cluster/auth/roles/index.vue","webpack://dashboard/./shell/pages/c/_cluster/auth/roles/index.vue?7b24"],"sourcesContent":["<script>\nimport { mapGetters } from 'vuex';\nimport Tab from '@shell/components/Tabbed/Tab';\nimport Tabbed from '@shell/components/Tabbed';\nimport { MANAGEMENT } from '@shell/config/types';\nimport ResourceTable from '@shell/components/ResourceTable';\nimport Loading from '@shell/components/Loading';\nimport { SUBTYPE_MAPPING, CREATE_VERBS } from '@shell/models/management.cattle.io.roletemplate';\nimport { NAME } from '@shell/config/product/auth';\nimport { BLANK_CLUSTER } from '@shell/store/store-types.js';\nimport { Banner } from '@components/Banner';\n\nconst GLOBAL = SUBTYPE_MAPPING.GLOBAL.key;\nconst CLUSTER = SUBTYPE_MAPPING.CLUSTER.key;\nconst PROJECT = SUBTYPE_MAPPING.NAMESPACE.key;\n\nconst createGlobalRole = {\n  name:   `c-cluster-${ NAME }-roles-resource-create`,\n  params: {\n    cluster:  BLANK_CLUSTER,\n    resource: MANAGEMENT.GLOBAL_ROLE,\n  }\n};\nconst createRoleTemplate = {\n  name:   `c-cluster-${ NAME }-roles-resource-create`,\n  params: {\n    cluster:  BLANK_CLUSTER,\n    resource: MANAGEMENT.ROLE_TEMPLATE,\n  }\n};\n\nexport default {\n  name: 'Roles',\n\n  components: {\n    Tab, Tabbed, ResourceTable, Loading, Banner\n  },\n\n  async fetch() {\n    const globalRoleSchema = this.$store.getters[`management/schemaFor`](MANAGEMENT.GLOBAL_ROLE);\n    const roleTemplatesSchema = this.$store.getters[`management/schemaFor`](MANAGEMENT.ROLE_TEMPLATE);\n\n    this['globalRoles'] = globalRoleSchema ? await this.$store.dispatch(`management/findAll`, { type: MANAGEMENT.GLOBAL_ROLE }) : [];\n    this['roleTemplates'] = roleTemplatesSchema ? await this.$store.dispatch(`management/findAll`, { type: MANAGEMENT.ROLE_TEMPLATE }) : [];\n  },\n\n  data() {\n    const globalRoleSchema = this.$store.getters[`management/schemaFor`](MANAGEMENT.GLOBAL_ROLE);\n    const roleTemplatesSchema = this.$store.getters[`management/schemaFor`](MANAGEMENT.ROLE_TEMPLATE);\n\n    const roleTemplateHeaders = this.$store.getters['type-map/headersFor'](roleTemplatesSchema);\n    const defaultHeaderIndex = roleTemplateHeaders.findIndex((header) => header.name === 'default');\n\n    return {\n      tabs: {\n        [GLOBAL]: {\n          canFetch:       globalRoleSchema?.collectionMethods.find((verb) => verb === 'GET'),\n          canCreate:      globalRoleSchema?.resourceMethods.find((verb) => CREATE_VERBS.has(verb)),\n          weight:         3,\n          labelKey:       SUBTYPE_MAPPING.GLOBAL.labelKey,\n          schema:         globalRoleSchema,\n          createLocation: {\n            ...createGlobalRole,\n            query: { roleContext: GLOBAL }\n          },\n        },\n        [CLUSTER]: {\n          canFetch:       roleTemplatesSchema?.collectionMethods.find((verb) => verb === 'GET'),\n          canCreate:      roleTemplatesSchema?.resourceMethods.find((verb) => CREATE_VERBS.has(verb)),\n          labelKey:       SUBTYPE_MAPPING.CLUSTER.labelKey,\n          weight:         2,\n          schema:         roleTemplatesSchema,\n          headers:        this.applyDefaultHeaderLabel(roleTemplateHeaders, defaultHeaderIndex, 'tableHeaders.authRoles.clusterDefault'),\n          createLocation: {\n            ...createRoleTemplate,\n            query: { roleContext: CLUSTER }\n          },\n        },\n        [PROJECT]: {\n          canFetch:       roleTemplatesSchema?.collectionMethods.find((verb) => verb === 'GET'),\n          canCreate:      roleTemplatesSchema?.resourceMethods.find((verb) => CREATE_VERBS.has(verb)),\n          labelKey:       SUBTYPE_MAPPING.NAMESPACE.labelKey,\n          weight:         1,\n          schema:         roleTemplatesSchema,\n          headers:        this.applyDefaultHeaderLabel(roleTemplateHeaders, defaultHeaderIndex, 'tableHeaders.authRoles.projectDefault'),\n          createLocation: {\n            ...createRoleTemplate,\n            query: { roleContext: PROJECT }\n          },\n        },\n      },\n\n      GLOBAL,\n      CLUSTER,\n      PROJECT,\n\n      globalRoles:   null,\n      roleTemplates: null,\n    };\n  },\n\n  computed: {\n    ...mapGetters(['releaseNotesUrl']),\n\n    globalResources() {\n      return this.globalRoles;\n    },\n\n    clusterResources() {\n      return this.roleTemplates.filter((r) => r.context === SUBTYPE_MAPPING.CLUSTER.context);\n    },\n\n    namespaceResources() {\n      return this.roleTemplates.filter((r) => r.context === SUBTYPE_MAPPING.NAMESPACE.context);\n    },\n\n    type() {\n      if (this.$route.hash.endsWith(PROJECT)) {\n        return PROJECT;\n      }\n      if (this.$route.hash.endsWith(CLUSTER)) {\n        return CLUSTER;\n      }\n\n      return GLOBAL;\n    },\n\n    canCreate() {\n      return this.tabs[this.type].canCreate;\n    },\n\n    createLabel() {\n      return this.t(`rbac.roletemplate.subtypes.${ this.type }.createButton`);\n    },\n\n    createLocation() {\n      return this.tabs[this.type].createLocation;\n    }\n\n  },\n\n  methods: {\n    applyDefaultHeaderLabel(roleTemplateHeaders, defaultHeaderIndex, labelKey) {\n      const headers = [...roleTemplateHeaders];\n\n      headers[defaultHeaderIndex] = {\n        ...roleTemplateHeaders[defaultHeaderIndex],\n        labelKey,\n      };\n\n      return headers;\n    }\n  }\n\n};\n</script>\n\n<template>\n  <Loading v-if=\"$fetchState.pending\" />\n  <div v-else>\n    <header>\n      <div class=\"title\">\n        <h1 class=\"m-0\">\n          {{ t('auth.roleTemplate') }}\n        </h1>\n      </div>\n      <div class=\"actions-container\">\n        <div class=\"actions\">\n          <router-link\n            v-if=\"canCreate\"\n            :to=\"createLocation\"\n            class=\"btn role-primary\"\n          >\n            {{ createLabel }}\n          </router-link>\n        </div>\n      </div>\n    </header>\n    <Tabbed>\n      <Tab\n        v-if=\"tabs[GLOBAL].canFetch\"\n        :name=\"GLOBAL\"\n        :weight=\"tabs[GLOBAL].weight\"\n        :label-key=\"tabs[GLOBAL].labelKey\"\n      >\n        <Banner\n          color=\"warning\"\n          class=\"mb-20\"\n        >\n          <span v-clean-html=\"t('rbac.globalRoles.role.restricted-admin.deprecation', { releaseNotesUrl }, true)\" />\n        </Banner>\n        <ResourceTable\n          :schema=\"tabs[GLOBAL].schema\"\n          :rows=\"globalResources\"\n        />\n      </Tab>\n\n      <Tab\n        v-if=\"tabs[CLUSTER].canFetch\"\n        :name=\"CLUSTER\"\n        :weight=\"tabs[CLUSTER].weight\"\n        :label-key=\"tabs[CLUSTER].labelKey\"\n      >\n        <ResourceTable\n          :schema=\"tabs[CLUSTER].schema\"\n          :headers=\"tabs[CLUSTER].headers\"\n          :rows=\"clusterResources\"\n        />\n      </Tab>\n\n      <Tab\n        v-if=\"tabs[PROJECT].canFetch\"\n        :name=\"PROJECT\"\n        :weight=\"tabs[PROJECT].weight\"\n        :label-key=\"tabs[PROJECT].labelKey\"\n      >\n        <ResourceTable\n          :schema=\"tabs[PROJECT].schema\"\n          :headers=\"tabs[PROJECT].headers\"\n          :rows=\"namespaceResources\"\n        />\n      </Tab>\n    </Tabbed>\n  </div>\n</template>\n","import { render } from \"./index.vue?vue&type=template&id=52bc8b1d\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","$fetchState","t","to","createLocation","createLabel","tabs","GLOBAL","name","weight","labelKey","color","releaseNotesUrl","schema","rows","globalResources","CLUSTER","headers","clusterResources","PROJECT","namespaceResources","SUBTYPE_MAPPING","key","NAMESPACE","createGlobalRole","NAME","params","cluster","resource","GLOBAL_ROLE","createRoleTemplate","ROLE_TEMPLATE","components","Tab","Tabbed","ResourceTable","Loading","Banner","fetch","globalRoleSchema","this","$store","getters","roleTemplatesSchema","dispatch","type","data","roleTemplateHeaders","defaultHeaderIndex","findIndex","header","canFetch","collectionMethods","find","verb","canCreate","resourceMethods","CREATE_VERBS","has","query","roleContext","applyDefaultHeaderLabel","globalRoles","roleTemplates","computed","filter","r","context","$route","hash","endsWith","methods","__exports__","render"],"sourceRoot":""}