(self["webpackChunkdashboard"]=self["webpackChunkdashboard"]||[]).push([[8268],{53491:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>l});var s=o(45522),a=o.n(s),r=o(67643),n=o.n(r),i=n()(a());i.push([e.id,".assign-modal{border-radius:var(--border-radius);overflow:scroll;max-height:100vh}.assign-modal ::-webkit-scrollbar-corner{background:transparent}",""]);const l=i},14079:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>l});var s=o(45522),a=o.n(s),r=o(67643),n=o.n(r),i=n()(a());i.push([e.id,".aws-compliance[data-v-d5d708ce]{background-color:var(--error);color:var(--error-text);line-height:2em;width:100%}.aws-compliance[data-v-d5d708ce],.aws-compliance>p[data-v-d5d708ce]{text-align:center}",""]);const l=i},27657:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>l});var s=o(45522),a=o.n(s),r=o(67643),n=o.n(r),i=n()(a());i.push([e.id,".prompt-remove.card-container{box-shadow:none}.prompt-remove #confirm{width:90%;margin-left:3px}.prompt-remove .actions{text-align:right}.prompt-remove .card-actions{display:flex}.prompt-remove .card-actions .spacer{flex:1}",""]);const l=i},7306:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>l});var s=o(45522),a=o.n(s),r=o(67643),n=o.n(r),i=n()(a());i.push([e.id,"#azure-warn[data-v-06a043b9]{background-color:var(--warning);color:var(--warning-text);line-height:2em;width:100%}#azure-warn>p[data-v-06a043b9]{text-align:center}",""]);const l=i},65983:(e,t,o)=>{"use strict";o.d(t,{A:()=>k});var s=o(20641),a=o(90033);const r={class:"text-default-text"},n={class:"pl-10 pr-10"};function i(e,t,o,i,l,c){const m=(0,s.g2)("LabeledSelect"),d=(0,s.g2)("KeyValue"),h=(0,s.g2)("Banner"),p=(0,s.g2)("AsyncButton"),u=(0,s.g2)("Card"),v=(0,s.g2)("app-modal"),g=(0,s.gN)("clean-html");return l.showModal?((0,s.uX)(),(0,s.Wv)(v,{key:0,class:"assign-modal",name:"assignTo",styles:"background-color: var(--nav-bg); border-radius: var(--border-radius); max-height: 100vh;",height:"auto",scrollable:!0,onClose:c.close},{default:(0,s.k6)((()=>[l.loaded?((0,s.uX)(),(0,s.Wv)(u,{key:0,"show-highlight-border":!1},{title:(0,s.k6)((()=>[(0,s.bo)((0,s.Lk)("h4",r,null,512),[[g,e.t("assignTo.title",{count:c.resourceCount},!0)]])])),body:(0,s.k6)((()=>[(0,s.Lk)("div",n,[(0,s.Lk)("form",null,[(0,s.bF)(m,{value:l.moveTo,"onUpdate:value":t[0]||(t[0]=e=>l.moveTo=e),label:e.t("assignTo.workspace"),options:c.workspaceOptions,placement:"bottom"},null,8,["value","label","options"]),(0,s.eW)(),(0,s.bF)(d,{key:"labels",value:l.labels,"onUpdate:value":t[1]||(t[1]=e=>l.labels=e),class:"mt-20","add-label":e.t("labels.addSetLabel"),"read-allowed":!1},null,8,["value","add-label"]),(0,s.eW)(),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.errors,((e,t)=>((0,s.uX)(),(0,s.Wv)(h,{key:t,color:"error",label:e},null,8,["label"])))),128))])])])),actions:(0,s.k6)((()=>[(0,s.Lk)("button",{class:"btn role-secondary",onClick:t[2]||(t[2]=(...e)=>c.close&&c.close(...e))},(0,a.toDisplayString)(e.t("generic.cancel")),1),(0,s.eW)(),(0,s.bF)(p,{mode:"apply",onClick:c.apply},null,8,["onClick"])])),_:1})):(0,s.Q3)("",!0)])),_:1},8,["onClose"])):(0,s.Q3)("",!0)}var l=o(66278),c=o(45848),m=o(66070),d=o(75429),h=o(17793),p=o(79922),u=o(99910),v=o(17899),g=o(95510),f=o(13097);const y={components:{Card:u.Z,LabeledSelect:m.A,KeyValue:d.A,AsyncButton:h.A,Banner:v.l,AppModal:p.A},data(){return{errors:[],labels:{},moveTo:this.workspace,loaded:!1,allWorkspaces:[],showModal:!1}},computed:{...(0,l.aH)("action-menu",["showAssignTo","toAssign"]),...(0,l.L8)({t:"i18n/t"}),...(0,l.L8)(["workspace"]),workspaceOptions(){const e=this.allWorkspaces.map((e=>e.metadata?.name)).filter((e=>!!e&&"fleet-local"!==e));return e},resourceCount(){return this.toAssign?.length||0}},watch:{async showAssignTo(e){e?(await this.$store.dispatch("rancher/findAll",{type:c.k$.CLUSTER}),this.allWorkspaces=await this.$store.dispatch("management/findAll",{type:c.Hs.WORKSPACE}),this.moveTo=this.workspace,this.loaded=!0,this.showModal=!0):this.showModal=!1}},methods:{close(){this.errors=[],this.labels={},this.moveTo=this.workspace,this.$store.commit("action-menu/toggleAssignTo")},async apply(e){const t=[];this.errors=[];for(const s of this.toAssign){const e=await this.$store.dispatch("rancher/clone",{resource:s.norman});if(e){e.fleetWorkspaceName=this.moveTo;for(const t of Object.keys(this.labels))e._labels||(0,f.set)(e,"_labels",{}),(0,f.set)(e._labels,t,this.labels[t]);t.push(e.save())}}try{await Promise.all(t),e(!0),this.close()}catch(o){this.errors=(0,g.rz)(o),e(!1)}}}};o(43649);var b=o(66262);const R=(0,b.A)(y,[["render",i]]),k=R},97587:(e,t,o)=>{"use strict";o.d(t,{A:()=>d});var s=o(20641),a=o(90033);const r={key:0,class:"aws-compliance"};function n(e,t,o,n,i,l){return l.awsNotification?((0,s.uX)(),(0,s.CE)("div",r,(0,a.toDisplayString)(l.awsNotification.message),1)):(0,s.Q3)("",!0)}var i=o(45848);const l={async fetch(){this.$store.getters["management/schemaFor"](i.Mc.USER_NOTIFICATION)&&(this.notifications=await this.$store.dispatch("management/findAll",{type:i.Mc.USER_NOTIFICATION}))},data(){return{notifications:[]}},computed:{awsNotification(){return this.notifications.find((e=>"csp-adapter"===e.componentName))}}};o(56401);var c=o(66262);const m=(0,c.A)(l,[["render",n],["__scopeId","data-v-d5d708ce"]]),d=m},13386:(e,t,o)=>{"use strict";o.d(t,{A:()=>W});var s=o(20641),a=o(90033);const r={class:"text-default-text"},n={class:"mb-10"},i={key:2,class:"mt-10"},l={class:"text-warning mb-10 mt-10"},c={class:"text-error mb-10 mt-10"},m={key:0,class:"text-info mt-20"},d={key:1},h={class:"text-warning mb-10 mt-10"},p={class:"text-error mb-10 mt-10"},u=(0,s.Lk)("div",{class:"spacer"},null,-1);function v(e,t,o,v,g,f){const y=(0,s.g2)("Checkbox"),b=(0,s.g2)("LabeledInput"),R=(0,s.g2)("AsyncButton"),k=(0,s.g2)("Card"),w=(0,s.g2)("app-modal"),C=(0,s.gN)("clean-html"),A=(0,s.gN)("focus");return g.showModal?((0,s.uX)(),(0,s.Wv)(w,{key:0,"custom-class":"remove-modal",name:"promptRemove",width:400,height:"auto",styles:"max-height: 100vh;",onClose:f.close},{default:(0,s.k6)((()=>[(0,s.bF)(k,{class:"prompt-remove","show-highlight-border":!1},{title:(0,s.k6)((()=>[(0,s.Lk)("h4",r,(0,a.toDisplayString)(e.t("promptRemove.title")),1)])),body:(0,s.k6)((()=>[(0,s.Lk)("div",n,[g.hasCustomRemove?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[(0,s.eW)((0,a.toDisplayString)(e.t("promptRemove.attemptingToRemove",{type:f.type}))+" ",1),(0,s.bo)((0,s.Lk)("span",null,null,512),[[C,f.resourceNames(f.names,f.plusMore,e.t)]])],64)),(0,s.eW)(),g.hasCustomRemove?((0,s.uX)(),(0,s.Wv)((0,s.$y)(g.removeComponent),(0,s.v6)({key:1,ref:"customPrompt",value:e.toRemove,"onUpdate:value":t[0]||(t[0]=t=>e.toRemove=t)},e._data,{close:f.close,"needs-confirm":f.needsConfirm,value:e.toRemove,names:f.names,type:f.type,"done-location":f.doneLocation,onErrors:t[1]||(t[1]=e=>g.error=e),onDone:f.done}),null,16,["value","close","needs-confirm","names","type","done-location","onDone"])):(0,s.Q3)("",!0),(0,s.eW)(),f.needsConfirm?((0,s.uX)(),(0,s.CE)("div",i,[(0,s.bo)((0,s.Lk)("span",null,null,512),[[C,e.t("promptRemove.confirmName",{nameToMatch:f.escapeHtml(f.nameToMatch)},!0)]])])):(0,s.Q3)("",!0)]),(0,s.eW)(),f.needsConfirm?(0,s.bo)(((0,s.uX)(),(0,s.Wv)(b,{key:0,id:"confirm",value:g.confirmName,"onUpdate:value":t[3]||(t[3]=e=>g.confirmName=e),"data-testid":o.componentTestid+"-input",type:"text"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",l,(0,a.toDisplayString)(g.warning),1),(0,s.eW)(),(0,s.Lk)("div",c,(0,a.toDisplayString)(g.error),1),(0,s.eW)(),f.needsConfirm?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",m,(0,a.toDisplayString)(f.protip),1)),(0,s.eW)(),g.chartsToRemoveIsApp?((0,s.uX)(),(0,s.Wv)(y,{key:1,value:g.chartsDeleteCrd,"onUpdate:value":[t[2]||(t[2]=e=>g.chartsDeleteCrd=e),f.chartAddCrdToRemove],"label-key":"promptRemoveApp.removeCrd",class:"mt-10 type"},null,8,["value","onUpdate:value"])):(0,s.Q3)("",!0)])),_:1},8,["value","data-testid"])),[[A]]):g.hasCustomRemove?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",d,[(0,s.Lk)("div",h,(0,a.toDisplayString)(g.warning),1),(0,s.eW)(),(0,s.Lk)("div",p,(0,a.toDisplayString)(g.error),1)]))])),actions:(0,s.k6)((()=>[(0,s.Lk)("button",{class:"btn role-secondary",onClick:t[4]||(t[4]=(...e)=>f.close&&f.close(...e))},(0,a.toDisplayString)(e.t("generic.cancel")),1),(0,s.eW)(),u,(0,s.eW)(),(0,s.bF)(R,{mode:"delete",class:"btn bg-error ml-10",disabled:f.deleteDisabled,"data-testid":o.componentTestid+"-confirm-button",onClick:f.remove},null,8,["disabled","data-testid","onClick"])])),_:1})])),_:1},8,["onClose"])):(0,s.Q3)("",!0)}var g=o(66278),f=o(13097),y=o(45363),b=o(99910),R=o(73317),k=o(41057),w=o(26358),C=o(17793),A=o(68497),T=o(45848),M=o(76773),L=o(79922);const D={name:"PromptRemove",components:{Card:b.Z,Checkbox:R.S,AsyncButton:C.A,LabeledInput:M.o,AppModal:L.A},props:{componentTestid:{type:String,default:"prompt-remove"}},data(){const{resource:e}=this.$route.params;return{hasCustomRemove:!1,randomPosition:Math.random(),confirmName:"",error:"",warning:"",preventDelete:!1,removeComponent:this.$store.getters["type-map/importCustomPromptRemove"](e),chartsToRemoveIsApp:!1,chartsDeleteCrd:!1,showModal:!1}},computed:{names(){return this.toRemove.map((e=>e.nameDisplay)).slice(0,5)},nameToMatchPosition(){const e=Math.min(5,this.names.length),t=Math.floor(this.randomPosition*e);return t},nameToMatch(){return this.names[this.nameToMatchPosition]},type(){const e=new Set(this.toRemove.reduce(((e,t)=>(e.push(t.type),e)),[]));if(e.size>1)return this.t("generic.resource",{count:this.toRemove.length});const t=this.toRemove[0]?.schema;return t?this.$store.getters["type-map/labelFor"](t,this.toRemove.length):"resource"+(1===this.toRemove.length?"":"s")},selfLinks(){return this.toRemove.map((e=>(0,f.get)(e,"links.self")))},needsConfirm(){const e=this.toRemove[0];return e?.confirmRemove},plusMore(){const e=this.toRemove.length-this.names.length;return this.t("promptRemove.andOthers",{count:e})},doneLocation(){if(this.toRemove.length>1)return null;if(this.toRemove[0].doneOverride)return this.toRemove[0].doneOverride;const e=this.toRemove[0].currentRoute(),t={},o={...e.params};if(o.id&&(o.id===this.toRemove[0]?.metadata?.name||o.id===this.toRemove[0].id)){let{name:s=""}=e;const a=s.indexOf("-id");if(-1!==a&&(s=s.slice(0,a)),o.namespace){const e=s.indexOf("-namespace");-1!==e&&(s=s.slice(0,e)),delete o.namespace}delete o.id,t.params=o,t.name=s}return t},currentRouter(){return this.doneLocation?this.toRemove[0].currentRouter():null},protip(){return this.t("promptRemove.protip",{alternateLabel:k.ZA})},deleteDisabled(){const e=this.needsConfirm&&this.confirmName!==this.nameToMatch;return this.preventDelete||e},...(0,g.aH)("action-menu",["showPromptRemove","toRemove"]),...(0,g.L8)({t:"i18n/t"})},watch:{showPromptRemove(e){if(e){const e=this.toRemove[0];"c-cluster-explorer-tools"===this.currentRouter?.currentRoute?.name&&e.type===T.W8.APP&&e.spec?.chart?.metadata?.annotations[A.W8.AUTO_INSTALL]&&(this.chartsToRemoveIsApp=!0),this.showModal=!0;let{resource:t}=this.$route.params;this.toRemove.length>0&&(t=e.type),this.hasCustomRemove=this.$store.getters["type-map/hasCustomPromptRemove"](t),this.removeComponent=this.$store.getters["type-map/importCustomPromptRemove"](t)}else this.showModal=!1},toRemove(e){let t;const o=e.filter((e=>e.preventDeletionMessage));if(this.preventDelete=!1,o.length)this.preventDelete=!0,t=o[0].preventDeletionMessage;else{const o=e.filter((e=>e.warnDeletionMessage));o.length&&(t=o[0].warnDeletionMessage)}this.warning="function"===typeof t?t(this.toRemove):t||""}},methods:{resourceNames:y.Nr,escapeHtml:y.ZD,close(){this.confirmName="",this.error="",this.chartsDeleteCrd=!1,this.chartsToRemoveIsApp=!1,this.$store.commit("action-menu/togglePromptRemove")},async remove(e){if(this.doneLocation&&(this.cachedDoneLocation={...this.doneLocation}),this.hasCustomRemove&&this.$refs?.customPrompt?.remove){let t=this.$refs.customPrompt.remove(e);if(t&&t.then)try{t=await t}catch(o){return this.error=o,void e(!1)}if(void 0===t||t)return}const t=this.toRemove.some((e=>e.removeSerially));t?this.serialRemove(e):this.parallelRemove(e)},async serialRemove(e){try{const e=this.getSpoofedTypes(this.toRemove);for(const t of this.toRemove)await t.remove();await this.refreshSpoofedTypes(e),this.done()}catch(t){this.error=t.message||t,e(!1)}},async parallelRemove(e){try{"undefined"!==typeof this.toRemove[0].bulkRemove?await this.toRemove[0].bulkRemove(this.toRemove,{}):await Promise.all(this.toRemove.map((e=>e.remove())));const e=this.getSpoofedTypes(this.toRemove);await this.refreshSpoofedTypes(e),this.done()}catch(t){this.error=t.message||t,e(!1)}},done(){this.cachedDoneLocation&&!(0,f.isEmpty)(this.cachedDoneLocation)&&this.currentRouter.push(this.cachedDoneLocation),this.close()},getSpoofedTypes(e){const t=(0,w.sb)(this.toRemove.map((e=>e.type)));return t.filter(this.$store.getters["type-map/isSpoofed"])},refreshSpoofedTypes(e){const t=this.$store.getters["currentProduct"].inStore,o=e.map((e=>this.$store.dispatch(`${t}/findAll`,{type:e,opt:{force:!0}},{root:!0})));return Promise.all(o)},async chartAddCrdToRemove(){try{const e=await this.toRemove[0].relatedResourcesToRemove();this.toRemove.includes(e)?this.chartsDeleteCrd||this.toRemove.pop(e):this.toRemove.push(e)}catch(e){this.error=e,this.chartsDeleteCrd=!1}}}};o(67967);var x=o(66262);const S=(0,x.A)(D,[["render",v]]),W=S},98883:(e,t,o)=>{"use strict";o.d(t,{A:()=>u});var s=o(20641),a=o(90033);const r={key:0,id:"azure-warn",class:"banner"};function n(e,t,o,n,i,l){const c=(0,s.g2)("router-link");return l.showWarning?((0,s.uX)(),(0,s.CE)("div",r,[(0,s.Lk)("p",null,[(0,s.eW)((0,a.toDisplayString)(e.t("authConfig.azuread.updateEndpoint.banner.message"))+" ",1),(0,s.bF)(c,{to:i.authConfigRoute},{default:(0,s.k6)((()=>[(0,s.eW)((0,a.toDisplayString)(e.t("authConfig.azuread.updateEndpoint.banner.linkText")),1)])),_:1},8,["to"])])])):(0,s.Q3)("",!0)}var i=o(45848),l=o(13097),c=o(68497),m=o(57949);const d={async fetch(){this.$store.getters["isRancher"]&&this.$store.getters["management/schemaFor"](i.Mc.AUTH_CONFIG)&&(this.authConfig=await this.$store.dispatch("rancher/find",{type:i.k$.AUTH_CONFIG,id:"azuread",opt:{url:`/v3/${i.k$.AUTH_CONFIG}/azuread`}}))},data(){return{authConfig:null,authConfigRoute:{name:"c-cluster-auth-config-id",params:{cluster:this.$route.params.cluster||m.w,id:"azuread"}}}},computed:{showWarning(){return!!this.authConfig&&("true"!==(0,l.get)(this.authConfig,`annotations."${c.wk}"`)&&this.authConfig.enabled)}}};o(16496);var h=o(66262);const p=(0,h.A)(d,[["render",n],["__scopeId","data-v-06a043b9"]]),u=p},43649:(e,t,o)=>{var s=o(53491);s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);var a=o(99548).A;a("fa61e2d6",s,!0,{sourceMap:!1,shadowMode:!1})},56401:(e,t,o)=>{var s=o(14079);s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);var a=o(99548).A;a("7af725b2",s,!0,{sourceMap:!1,shadowMode:!1})},67967:(e,t,o)=>{var s=o(27657);s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);var a=o(99548).A;a("1f6b7c05",s,!0,{sourceMap:!1,shadowMode:!1})},16496:(e,t,o)=>{var s=o(7306);s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);var a=o(99548).A;a("25abf730",s,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=8268.eda04069.js.map