(self["webpackChunkdashboard"]=self["webpackChunkdashboard"]||[]).push([[8031,5614],{45666:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var o=s(45522),a=s.n(o),l=s(67643),n=s.n(l),r=n()(a());r.push([e.id,".prompt-restore[data-v-d907e8da]{margin:0}.bottom[data-v-d907e8da]{display:flex;flex-direction:column;flex:1}.bottom .banner[data-v-d907e8da]{margin-top:0}.bottom .buttons[data-v-d907e8da]{display:flex;justify-content:flex-end;width:100%}",""]);const i=r},24653:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var o=s(45522),a=s.n(o),l=s(67643),n=s.n(l),r=n()(a());r.push([e.id,".body div[data-v-3eb1f1ef]:not(:last-of-type){padding-bottom:15px}.body .retained-machine[data-v-3eb1f1ef]{display:flex;flex-direction:column}",""]);const i=r},61765:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var o=s(20641),a=s(90033);const l={class:"text-default-text"},n={class:"pl-10 pr-10",style:{"min-height":"50px",display:"flex"}},r={class:"bottom"},i={class:"buttons"};function d(e,t,s,d,c,p){const h=(0,o.g2)("Banner"),u=(0,o.g2)("AsyncButton"),m=(0,o.g2)("Card"),y=(0,o.gN)("clean-html");return(0,o.uX)(),(0,o.Wv)(m,{class:"prompt-restore","show-highlight-border":!1},{title:(0,o.k6)((()=>[(0,o.RG)(e.$slots,"title",{},(()=>[(0,o.bo)((0,o.Lk)("h4",l,null,512),[[y,s.title]])]),!0)])),body:(0,o.k6)((()=>[(0,o.RG)(e.$slots,"body",{},(()=>[(0,o.bo)((0,o.Lk)("div",n,null,512),[[y,p.decodeHtml(s.body)]])]),!0)])),actions:(0,o.k6)((()=>[(0,o.Lk)("div",r,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(c.errors,((e,t)=>((0,o.uX)(),(0,o.Wv)(h,{key:t,color:"error",label:e},null,8,["label"])))),128)),(0,o.eW)(),(0,o.Lk)("div",i,[(0,o.Lk)("button",{class:"btn role-secondary mr-10",onClick:t[0]||(t[0]=(...e)=>p.close&&p.close(...e))},(0,a.toDisplayString)(e.t("generic.cancel")),1),(0,o.eW)(),(0,o.bF)(u,{mode:s.applyMode,onClick:p.apply},null,8,["mode","onClick"])])])])),_:3})}var c=s(17793),p=s(99910),h=s(17899),u=s(95510),m=s(45363),y=s(96763);const f={emits:["close"],components:{Card:p.Z,AsyncButton:c.A,Banner:h.l},props:{applyAction:{type:Function,default:()=>{}},applyMode:{type:String,default:"create"},title:{type:String,default:""},body:{type:String,default:""},confirm:{type:Function,default:()=>{}}},data(){return{errors:[]}},methods:{decodeHtml:m.iT,close(){this.confirm(!1),this.$emit("close",!1)},async apply(e){try{await this.applyAction(e),this.confirm(!0),this.$emit("close",!0)}catch(t){y.error(t),this.errors=(0,u.rz)(t),e(!1)}}}};s(96256);var g=s(66262);const v=(0,g.A)(f,[["render",d],["__scopeId","data-v-d907e8da"]]),b=v},73089:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>g});var o=s(20641),a=s(90033);const l={class:"pl-10 pr-10 mt-20 mb-20 body"},n={key:0},r={key:1},i={key:2,class:"retained-machine"},d={class:"mb-20"};function c(e,t,s,c,p,h){const u=(0,o.g2)("GenericPrompt"),m=(0,o.gN)("clean-html");return(0,o.uX)(),(0,o.Wv)(u,(0,o.v6)(p.config,{onClose:t[0]||(t[0]=t=>e.$emit("close"))}),{body:(0,o.k6)((()=>[(0,o.Lk)("div",l,[1===p.allToDelete.length?((0,o.uX)(),(0,o.CE)("div",n,[(0,o.eW)((0,a.toDisplayString)(e.t("promptRemove.attemptingToRemove",{type:p.type}))+" ",1),(0,o.Lk)("b",null,(0,a.toDisplayString)(p.safeMachinesToDelete[0].nameDisplay),1)])):((0,o.uX)(),(0,o.CE)("div",r,(0,a.toDisplayString)(e.t("promptScaleMachineDown.attemptingToRemove",{type:p.type,count:p.allToDelete.length},!0)),1)),(0,o.eW)(),p.ignored.length?((0,o.uX)(),(0,o.CE)("div",i,[(0,o.Lk)("span",d,(0,a.toDisplayString)(e.t("promptScaleMachineDown.retainedMachine1")),1),(0,o.eW)(),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(p.ignored,(t=>(0,o.bo)(((0,o.uX)(),(0,o.CE)("span",{key:t})),[[m,e.t("promptScaleMachineDown.retainedMachine2",{name:t.nameDisplay},!0)]]))),128))])):(0,o.Q3)("",!0)])])),_:1},16)}var p=s(68497),h=s(45848),u=s(61765);const m={emits:["close"],components:{GenericPrompt:u["default"]},props:{resources:{type:Array,required:!0}},async fetch(){this.isRke2?await Promise.all([this.$store.dispatch("management/findAll",{type:h.qt.MACHINE_DEPLOYMENT}),this.$store.dispatch("management/findAll",{type:h.qt.MACHINE})]):await Promise.all([this.$store.dispatch("management/findAll",{type:h.Mc.NODE_POOL}),this.$store.dispatch("management/findAll",{type:h.Mc.NODE})])},data(){const e=this.resources[0].cluster?.isRke2,t=e?this.resources[0].cluster:this.resources[0].provisioningCluster,[s,o]=this.deleteType("isControlPlane",this.resources,t,e),[a,l]=this.deleteType("isEtcd",o,t,e),n=[s,a].filter((e=>!!e));return{cluster:t,isRke2:e,allToDelete:this.resources,safeMachinesToDelete:l,ignored:n,type:this.$store.getters["type-map/labelFor"](this.resources[0].schema,this.resources.length),config:{title:this.t("promptRemove.title"),applyMode:"delete",applyAction:this.remove}}},methods:{deleteType(e,t,s,o){const a=t.reduce(((t,s)=>(s[e]?t.typed.push(s):t.others.push(s),t)),{typed:[],others:[]}),l=o?s.machines:s.nodes,n=l.filter((t=>t[e])).length,r=a.typed.length,i=n-r===0?a.typed.pop():void 0,d=[...a.typed,...a.others];return[i,d]},async remove(){if(!this.isRke2)return void await Promise.all(this.safeMachinesToDelete.map((e=>e.norman?.doAction("scaledown"))));const e=this.safeMachinesToDelete.reduce(((e,t)=>(e.set(t.pool,e.get(t.pool)||[]),e.get(t.pool).push(t),e)),new Map),t=Array.from(e.entries());await Promise.all(t.map((([e,t])=>Promise.all(t.map((e=>(e.setAnnotation(p.qt.DELETE_MACHINE,"true"),e.save())))).then((()=>e.scalePool(-t.length,!1)))))),await this.cluster.save()}}};s(24943);var y=s(66262);const f=(0,y.A)(m,[["render",c],["__scopeId","data-v-3eb1f1ef"]]),g=f},96256:(e,t,s)=>{var o=s(45666);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var a=s(99548).A;a("814b5eee",o,!0,{sourceMap:!1,shadowMode:!1})},24943:(e,t,s)=>{var o=s(24653);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var a=s(99548).A;a("76e220d4",o,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=dialog26.ed97a26a.js.map