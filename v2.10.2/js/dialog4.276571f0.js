(self["webpackChunkdashboard"]=self["webpackChunkdashboard"]||[]).push([[4917],{47914:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var a=r(45522),s=r.n(a),o=r(67643),i=r.n(o),n=i()(s());n.push([e.id,".prompt-rotate[data-v-42e1c96a]{margin:0}.buttons[data-v-42e1c96a]{display:flex;justify-content:flex-end;width:100%}",""]);const l=n},28852:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var a=r(45522),s=r.n(a),o=r(67643),i=r.n(o),n=i()(s());n.push([e.id,".card-container{border:1px solid var(--border);box-shadow:none}",""]);const l=n},93485:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>v});var a=r(20641),s=r(90033);const o={class:"text-default-text"},i={class:"pl-10 pr-10"},n={class:"buttons"};function l(e,t,r,l,c,d){const p=(0,a.g2)("Banner"),u=(0,a.g2)("ProjectMemberEditor"),m=(0,a.g2)("AsyncButton"),h=(0,a.g2)("Card"),y=(0,a.gN)("clean-html");return(0,a.uX)(),(0,a.Wv)(h,{class:"prompt-rotate","show-highlight-border":!1,sticky:!0},{title:(0,a.k6)((()=>[(0,a.bo)((0,a.Lk)("h4",o,null,512),[[y,e.t("addProjectMemberDialog.title")]])])),body:(0,a.k6)((()=>[(0,a.Lk)("div",i,[c.error?((0,a.uX)(),(0,a.Wv)(p,{key:0,color:"error"},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.toDisplayString)(c.error),1)])),_:1})):(0,a.Q3)("",!0),(0,a.eW)(),(0,a.bF)(u,{value:c.member,"onUpdate:value":t[0]||(t[0]=e=>c.member=e),"use-two-columns-for-custom":!0},null,8,["value"])])])),actions:(0,a.k6)((()=>[(0,a.Lk)("div",n,[(0,a.Lk)("button",{class:"btn role-secondary mr-10",onClick:t[1]||(t[1]=(...e)=>d.close&&d.close(...e))},(0,s.toDisplayString)(e.t("generic.cancel")),1),(0,a.eW)(),r.saveInModal?((0,a.uX)(),(0,a.Wv)(m,{key:0,mode:"create",onClick:t[2]||(t[2]=e=>d.saveBindings(e))})):((0,a.uX)(),(0,a.CE)("button",{key:1,class:"btn role-primary",onClick:t[3]||(t[3]=(...e)=>d.apply&&d.apply(...e))},(0,s.toDisplayString)(e.t("generic.add")),1))])])),_:1})}var c=r(99910),d=r(24938),p=r(17793),u=r(15203),m=r(45848);const h={emits:["close"],components:{Card:c.Z,ProjectMemberEditor:d.A,AsyncButton:p.A,Banner:u.A},props:{resources:{type:Array,required:!0},onAdd:{type:Function,default:()=>{}},projectId:{type:String,default:null},saveInModal:{type:Boolean,default:!1}},data(){return{member:{permissionGroup:"member",custom:{},principalId:"",roleTemplateIds:[]},error:null}},computed:{principal(){const e=this.member.principalId.replace(/\//g,"%2F");return this.$store.dispatch("rancher/find",{type:m.k$.PRINCIPAL,id:this.member.principalId,opt:{url:`/v3/principals/${e}`}},{root:!0})}},methods:{async principalProperty(){const e=await this.principal;return"group"===e?.principalType?"groupPrincipalId":"userPrincipalId"},close(){this.$emit("close")},async apply(){this.onAdd(await this.createBindings()),this.close()},async createBindings(){const e=await this.principalProperty(),t=this.member.roleTemplateIds.map((t=>this.$store.dispatch("rancher/create",{type:m.k$.PROJECT_ROLE_TEMPLATE_BINDING,roleTemplateId:t,[e]:this.member.principalId,projectId:this.projectId})));return Promise.all(t)},saveBindings(e){this.error=null,this.createBindings().then((e=>Promise.all(e.map((e=>e.save()))))).then((()=>{e(!0),setTimeout(this.close,500)})).catch((t=>{this.error=t,e(!1)}))}}};r(52444),r(38082);var y=r(66262);const b=(0,y.A)(h,[["render",l],["__scopeId","data-v-42e1c96a"]]),v=b},52444:(e,t,r)=>{var a=r(47914);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals);var s=r(99548).A;s("9039d31c",a,!0,{sourceMap:!1,shadowMode:!1})},38082:(e,t,r)=>{var a=r(28852);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals);var s=r(99548).A;s("87262d44",a,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=dialog4.276571f0.js.map