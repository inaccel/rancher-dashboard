{"version":3,"sources":["webpack:///./shell/components/AssignTo.vue","webpack:///shell/components/AssignTo.vue","webpack:///./shell/components/AssignTo.vue?f8da","webpack:///./shell/components/AssignTo.vue?a244","webpack:///./shell/components/AssignTo.vue?e2c9","webpack:///./shell/components/PromptRemove.vue","webpack:///shell/components/PromptRemove.vue","webpack:///./shell/components/PromptRemove.vue?ea09","webpack:///./shell/components/PromptRemove.vue?7e16","webpack:///./shell/components/PromptRemove.vue?3c3c","webpack:///./shell/components/AssignTo.vue?8c65","webpack:///./shell/components/PromptRemove.vue?77de","webpack:///./shell/components/PromptRemove.vue?00ff","webpack:///./shell/components/AssignTo.vue?fd25"],"names":["render","_vm","this","_c","_self","showModal","staticClass","attrs","on","close","loaded","directives","name","rawName","value","t","count","resourceCount","expression","slot","_v","workspaceOptions","model","moveTo","callback","$$v","key","labels","_l","errors","err","i","_s","apply","_e","staticRenderFns","components","Card","LabeledSelect","KeyValue","AsyncButton","Banner","AppModal","data","workspace","allWorkspaces","computed","_objectSpread","mapState","mapGetters","out","map","x","_x$metadata","metadata","filter","_this$toAssign","toAssign","length","watch","showAssignTo","show","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","next","$store","dispatch","type","NORMAN","CLUSTER","FLEET","WORKSPACE","sent","stop","methods","commit","buttonDone","_this2","_callee2","promises","_iterator","_step","fleetCluster","c","_i","_Object$keys","k","_context2","_createForOfIteratorHelper","s","n","done","resource","norman","abrupt","fleetWorkspaceName","Object","keys","_labels","set","push","save","t0","e","f","finish","Promise","all","t1","exceptionToErrorsArray","component","___CSS_LOADER_API_IMPORT___","exports","module","scopedSlots","_u","fn","deleteDisabled","componentTestid","remove","proxy","hasCustomRemove","resourceNames","names","plusMore","removeComponent","_b","ref","tag","needsConfirm","toRemove","doneLocation","error","_data","nameToMatch","escapeHtml","confirmName","warning","protip","chartsToRemoveIsApp","chartAddCrdToRemove","chartsDeleteCrd","Checkbox","LabeledInput","props","String","default","$route","params","randomPosition","Math","random","preventDelete","getters","obj","nameDisplay","slice","nameToMatchPosition","visibleNames","min","randomNamePos","floor","_this$toRemove$","types","Set","reduce","array","each","size","schema","concat","selfLinks","get","first","confirmRemove","remaining","_this$toRemove$2","_this$toRemove$2$meta","doneLocationRemove","currentRoute","id","_currentRoute$name","idIndex","indexOf","namespace","namespaceIndex","currentRouter","alternateLabel","confirmFailed","showPromptRemove","_this$currentRouter","_this$currentRouter$c","_selected$spec","_selected$spec$chart","_selected$spec$chart$","selected","CATALOG","APP","spec","chart","annotations","CATALOG_ANNOTATIONS","AUTO_INSTALL","neu","message","preventDeletionMessages","item","preventDeletionMessage","warnDeletionMessages","warnDeletionMessage","btnCB","_this$$refs","_this$$refs$customPro","handled","serialRemove","cachedDoneLocation","$refs","customPrompt","then","undefined","some","removeSerially","parallelRemove","spoofedTypes","getSpoofedTypes","refreshSpoofedTypes","_this3","_callee3","_context3","bulkRemove","isEmpty","resources","uniqueResourceTypes","uniq","_this4","inStore","opt","force","root","_this5","_callee4","res","_context4","relatedResourcesToRemove","includes","pop","content","__esModule","locals","add"],"mappings":"kHAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAQF,EAAII,UAAWF,EAAG,YAAY,CAACG,YAAY,eAAeC,MAAM,CAAC,KAAO,WAAW,OAAS,2FAA2F,OAAS,OAAO,YAAa,GAAMC,GAAG,CAAC,MAAQP,EAAIQ,QAAQ,CAAER,EAAIS,OAAQP,EAAG,OAAO,CAACI,MAAM,CAAC,yBAAwB,IAAQ,CAACJ,EAAG,KAAK,CAACQ,WAAW,CAAC,CAACC,KAAK,aAAaC,QAAQ,eAAeC,MAAOb,EAAIc,EAAE,iBAAkB,CAACC,MAAOf,EAAIgB,gBAAgB,GAAOC,WAAW,sDAAsDZ,YAAY,oBAAoBC,MAAM,CAAC,KAAO,SAASY,KAAK,UAAUlB,EAAImB,GAAG,KAAKjB,EAAG,MAAM,CAACG,YAAY,cAAcC,MAAM,CAAC,KAAO,QAAQY,KAAK,QAAQ,CAAChB,EAAG,OAAO,CAACA,EAAG,gBAAgB,CAACI,MAAM,CAAC,MAAQN,EAAIc,EAAE,sBAAsB,QAAUd,EAAIoB,iBAAiB,UAAY,UAAUC,MAAM,CAACR,MAAOb,EAAIsB,OAAQC,SAAS,SAAUC,GAAMxB,EAAIsB,OAAOE,GAAKP,WAAW,YAAYjB,EAAImB,GAAG,KAAKjB,EAAG,WAAW,CAACuB,IAAI,SAASpB,YAAY,QAAQC,MAAM,CAAC,YAAYN,EAAIc,EAAE,sBAAsB,gBAAe,GAAOO,MAAM,CAACR,MAAOb,EAAI0B,OAAQH,SAAS,SAAUC,GAAMxB,EAAI0B,OAAOF,GAAKP,WAAW,YAAYjB,EAAImB,GAAG,KAAKnB,EAAI2B,GAAI3B,EAAI4B,QAAQ,SAASC,EAAIC,GAAG,OAAO5B,EAAG,SAAS,CAACuB,IAAIK,EAAExB,MAAM,CAAC,MAAQ,QAAQ,MAAQuB,SAAU,KAAK7B,EAAImB,GAAG,KAAKjB,EAAG,MAAM,CAACI,MAAM,CAAC,KAAO,WAAWY,KAAK,WAAW,CAAChB,EAAG,SAAS,CAACG,YAAY,qBAAqBE,GAAG,CAAC,MAAQP,EAAIQ,QAAQ,CAACR,EAAImB,GAAG,aAAanB,EAAI+B,GAAG/B,EAAIc,EAAE,mBAAmB,cAAcd,EAAImB,GAAG,KAAKjB,EAAG,cAAc,CAACI,MAAM,CAAC,KAAO,SAASC,GAAG,CAAC,MAAQP,EAAIgC,UAAU,KAAKhC,EAAIiC,MAAM,GAAGjC,EAAIiC,MAEziDC,EAAkB,G,g8DCUP,OACfC,WAAA,CACAC,YACAC,qBACAC,gBACAC,mBACAC,cACAC,iBAGAC,KAAA,WACA,OACAd,OAAA,GACAF,OAAA,GACAJ,OAAA,KAAAqB,UACAlC,QAAA,EACAmC,cAAA,GACAxC,WAAA,IAIAyC,SAAAC,QAAA,GACAC,eAAA,4CACAC,eAAA,CAAAlC,EAAA,YACAkC,eAAA,oBAEA5B,iBAAA,WACA,IAAA6B,EAAA,KAAAL,cAAAM,KAAA,SAAAC,GAAA,IAAAC,EAAA,eAAAA,EAAAD,EAAAE,gBAAA,IAAAD,OAAA,EAAAA,EAAAzC,QAAA2C,QAAA,SAAAH,GAAA,QAAAA,GAAA,gBAAAA,KAEA,OAAAF,GAGAjC,cAAA,eAAAuC,EACA,eAAAA,EAAA,KAAAC,gBAAA,IAAAD,OAAA,EAAAA,EAAAE,SAAA,KAIAC,MAAA,CACAC,aAAA,SAAAC,GAAA,IAAAC,EAAA,YAAAC,eAAAC,IAAAC,MAAA,SAAAC,IAAA,OAAAF,IAAAG,MAAA,SAAAC,GAAA,eAAAA,EAAAC,KAAAD,EAAAE,MAAA,WACAT,EAAA,CAAAO,EAAAE,KAAA,gBAAAF,EAAAE,KAAA,EACAR,EAAAS,OAAAC,SAAA,mBAAAC,KAAAC,OAAAC,UAAA,cAAAP,EAAAE,KAAA,EACAR,EAAAS,OAAAC,SAAA,sBAAAC,KAAAG,OAAAC,YAAA,OAAAf,EAAAjB,cAAAuB,EAAAU,KACAhB,EAAAvC,OAAAuC,EAAAlB,UACAkB,EAAApD,QAAA,EACAoD,EAAAzD,WAAA,EAAA+D,EAAAE,KAAA,iBAEAR,EAAAzD,WAAA,2BAAA+D,EAAAW,UAAAb,MARAH,KAaAiB,QAAA,CACAvE,MAAA,WACA,KAAAoB,OAAA,GACA,KAAAF,OAAA,GACA,KAAAJ,OAAA,KAAAqB,UACA,KAAA2B,OAAAU,OAAA,+BAGAhD,MAAA,SAAAiD,GAAA,IAAAC,EAAA,YAAApB,eAAAC,IAAAC,MAAA,SAAAmB,IAAA,IAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAAA5B,IAAAG,MAAA,SAAA0B,GAAA,eAAAA,EAAAxB,KAAAwB,EAAAvB,MAAA,OACAe,EAAA,GAEAF,EAAAtD,OAAA,GAAAyD,EAAAQ,EAEAX,EAAA1B,UAAAoC,EAAAxB,KAAA,EAAAiB,EAAAS,IAAA,WAAAR,EAAAD,EAAAU,KAAAC,KAAA,CAAAJ,EAAAvB,KAAA,gBAAAkB,EAAAD,EAAAzE,MAAA+E,EAAAvB,KAAA,EACAa,EAAAZ,OAAAC,SAAA,iBAAA0B,SAAAV,EAAAW,SAAA,UAAAV,EAAAI,EAAAf,KAEAW,EAAA,CAAAI,EAAAvB,KAAA,gBAAAuB,EAAAO,OAAA,uBAMA,IAFAX,EAAAY,mBAAAlB,EAAA5D,OAEAmE,EAAA,EAAAC,EAAAW,OAAAC,KAAApB,EAAAxD,QAAA+D,EAAAC,EAAAjC,OAAAgC,IAAAE,EAAAD,EAAAD,GACAD,EAAAe,SACAC,iBAAAhB,EAAA,cAGAgB,iBAAAhB,EAAAe,QAAAZ,EAAAT,EAAAxD,OAAAiE,IAGAP,EAAAqB,KAAAjB,EAAAkB,QAAA,QAAAd,EAAAvB,KAAA,gBAAAuB,EAAAvB,KAAA,iBAAAuB,EAAAxB,KAAA,GAAAwB,EAAAe,GAAAf,EAAA,YAAAP,EAAAuB,EAAAhB,EAAAe,IAAA,eAAAf,EAAAxB,KAAA,GAAAiB,EAAAwB,IAAAjB,EAAAkB,OAAA,mBAAAlB,EAAAxB,KAAA,GAAAwB,EAAAvB,KAAA,GAIA0C,QAAAC,IAAA5B,GAAA,QACAH,GAAA,GACAC,EAAA1E,QAAAoF,EAAAvB,KAAA,iBAAAuB,EAAAxB,KAAA,GAAAwB,EAAAqB,GAAArB,EAAA,aAEAV,EAAAtD,OAAAsF,eAAAtB,EAAAqB,IACAhC,GAAA,4BAAAW,EAAAd,UAAAK,EAAA,gCA/BArB,MCvE8U,I,wBCQ1UqD,EAAY,eACd,EACApH,EACAmC,GACA,EACA,KACA,KACA,MAIa,OAAAiF,E,gCClBf,IAAIC,EAA8B,EAAQ,QAC1CC,EAAUD,GAA4B,GAEtCC,EAAQZ,KAAK,CAACa,EAAOxF,EAAI,qJAAsJ,KAE/KwF,EAAOD,QAAUA,G,oCCNjB,IAAItH,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAQF,EAAII,UAAWF,EAAG,YAAY,CAACI,MAAM,CAAC,eAAe,eAAe,KAAO,eAAe,MAAQ,IAAI,OAAS,OAAO,OAAS,sBAAsBC,GAAG,CAAC,MAAQP,EAAIQ,QAAQ,CAACN,EAAG,OAAO,CAACG,YAAY,gBAAgBC,MAAM,CAAC,yBAAwB,GAAOiH,YAAYvH,EAAIwH,GAAG,CAAC,CAAC/F,IAAI,UAAUgG,GAAG,WAAW,MAAO,CAACvH,EAAG,SAAS,CAACG,YAAY,qBAAqBE,GAAG,CAAC,MAAQP,EAAIQ,QAAQ,CAACR,EAAImB,GAAG,aAAanB,EAAI+B,GAAG/B,EAAIc,EAAE,mBAAmB,cAAcd,EAAImB,GAAG,KAAKjB,EAAG,MAAM,CAACG,YAAY,WAAWL,EAAImB,GAAG,KAAKjB,EAAG,cAAc,CAACG,YAAY,qBAAqBC,MAAM,CAAC,KAAO,SAAS,SAAWN,EAAI0H,eAAe,cAAc1H,EAAI2H,gBAAkB,mBAAmBpH,GAAG,CAAC,MAAQP,EAAI4H,YAAYC,OAAM,IAAO,MAAK,EAAM,aAAa,CAAC3H,EAAG,KAAK,CAACG,YAAY,oBAAoBC,MAAM,CAAC,KAAO,SAASY,KAAK,SAAS,CAAClB,EAAImB,GAAG,WAAWnB,EAAI+B,GAAG/B,EAAIc,EAAE,uBAAuB,YAAYd,EAAImB,GAAG,KAAKjB,EAAG,MAAM,CAACI,MAAM,CAAC,KAAO,QAAQY,KAAK,QAAQ,CAAChB,EAAG,MAAM,CAACG,YAAY,SAAS,CAAGL,EAAI8H,gBAAiS9H,EAAIiC,KAApR,CAACjC,EAAImB,GAAG,eAAenB,EAAI+B,GAAG/B,EAAIc,EAAE,kCAAmC,CAAE0D,KAAMxE,EAAIwE,QAAS,KAAKtE,EAAG,OAAO,CAACQ,WAAW,CAAC,CAACC,KAAK,aAAaC,QAAQ,eAAeC,MAAOb,EAAI+H,cAAc/H,EAAIgI,MAAOhI,EAAIiI,SAAUjI,EAAIc,GAAIG,WAAW,yCAAkDjB,EAAImB,GAAG,KAAK,CAAEnB,EAAI8H,gBAAiB5H,EAAGF,EAAIkI,gBAAgBlI,EAAImI,GAAG,CAACC,IAAI,eAAeC,IAAI,YAAY/H,MAAM,CAAC,MAAQN,EAAIQ,MAAM,gBAAgBR,EAAIsI,aAAa,MAAQtI,EAAIuI,SAAS,MAAQvI,EAAIgI,MAAM,KAAOhI,EAAIwE,KAAK,gBAAgBxE,EAAIwI,cAAcjI,GAAG,CAAC,OAAS,SAAAqG,GAAC,OAAI5G,EAAIyI,MAAQ7B,GAAE,KAAO5G,EAAIgG,MAAM3E,MAAM,CAACR,MAAOb,EAAIuI,SAAUhH,SAAS,SAAUC,GAAMxB,EAAIuI,SAAS/G,GAAKP,WAAW,aAAa,YAAYjB,EAAI0I,OAAM,IAAQ1I,EAAIiC,KAAKjC,EAAImB,GAAG,KAAMnB,EAAIsI,aAAcpI,EAAG,MAAM,CAACG,YAAY,SAAS,CAACH,EAAG,OAAO,CAACQ,WAAW,CAAC,CAACC,KAAK,aAAaC,QAAQ,eAAeC,MAAOb,EAAIc,EAAE,2BAA4B,CAAE6H,YAAa3I,EAAI4I,WAAW5I,EAAI2I,eAAgB,GAAO1H,WAAW,sFAAsFjB,EAAIiC,OAAO,GAAGjC,EAAImB,GAAG,KAAMnB,EAAIsI,aAAcpI,EAAG,eAAe,CAACQ,WAAW,CAAC,CAACC,KAAK,QAAQC,QAAQ,YAAYN,MAAM,CAAC,GAAK,UAAU,cAAcN,EAAI2H,gBAAkB,SAAS,KAAO,QAAQtG,MAAM,CAACR,MAAOb,EAAI6I,YAAatH,SAAS,SAAUC,GAAMxB,EAAI6I,YAAYrH,GAAKP,WAAW,gBAAgB,CAACf,EAAG,MAAM,CAACG,YAAY,4BAA4B,CAACL,EAAImB,GAAG,eAAenB,EAAI+B,GAAG/B,EAAI8I,SAAS,gBAAgB9I,EAAImB,GAAG,KAAKjB,EAAG,MAAM,CAACG,YAAY,0BAA0B,CAACL,EAAImB,GAAG,eAAenB,EAAI+B,GAAG/B,EAAIyI,OAAO,gBAAgBzI,EAAImB,GAAG,KAAOnB,EAAIsI,aAAiHtI,EAAIiC,KAAvG/B,EAAG,MAAM,CAACG,YAAY,mBAAmB,CAACL,EAAImB,GAAG,eAAenB,EAAI+B,GAAG/B,EAAI+I,QAAQ,gBAAyB/I,EAAImB,GAAG,KAAMnB,EAAIgJ,oBAAqB9I,EAAG,WAAW,CAACG,YAAY,aAAaC,MAAM,CAAC,YAAY,6BAA6BC,GAAG,CAAC,MAAQP,EAAIiJ,qBAAqB5H,MAAM,CAACR,MAAOb,EAAIkJ,gBAAiB3H,SAAS,SAAUC,GAAMxB,EAAIkJ,gBAAgB1H,GAAKP,WAAW,qBAAqBjB,EAAIiC,MAAM,GAAG,CAAC/B,EAAG,MAAM,CAACG,YAAY,4BAA4B,CAACL,EAAImB,GAAG,eAAenB,EAAI+B,GAAG/B,EAAI8I,SAAS,gBAAgB9I,EAAImB,GAAG,KAAKjB,EAAG,MAAM,CAACG,YAAY,0BAA0B,CAACL,EAAImB,GAAG,eAAenB,EAAI+B,GAAG/B,EAAIyI,OAAO,kBAAkB,MAAM,GAAGzI,EAAIiC,MAEltGC,EAAkB,G,spECYP,OACfvB,KAAA,eAEAwB,WAAA,CACAC,YAAA+G,gBAAA5G,mBAAA6G,oBAAA3G,iBAEA4G,MAAA,CAKA1B,gBAAA,CACAnD,KAAA8E,OACAC,QAAA,kBAGA7G,KAAA,WACA,IAAAuD,EAAA,KAAAuD,OAAAC,OAAAxD,SAEA,OACA6B,iBAAA,EACA4B,eAAAC,KAAAC,SACAf,YAAA,GACAJ,MAAA,GACAK,QAAA,GACAe,eAAA,EACA3B,gBAAA,KAAA5D,OAAAwF,QAAA,qCAAA7D,GACA+C,qBAAA,EACAE,iBAAA,EACA9I,WAAA,IAGAyC,SAAAC,IAAA,CACAkF,MAAA,WACA,YAAAO,SAAArF,KAAA,SAAA6G,GAAA,OAAAA,EAAAC,eAAAC,MAAA,MAGAC,oBAAA,WACA,IAAAC,EAAAR,KAAAS,IAAA,OAAApC,MAAAvE,QACA4G,EAAAV,KAAAW,MAAA,KAAAZ,eAAAS,GAEA,OAAAE,GAGA1B,YAAA,WACA,YAAAX,MAAA,KAAAkC,sBAGA1F,KAAA,eAAA+F,EACAC,EAAA,IAAAC,IAAA,KAAAlC,SAAAmC,QAAA,SAAAC,EAAAC,GAGA,OAFAD,EAAAlE,KAAAmE,EAAApG,MAEAmG,IACA,KAEA,GAAAH,EAAAK,KAAA,EACA,YAAA/J,EAAA,oBAAAC,MAAA,KAAAwH,SAAA9E,SAGA,IAAAqH,EAAA,QAAAP,EAAA,KAAAhC,SAAA,cAAAgC,OAAA,EAAAA,EAAAO,OAEA,OAAAA,EAIA,KAAAxG,OAAAwF,QAAA,qBAAAgB,EAAA,KAAAvC,SAAA9E,QAHA,WAAAsH,OAAA,SAAAxC,SAAA9E,OAAA,SAMAuH,UAAA,WACA,YAAAzC,SAAArF,KAAA,SAAA+C,GACA,OAAAgF,iBAAAhF,EAAA,kBAIAqC,aAAA,WACA,IAAA4C,EAAA,KAAA3C,SAAA,GAEA,cAAA2C,QAAA,IAAAA,OAAA,EAAAA,EAAAC,eAGAlD,SAAA,WACA,IAAAmD,EAAA,KAAA7C,SAAA9E,OAAA,KAAAuE,MAAAvE,OAEA,YAAA3C,EAAA,0BAAAC,MAAAqK,KAIA5C,aAAA,eAAA6C,EAAAC,EAEA,QAAA/C,SAAA9E,OAAA,EACA,YAGA,QAAA8E,SAAA,GAAAgD,mBACA,YAAAhD,SAAA,GAAAgD,mBAGA,IAAAC,EAAA,KAAAjD,SAAA,GAAAiD,eACAvI,EAAA,GACAwG,EAAA3G,EAAA,GAAA0I,EAAA/B,QAEA,GAAAA,EAAAgC,KAAAhC,EAAAgC,MAAA,QAAAJ,EAAA,KAAA9C,SAAA,cAAA8C,GAAA,QAAAC,EAAAD,EAAAhI,gBAAA,IAAAiI,OAAA,EAAAA,EAAA3K,OAAA8I,EAAAgC,KAAA,KAAAlD,SAAA,GAAAkD,IAAA,CACA,IAAAC,EAAAF,EAAA7K,YAAA,IAAA+K,EAAA,GAAAA,EAEAC,EAAAhL,EAAAiL,QAAA,OAMA,IAJA,IAAAD,IACAhL,IAAAsJ,MAAA,EAAA0B,IAGAlC,EAAAoC,UAAA,CACA,IAAAC,EAAAnL,EAAAiL,QAAA,eAEA,IAAAE,IACAnL,IAAAsJ,MAAA,EAAA6B,WAEArC,EAAAoC,iBAEApC,EAAAgC,GAEAxI,EAAAwG,SACAxG,EAAAtC,OAGA,OAAAsC,GAGA8I,cAAA,WAEA,YAAAvD,aAGA,KAAAD,SAAA,GAAAwD,gBAFA,MAMAhD,OAAA,WACA,YAAAjI,EAAA,uBAAAkL,yBAGAtE,eAAA,WACA,IAAAuE,EAAA,KAAA3D,cAAA,KAAAO,cAAA,KAAAF,YAEA,YAAAkB,eAAAoC,IAGAlJ,eAAA,gDACAC,eAAA,CAAAlC,EAAA,YAGA4C,MAAA,CACAwI,iBAAA,SAAAtI,GACA,GAAAA,EAAA,KAAAuI,EAAAC,EAAAC,EAAAC,EAAAC,EACAC,EAAA,KAAAjE,SAAA,GAEA,sCAAA4D,EAAA,KAAAJ,qBAAA,IAAAI,GAAA,QAAAC,EAAAD,EAAAX,oBAAA,IAAAY,OAAA,EAAAA,EAAAzL,OACA6L,EAAAhI,OAAAiI,OAAAC,KACA,QADAL,EACAG,EAAAG,YAAA,IAAAN,GAAA,QAAAC,EAAAD,EAAAO,aAAA,IAAAN,GAAA,QAAAC,EAAAD,EAAAjJ,gBAAA,IAAAkJ,KAAAM,YAAAC,OAAAC,gBACA,KAAA/D,qBAAA,GAGA,KAAA5I,WAAA,EAEA,IAAA6F,EAAA,KAAAuD,OAAAC,OAAAxD,SAEA,KAAAsC,SAAA9E,OAAA,IACAwC,EAAAuG,EAAAhI,MAGA,KAAAsD,gBAAA,KAAAxD,OAAAwF,QAAA,kCAAA7D,GAEA,KAAAiC,gBAAA,KAAA5D,OAAAwF,QAAA,qCAAA7D,QAEA,KAAA7F,WAAA,GAMAmI,SAAA,SAAAyE,GACA,IAAAC,EACAC,EAAAF,EAAA1J,QAAA,SAAA6J,GAAA,OAAAA,EAAAC,0BAIA,GAFA,KAAAvD,eAAA,EAEAqD,EAAAzJ,OACA,KAAAoG,eAAA,EACAoD,EAAAC,EAAA,GAAAE,2BACA,CACA,IAAAC,EAAAL,EAAA1J,QAAA,SAAA6J,GAAA,OAAAA,EAAAG,uBAEAD,EAAA5J,SACAwJ,EAAAI,EAAA,GAAAC,qBAIA,KAAAxE,QADA,oBAAAmE,EACAA,EAAA,KAAA1E,UACA0E,GAGA,KAKAlI,QAAA,CACAgD,qBACAa,kBACApI,MAAA,WACA,KAAAqI,YAAA,GACA,KAAAJ,MAAA,GACA,KAAAS,iBAAA,EACA,KAAAF,qBAAA,EACA,KAAA1E,OAAAU,OAAA,mCAGA4C,OAAA,SAAA2F,GAAA,IAAA1J,EAAA,YAAAC,eAAAC,IAAAC,MAAA,SAAAC,IAAA,IAAAuJ,EAAAC,EAAAC,EAAAC,EAAA,OAAA5J,IAAAG,MAAA,SAAAC,GAAA,eAAAA,EAAAC,KAAAD,EAAAE,MAAA,OAIA,GAHAR,EAAA2E,eAEA3E,EAAA+J,mBAAA9K,EAAA,GAAAe,EAAA2E,gBAGA3E,EAAAiE,iBAAA,QAAA0F,EAAA3J,EAAAgK,aAAA,IAAAL,GAAA,QAAAC,EAAAD,EAAAM,oBAAA,IAAAL,MAAA7F,OAAA,CAAAzD,EAAAE,KAAA,SAGA,GAFAqJ,EAAA7J,EAAAgK,MAAAC,aAAAlG,OAAA2F,IAGAG,MAAAK,KAAA,CAAA5J,EAAAE,KAAA,gBAAAF,EAAAC,KAAA,EAAAD,EAAAE,KAAA,EAEAqJ,EAAA,OAAAA,EAAAvJ,EAAAU,KAAAV,EAAAE,KAAA,iBAGA,OAHAF,EAAAC,KAAA,GAAAD,EAAAwC,GAAAxC,EAAA,YAEAN,EAAA4E,MAAAtE,EAAAwC,GACA4G,GAAA,GAAApJ,EAAAgC,OAAA,0BAUA6H,IAAAN,MAAA,CAAAvJ,EAAAE,KAAA,gBAAAF,EAAAgC,OAAA,kBAIAwH,EAAA9J,EAAA0E,SAAA0F,MAAA,SAAAhI,GAAA,OAAAA,EAAAiI,kBAEAP,EACA9J,EAAA8J,aAAAJ,GAEA1J,EAAAsK,eAAAZ,GACA,yBAAApJ,EAAAW,UAAAb,EAAA,kBAnCAH,IAqCA6J,aAAA,SAAAJ,GAAA,IAAArI,EAAA,YAAApB,eAAAC,IAAAC,MAAA,SAAAmB,IAAA,IAAAiJ,EAAA/I,EAAAC,EAAAW,EAAA,OAAAlC,IAAAG,MAAA,SAAA0B,GAAA,eAAAA,EAAAxB,KAAAwB,EAAAvB,MAAA,OAAAuB,EAAAxB,KAAA,EAEAgK,EAAAlJ,EAAAmJ,gBAAAnJ,EAAAqD,UAAAlD,EAAAQ,EAEAX,EAAAqD,UAAA3C,EAAAxB,KAAA,EAAAiB,EAAAS,IAAA,WAAAR,EAAAD,EAAAU,KAAAC,KAAA,CAAAJ,EAAAvB,KAAA,gBAAA4B,EAAAX,EAAAzE,MAAA+E,EAAAvB,KAAA,EACA4B,EAAA2B,SAAA,OAAAhC,EAAAvB,KAAA,gBAAAuB,EAAAvB,KAAA,iBAAAuB,EAAAxB,KAAA,GAAAwB,EAAAe,GAAAf,EAAA,YAAAP,EAAAuB,EAAAhB,EAAAe,IAAA,eAAAf,EAAAxB,KAAA,GAAAiB,EAAAwB,IAAAjB,EAAAkB,OAAA,mBAAAlB,EAAAvB,KAAA,GAGAa,EAAAoJ,oBAAAF,GAAA,QACAlJ,EAAAc,OAAAJ,EAAAvB,KAAA,iBAAAuB,EAAAxB,KAAA,GAAAwB,EAAAqB,GAAArB,EAAA,YAEAV,EAAAuD,MAAA7C,EAAAqB,GAAAgG,SAAArH,EAAAqB,GACAsG,GAAA,4BAAA3H,EAAAd,UAAAK,EAAA,+BAZArB,IAeAqK,eAAA,SAAAZ,GAAA,IAAAgB,EAAA,YAAAzK,eAAAC,IAAAC,MAAA,SAAAwK,IAAA,IAAAJ,EAAA,OAAArK,IAAAG,MAAA,SAAAuK,GAAA,eAAAA,EAAArK,KAAAqK,EAAApK,MAAA,UAAAoK,EAAArK,KAAA,EAEA,qBAAAmK,EAAAhG,SAAA,GAAAmG,WAAA,CAAAD,EAAApK,KAAA,eAAAoK,EAAApK,KAAA,EACAkK,EAAAhG,SAAA,GAAAmG,WAAAH,EAAAhG,SAAA,WAAAkG,EAAApK,KAAA,sBAAAoK,EAAApK,KAAA,EAEA0C,QAAAC,IAAAuH,EAAAhG,SAAArF,KAAA,SAAA+C,GAAA,OAAAA,EAAA2B,aAAA,OAGA,OAAAwG,EAAAG,EAAAF,gBAAAE,EAAAhG,UAAAkG,EAAApK,KAAA,GAEAkK,EAAAD,oBAAAF,GAAA,QAEAG,EAAAvI,OAAAyI,EAAApK,KAAA,iBAAAoK,EAAArK,KAAA,GAAAqK,EAAA9H,GAAA8H,EAAA,YAEAF,EAAA9F,MAAAgG,EAAA9H,GAAAsG,SAAAwB,EAAA9H,GACA4G,GAAA,4BAAAkB,EAAA3J,UAAA0J,EAAA,kBAfA1K,IAkBAkC,KAAA,WACA,KAAA4H,qBAAAe,qBAAA,KAAAf,qBACA,KAAA7B,cAAAtF,KAAA,KAAAmH,oBAEA,KAAApN,SAEA6N,gBAAA,SAAAO,GACA,IAAAC,EAAAC,eAAA,KAAAvG,SAAArF,KAAA,SAAA+C,GAAA,OAAAA,EAAAzB,SAEA,OAAAqK,EAAAvL,OAAA,KAAAgB,OAAAwF,QAAA,wBAIAwE,oBAAA,SAAA9D,GAAA,IAAAuE,EAAA,KACAC,EAAA,KAAA1K,OAAAwF,QAAA,kBAAAkF,QACA5J,EAAAoF,EAAAtH,KAAA,SAAAsB,GAAA,OAAAuK,EAAAzK,OAAAC,SAAA,GAAAwG,OAAAiE,EAAA,aAAAxK,OAAAyK,IAAA,CAAAC,OAAA,KAAAC,MAAA,OAEA,OAAApI,QAAAC,IAAA5B,IAGA6D,oBAAA,eAAAmG,EAAA,YAAAtL,eAAAC,IAAAC,MAAA,SAAAqL,IAAA,IAAAC,EAAA,OAAAvL,IAAAG,MAAA,SAAAqL,GAAA,eAAAA,EAAAnL,KAAAmL,EAAAlL,MAAA,cAAAkL,EAAAnL,KAAA,EAAAmL,EAAAlL,KAAA,EAEA+K,EAAA7G,SAAA,GAAAiH,2BAAA,OAAAF,EAAAC,EAAA1K,KAEAuK,EAAA7G,SAAAkH,SAAAH,GAEAF,EAAAlG,iBACAkG,EAAA7G,SAAAmH,IAAAJ,GAFAF,EAAA7G,SAAA9B,KAAA6I,GAGAC,EAAAlL,KAAA,gBAAAkL,EAAAnL,KAAA,EAAAmL,EAAA5I,GAAA4I,EAAA,YAEAH,EAAA3G,MAAA8G,EAAA5I,GACAyI,EAAAlG,iBAAA,2BAAAqG,EAAAzK,UAAAuK,EAAA,iBAXAvL,MChUkV,I,wBCQ9UqD,EAAY,eACd,EACApH,EACAmC,GACA,EACA,KACA,KACA,MAIa,OAAAiF,E,gCClBf,IAAIC,EAA8B,EAAQ,QAC1CC,EAAUD,GAA4B,GAEtCC,EAAQZ,KAAK,CAACa,EAAOxF,EAAI,kOAAmO,KAE5PwF,EAAOD,QAAUA,G,oCCNjB,W,qBCGA,IAAIsI,EAAU,EAAQ,QACnBA,EAAQC,aAAYD,EAAUA,EAAQpG,SACnB,kBAAZoG,IAAsBA,EAAU,CAAC,CAACrI,EAAOxF,EAAI6N,EAAS,MAC7DA,EAAQE,SAAQvI,EAAOD,QAAUsI,EAAQE,QAE5C,IAAIC,EAAM,EAAQ,QAA+DvG,QACpEuG,EAAI,WAAYH,GAAS,EAAM,CAAC,WAAY,EAAM,YAAa,K,kCCT5E,W,qBCGA,IAAIA,EAAU,EAAQ,QACnBA,EAAQC,aAAYD,EAAUA,EAAQpG,SACnB,kBAAZoG,IAAsBA,EAAU,CAAC,CAACrI,EAAOxF,EAAI6N,EAAS,MAC7DA,EAAQE,SAAQvI,EAAOD,QAAUsI,EAAQE,QAE5C,IAAIC,EAAM,EAAQ,QAA+DvG,QACpEuG,EAAI,WAAYH,GAAS,EAAM,CAAC,WAAY,EAAM,YAAa","file":"js/chunk-00566044.0b0ce063.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return (_vm.showModal)?_c('app-modal',{staticClass:\"assign-modal\",attrs:{\"name\":\"assignTo\",\"styles\":\"background-color: var(--nav-bg); border-radius: var(--border-radius); max-height: 100vh;\",\"height\":\"auto\",\"scrollable\":true},on:{\"close\":_vm.close}},[(_vm.loaded)?_c('Card',{attrs:{\"show-highlight-border\":false}},[_c('h4',{directives:[{name:\"clean-html\",rawName:\"v-clean-html\",value:(_vm.t('assignTo.title', {count: _vm.resourceCount}, true)),expression:\"t('assignTo.title', {count: resourceCount}, true)\"}],staticClass:\"text-default-text\",attrs:{\"slot\":\"title\"},slot:\"title\"}),_vm._v(\" \"),_c('div',{staticClass:\"pl-10 pr-10\",attrs:{\"slot\":\"body\"},slot:\"body\"},[_c('form',[_c('LabeledSelect',{attrs:{\"label\":_vm.t('assignTo.workspace'),\"options\":_vm.workspaceOptions,\"placement\":\"bottom\"},model:{value:(_vm.moveTo),callback:function ($$v) {_vm.moveTo=$$v},expression:\"moveTo\"}}),_vm._v(\" \"),_c('KeyValue',{key:\"labels\",staticClass:\"mt-20\",attrs:{\"add-label\":_vm.t('labels.addSetLabel'),\"read-allowed\":false},model:{value:(_vm.labels),callback:function ($$v) {_vm.labels=$$v},expression:\"labels\"}}),_vm._v(\" \"),_vm._l((_vm.errors),function(err,i){return _c('Banner',{key:i,attrs:{\"color\":\"error\",\"label\":err}})})],2)]),_vm._v(\" \"),_c('div',{attrs:{\"slot\":\"actions\"},slot:\"actions\"},[_c('button',{staticClass:\"btn role-secondary\",on:{\"click\":_vm.close}},[_vm._v(\"\\n        \"+_vm._s(_vm.t('generic.cancel'))+\"\\n      \")]),_vm._v(\" \"),_c('AsyncButton',{attrs:{\"mode\":\"apply\"},on:{\"click\":_vm.apply}})],1)]):_vm._e()],1):_vm._e()\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<script>\nimport { mapState, mapGetters } from 'vuex';\nimport { FLEET, NORMAN } from '@shell/config/types';\nimport LabeledSelect from '@shell/components/form/LabeledSelect';\nimport KeyValue from '@shell/components/form/KeyValue';\nimport AsyncButton from '@shell/components/AsyncButton';\nimport AppModal from '@shell/components/AppModal.vue';\nimport { Card } from '@components/Card';\nimport { Banner } from '@components/Banner';\nimport { exceptionToErrorsArray } from '@shell/utils/error';\nimport { set } from '@shell/utils/object';\n\nexport default {\n  components: {\n    Card,\n    LabeledSelect,\n    KeyValue,\n    AsyncButton,\n    Banner,\n    AppModal\n  },\n\n  data() {\n    return {\n      errors:        [],\n      labels:        {},\n      moveTo:        this.workspace,\n      loaded:        false,\n      allWorkspaces: [],\n      showModal:     false,\n    };\n  },\n\n  computed: {\n    ...mapState('action-menu', ['showAssignTo', 'toAssign']),\n    ...mapGetters({ t: 'i18n/t' }),\n    ...mapGetters(['workspace']),\n\n    workspaceOptions() {\n      const out = this.allWorkspaces.map((x) => x.metadata?.name).filter((x) => !!x && x !== 'fleet-local');\n\n      return out;\n    },\n\n    resourceCount() {\n      return this.toAssign?.length || 0;\n    }\n  },\n\n  watch: {\n    async showAssignTo(show) {\n      if (show) {\n        await this.$store.dispatch('rancher/findAll', { type: NORMAN.CLUSTER });\n        this.allWorkspaces = await this.$store.dispatch('management/findAll', { type: FLEET.WORKSPACE });\n        this.moveTo = this.workspace;\n        this.loaded = true;\n        this.showModal = true;\n      } else {\n        this.showModal = false;\n      }\n    }\n  },\n\n  methods: {\n    close() {\n      this.errors = [];\n      this.labels = {};\n      this.moveTo = this.workspace;\n      this.$store.commit('action-menu/toggleAssignTo');\n    },\n\n    async apply(buttonDone) {\n      const promises = [];\n\n      this.errors = [];\n\n      for ( const fleetCluster of this.toAssign ) {\n        const c = await this.$store.dispatch(`rancher/clone`, { resource: fleetCluster.norman });\n\n        if ( !c ) {\n          continue;\n        }\n\n        c.fleetWorkspaceName = this.moveTo;\n\n        for ( const k of Object.keys(this.labels) ) {\n          if ( !c._labels ) {\n            set(c, '_labels', {});\n          }\n\n          set(c._labels, k, this.labels[k]);\n        }\n\n        promises.push(c.save());\n      }\n\n      try {\n        await Promise.all(promises);\n        buttonDone(true);\n        this.close();\n      } catch (e) {\n        this.errors = exceptionToErrorsArray(e);\n        buttonDone(false);\n      }\n    }\n  }\n};\n</script>\n\n<template>\n  <app-modal\n    v-if=\"showModal\"\n    class=\"assign-modal\"\n    name=\"assignTo\"\n    styles=\"background-color: var(--nav-bg); border-radius: var(--border-radius); max-height: 100vh;\"\n    height=\"auto\"\n    :scrollable=\"true\"\n    @close=\"close\"\n  >\n    <Card\n      v-if=\"loaded\"\n      :show-highlight-border=\"false\"\n    >\n      <h4\n        slot=\"title\"\n        v-clean-html=\"t('assignTo.title', {count: resourceCount}, true)\"\n        class=\"text-default-text\"\n      />\n\n      <div\n        slot=\"body\"\n        class=\"pl-10 pr-10\"\n      >\n        <form>\n          <LabeledSelect\n            v-model=\"moveTo\"\n            :label=\"t('assignTo.workspace')\"\n            :options=\"workspaceOptions\"\n            placement=\"bottom\"\n          />\n\n          <KeyValue\n            key=\"labels\"\n            v-model=\"labels\"\n            class=\"mt-20\"\n            :add-label=\"t('labels.addSetLabel')\"\n            :read-allowed=\"false\"\n          />\n\n          <Banner\n            v-for=\"(err, i) in errors\"\n            :key=\"i\"\n            color=\"error\"\n            :label=\"err\"\n          />\n        </form>\n      </div>\n\n      <div slot=\"actions\">\n        <button\n          class=\"btn role-secondary\"\n          @click=\"close\"\n        >\n          {{ t('generic.cancel') }}\n        </button>\n\n        <AsyncButton\n          mode=\"apply\"\n          @click=\"apply\"\n        />\n      </div>\n    </Card>\n  </app-modal>\n</template>\n\n<style lang='scss'>\n  .assign-modal {\n    border-radius: var(--border-radius);\n    overflow: scroll;\n    max-height: 100vh;\n    & ::-webkit-scrollbar-corner {\n      background: rgba(0,0,0,0);\n    }\n  }\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--16-0!../../node_modules/babel-loader/lib/index.js??ref--16-1!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./AssignTo.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--16-0!../../node_modules/babel-loader/lib/index.js??ref--16-1!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./AssignTo.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AssignTo.vue?vue&type=template&id=8fdbe1be&\"\nimport script from \"./AssignTo.vue?vue&type=script&lang=js&\"\nexport * from \"./AssignTo.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AssignTo.vue?vue&type=style&index=0&id=8fdbe1be&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/@vue/cli-service/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".assign-modal{border-radius:var(--border-radius);overflow:scroll;max-height:100vh}.assign-modal ::-webkit-scrollbar-corner{background:transparent}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","var render = function render(){var _vm=this,_c=_vm._self._c;return (_vm.showModal)?_c('app-modal',{attrs:{\"custom-class\":\"remove-modal\",\"name\":\"promptRemove\",\"width\":400,\"height\":\"auto\",\"styles\":\"max-height: 100vh;\"},on:{\"close\":_vm.close}},[_c('Card',{staticClass:\"prompt-remove\",attrs:{\"show-highlight-border\":false},scopedSlots:_vm._u([{key:\"actions\",fn:function(){return [_c('button',{staticClass:\"btn role-secondary\",on:{\"click\":_vm.close}},[_vm._v(\"\\n        \"+_vm._s(_vm.t('generic.cancel'))+\"\\n      \")]),_vm._v(\" \"),_c('div',{staticClass:\"spacer\"}),_vm._v(\" \"),_c('AsyncButton',{staticClass:\"btn bg-error ml-10\",attrs:{\"mode\":\"delete\",\"disabled\":_vm.deleteDisabled,\"data-testid\":_vm.componentTestid + '-confirm-button'},on:{\"click\":_vm.remove}})]},proxy:true}],null,false,1347891345)},[_c('h4',{staticClass:\"text-default-text\",attrs:{\"slot\":\"title\"},slot:\"title\"},[_vm._v(\"\\n      \"+_vm._s(_vm.t('promptRemove.title'))+\"\\n    \")]),_vm._v(\" \"),_c('div',{attrs:{\"slot\":\"body\"},slot:\"body\"},[_c('div',{staticClass:\"mb-10\"},[(!_vm.hasCustomRemove)?[_vm._v(\"\\n          \"+_vm._s(_vm.t('promptRemove.attemptingToRemove', { type: _vm.type }))+\" \"),_c('span',{directives:[{name:\"clean-html\",rawName:\"v-clean-html\",value:(_vm.resourceNames(_vm.names, _vm.plusMore, _vm.t)),expression:\"resourceNames(names, plusMore, t)\"}]})]:_vm._e(),_vm._v(\" \"),[(_vm.hasCustomRemove)?_c(_vm.removeComponent,_vm._b({ref:\"customPrompt\",tag:\"component\",attrs:{\"close\":_vm.close,\"needs-confirm\":_vm.needsConfirm,\"value\":_vm.toRemove,\"names\":_vm.names,\"type\":_vm.type,\"done-location\":_vm.doneLocation},on:{\"errors\":e => _vm.error = e,\"done\":_vm.done},model:{value:(_vm.toRemove),callback:function ($$v) {_vm.toRemove=$$v},expression:\"toRemove\"}},'component',_vm._data,false)):_vm._e(),_vm._v(\" \"),(_vm.needsConfirm)?_c('div',{staticClass:\"mt-10\"},[_c('span',{directives:[{name:\"clean-html\",rawName:\"v-clean-html\",value:(_vm.t('promptRemove.confirmName', { nameToMatch: _vm.escapeHtml(_vm.nameToMatch) }, true)),expression:\"t('promptRemove.confirmName', { nameToMatch: escapeHtml(nameToMatch) }, true)\"}]})]):_vm._e()]],2),_vm._v(\" \"),(_vm.needsConfirm)?_c('LabeledInput',{directives:[{name:\"focus\",rawName:\"v-focus\"}],attrs:{\"id\":\"confirm\",\"data-testid\":_vm.componentTestid + '-input',\"type\":\"text\"},model:{value:(_vm.confirmName),callback:function ($$v) {_vm.confirmName=$$v},expression:\"confirmName\"}},[_c('div',{staticClass:\"text-warning mb-10 mt-10\"},[_vm._v(\"\\n          \"+_vm._s(_vm.warning)+\"\\n        \")]),_vm._v(\" \"),_c('div',{staticClass:\"text-error mb-10 mt-10\"},[_vm._v(\"\\n          \"+_vm._s(_vm.error)+\"\\n        \")]),_vm._v(\" \"),(!_vm.needsConfirm)?_c('div',{staticClass:\"text-info mt-20\"},[_vm._v(\"\\n          \"+_vm._s(_vm.protip)+\"\\n        \")]):_vm._e(),_vm._v(\" \"),(_vm.chartsToRemoveIsApp)?_c('Checkbox',{staticClass:\"mt-10 type\",attrs:{\"label-key\":\"promptRemoveApp.removeCrd\"},on:{\"input\":_vm.chartAddCrdToRemove},model:{value:(_vm.chartsDeleteCrd),callback:function ($$v) {_vm.chartsDeleteCrd=$$v},expression:\"chartsDeleteCrd\"}}):_vm._e()],1):[_c('div',{staticClass:\"text-warning mb-10 mt-10\"},[_vm._v(\"\\n          \"+_vm._s(_vm.warning)+\"\\n        \")]),_vm._v(\" \"),_c('div',{staticClass:\"text-error mb-10 mt-10\"},[_vm._v(\"\\n          \"+_vm._s(_vm.error)+\"\\n        \")])]],2)])],1):_vm._e()\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<script>\nimport { mapState, mapGetters } from 'vuex';\nimport { get, isEmpty } from '@shell/utils/object';\nimport { escapeHtml, resourceNames } from '@shell/utils/string';\nimport { Card } from '@components/Card';\nimport { Checkbox } from '@components/Form/Checkbox';\nimport { alternateLabel } from '@shell/utils/platform';\nimport { uniq } from '@shell/utils/array';\nimport AsyncButton from '@shell/components/AsyncButton';\nimport { CATALOG as CATALOG_ANNOTATIONS } from '@shell/config/labels-annotations';\nimport { CATALOG } from '@shell/config/types';\nimport { LabeledInput } from '@components/Form/LabeledInput';\nimport AppModal from '@shell/components/AppModal.vue';\n\nexport default {\n  name: 'PromptRemove',\n\n  components: {\n    Card, Checkbox, AsyncButton, LabeledInput, AppModal\n  },\n  props: {\n    /**\n     * Inherited global identifier prefix for tests\n     * Define a term based on the parent component to avoid conflicts on multiple components\n     */\n    componentTestid: {\n      type:    String,\n      default: 'prompt-remove'\n    }\n  },\n  data() {\n    const { resource } = this.$route.params;\n\n    return {\n      hasCustomRemove:     false,\n      randomPosition:      Math.random(),\n      confirmName:         '',\n      error:               '',\n      warning:             '',\n      preventDelete:       false,\n      removeComponent:     this.$store.getters['type-map/importCustomPromptRemove'](resource),\n      chartsToRemoveIsApp: false,\n      chartsDeleteCrd:     false,\n      showModal:           false,\n    };\n  },\n  computed: {\n    names() {\n      return this.toRemove.map((obj) => obj.nameDisplay).slice(0, 5);\n    },\n\n    nameToMatchPosition() {\n      const visibleNames = Math.min(5, this.names.length);\n      const randomNamePos = Math.floor(this.randomPosition * visibleNames);\n\n      return randomNamePos;\n    },\n\n    nameToMatch() {\n      return this.names[this.nameToMatchPosition];\n    },\n\n    type() {\n      const types = new Set(this.toRemove.reduce((array, each) => {\n        array.push(each.type);\n\n        return array;\n      }, []));\n\n      if (types.size > 1) {\n        return this.t('generic.resource', { count: this.toRemove.length });\n      }\n\n      const schema = this.toRemove[0]?.schema;\n\n      if ( !schema ) {\n        return `resource${ this.toRemove.length === 1 ? '' : 's' }`;\n      }\n\n      return this.$store.getters['type-map/labelFor'](schema, this.toRemove.length);\n    },\n\n    selfLinks() {\n      return this.toRemove.map((resource) => {\n        return get(resource, 'links.self');\n      });\n    },\n\n    needsConfirm() {\n      const first = this.toRemove[0];\n\n      return first?.confirmRemove;\n    },\n\n    plusMore() {\n      const remaining = this.toRemove.length - this.names.length;\n\n      return this.t('promptRemove.andOthers', { count: remaining });\n    },\n\n    // if the current route ends with the ID of the resource being deleted, whatever page this is wont be valid after successful deletion: navigate away\n    doneLocation() {\n      // if deleting more than one resource, this is happening in list view and shouldn't redirect anywhere\n      if (this.toRemove.length > 1) {\n        return null;\n      }\n\n      if (this.toRemove[0].doneLocationRemove) {\n        return this.toRemove[0].doneLocationRemove;\n      }\n\n      const currentRoute = this.toRemove[0].currentRoute();\n      const out = {};\n      const params = { ...currentRoute.params };\n\n      if (params.id && (params.id === this.toRemove[0]?.metadata?.name || params.id === this.toRemove[0].id)) {\n        let { name = '' } = currentRoute;\n\n        const idIndex = name.indexOf('-id');\n\n        if (idIndex !== -1) {\n          name = name.slice(0, idIndex);\n        }\n\n        if (params.namespace) {\n          const namespaceIndex = name.indexOf('-namespace');\n\n          if (namespaceIndex !== -1) {\n            name = name.slice(0, namespaceIndex);\n          }\n          delete params.namespace;\n        }\n        delete params.id;\n\n        out.params = params;\n        out.name = name;\n      }\n\n      return out;\n    },\n\n    currentRouter() {\n      // ...don't need a router if there's no route to go to\n      if (!this.doneLocation) {\n        return null;\n      } else {\n        return this.toRemove[0].currentRouter();\n      }\n    },\n\n    protip() {\n      return this.t('promptRemove.protip', { alternateLabel });\n    },\n\n    deleteDisabled() {\n      const confirmFailed = this.needsConfirm && this.confirmName !== this.nameToMatch;\n\n      return this.preventDelete || confirmFailed;\n    },\n\n    ...mapState('action-menu', ['showPromptRemove', 'toRemove']),\n    ...mapGetters({ t: 'i18n/t' }),\n  },\n\n  watch: {\n    showPromptRemove(show) {\n      if (show) {\n        const selected = this.toRemove[0];\n\n        if (this.currentRouter?.currentRoute?.name === 'c-cluster-explorer-tools' &&\n            selected.type === CATALOG.APP &&\n            selected.spec?.chart?.metadata?.annotations[CATALOG_ANNOTATIONS.AUTO_INSTALL]) {\n          this.chartsToRemoveIsApp = true;\n        }\n\n        this.showModal = true;\n\n        let { resource } = this.$route.params;\n\n        if (this.toRemove.length > 0) {\n          resource = selected.type;\n        }\n\n        this.hasCustomRemove = this.$store.getters['type-map/hasCustomPromptRemove'](resource);\n\n        this.removeComponent = this.$store.getters['type-map/importCustomPromptRemove'](resource);\n      } else {\n        this.showModal = false;\n      }\n    },\n\n    // check for any resources with a deletion prevention message,\n    // if none found (delete is allowed), then check for any resources with a warning message\n    toRemove(neu) {\n      let message;\n      const preventDeletionMessages = neu.filter((item) => item.preventDeletionMessage);\n\n      this.preventDelete = false;\n\n      if (!!preventDeletionMessages.length) {\n        this.preventDelete = true;\n        message = preventDeletionMessages[0].preventDeletionMessage;\n      } else {\n        const warnDeletionMessages = neu.filter((item) => item.warnDeletionMessage);\n\n        if (!!warnDeletionMessages.length) {\n          message = warnDeletionMessages[0].warnDeletionMessage;\n        }\n      }\n      if (typeof message === 'function' ) {\n        this.warning = message(this.toRemove);\n      } else if (!!message) {\n        this.warning = message;\n      } else {\n        this.warning = '';\n      }\n    }\n  },\n\n  methods: {\n    resourceNames,\n    escapeHtml,\n    close() {\n      this.confirmName = '';\n      this.error = '';\n      this.chartsDeleteCrd = false;\n      this.chartsToRemoveIsApp = false;\n      this.$store.commit('action-menu/togglePromptRemove');\n    },\n\n    async remove(btnCB) {\n      if (this.doneLocation) {\n        // doneLocation will recompute to undefined when delete request completes\n        this.cachedDoneLocation = { ...this.doneLocation };\n      }\n\n      if (this.hasCustomRemove && this.$refs?.customPrompt?.remove) {\n        let handled = this.$refs.customPrompt.remove(btnCB);\n\n        // If the response is a promise, then wait for the promise\n        if (handled && handled.then) {\n          try {\n            handled = await handled;\n          } catch (err) {\n            this.error = err;\n            btnCB(false);\n\n            return;\n          }\n        }\n\n        // If the remove function for the custom dialog handled the request, it can return true or not return anything\n        // if it returned false, then it wants us to continue with the deletion logic below - this is useful\n        // where the custom dialog needs to delete additional resources - it handles those and retrurns false to get us\n        // to delete the main resource\n        if (handled === undefined || handled) {\n          return;\n        }\n      }\n      const serialRemove = this.toRemove.some((resource) => resource.removeSerially);\n\n      if (serialRemove) {\n        this.serialRemove(btnCB);\n      } else {\n        this.parallelRemove(btnCB);\n      }\n    },\n    async serialRemove(btnCB) {\n      try {\n        const spoofedTypes = this.getSpoofedTypes(this.toRemove);\n\n        for (const resource of this.toRemove) {\n          await resource.remove();\n        }\n\n        await this.refreshSpoofedTypes(spoofedTypes);\n        this.done();\n      } catch (err) {\n        this.error = err.message || err;\n        btnCB(false);\n      }\n    },\n    async parallelRemove(btnCB) {\n      try {\n        if (typeof this.toRemove[0].bulkRemove !== 'undefined') {\n          await this.toRemove[0].bulkRemove(this.toRemove, {});\n        } else {\n          await Promise.all(this.toRemove.map((resource) => resource.remove()));\n        }\n\n        const spoofedTypes = this.getSpoofedTypes(this.toRemove);\n\n        await this.refreshSpoofedTypes(spoofedTypes);\n\n        this.done();\n      } catch (err) {\n        this.error = err.message || err;\n        btnCB(false);\n      }\n    },\n    done() {\n      if ( this.cachedDoneLocation && !isEmpty(this.cachedDoneLocation) ) {\n        this.currentRouter.push(this.cachedDoneLocation);\n      }\n      this.close();\n    },\n    getSpoofedTypes(resources) {\n      const uniqueResourceTypes = uniq(this.toRemove.map((resource) => resource.type));\n\n      return uniqueResourceTypes.filter(this.$store.getters['type-map/isSpoofed']);\n    },\n\n    // If spoofed we need to reload the values as the server can't have watchers for them.\n    refreshSpoofedTypes(types) {\n      const inStore = this.$store.getters['currentProduct'].inStore;\n      const promises = types.map((type) => this.$store.dispatch(`${ inStore }/findAll`, { type, opt: { force: true } }, { root: true }));\n\n      return Promise.all(promises);\n    },\n\n    async chartAddCrdToRemove() {\n      try {\n        const res = await this.toRemove[0].relatedResourcesToRemove();\n\n        if (!this.toRemove.includes(res)) {\n          this.toRemove.push(res);\n        } else if (!this.chartsDeleteCrd) {\n          this.toRemove.pop(res);\n        }\n      } catch (err) {\n        this.error = err;\n        this.chartsDeleteCrd = false;\n      }\n    }\n  }\n};\n</script>\n\n<template>\n  <app-modal\n    v-if=\"showModal\"\n    custom-class=\"remove-modal\"\n    name=\"promptRemove\"\n    :width=\"400\"\n    height=\"auto\"\n    styles=\"max-height: 100vh;\"\n    @close=\"close\"\n  >\n    <Card\n      class=\"prompt-remove\"\n      :show-highlight-border=\"false\"\n    >\n      <h4\n        slot=\"title\"\n        class=\"text-default-text\"\n      >\n        {{ t('promptRemove.title') }}\n      </h4>\n      <div slot=\"body\">\n        <div class=\"mb-10\">\n          <template v-if=\"!hasCustomRemove\">\n            {{ t('promptRemove.attemptingToRemove', { type }) }} <span\n              v-clean-html=\"resourceNames(names, plusMore, t)\"\n            />\n          </template>\n\n          <template>\n            <component\n              :is=\"removeComponent\"\n              v-if=\"hasCustomRemove\"\n              ref=\"customPrompt\"\n              v-model=\"toRemove\"\n              v-bind=\"_data\"\n              :close=\"close\"\n              :needs-confirm=\"needsConfirm\"\n              :value=\"toRemove\"\n              :names=\"names\"\n              :type=\"type\"\n              :done-location=\"doneLocation\"\n              @errors=\"e => error = e\"\n              @done=\"done\"\n            />\n            <div\n              v-if=\"needsConfirm\"\n              class=\"mt-10\"\n            >\n              <span\n                v-clean-html=\"t('promptRemove.confirmName', { nameToMatch: escapeHtml(nameToMatch) }, true)\"\n              />\n            </div>\n          </template>\n        </div>\n        <LabeledInput\n          v-if=\"needsConfirm\"\n          id=\"confirm\"\n          v-model=\"confirmName\"\n          v-focus\n          :data-testid=\"componentTestid + '-input'\"\n          type=\"text\"\n        >\n          <div class=\"text-warning mb-10 mt-10\">\n            {{ warning }}\n          </div>\n          <div class=\"text-error mb-10 mt-10\">\n            {{ error }}\n          </div>\n          <div\n            v-if=\"!needsConfirm\"\n            class=\"text-info mt-20\"\n          >\n            {{ protip }}\n          </div>\n          <Checkbox\n            v-if=\"chartsToRemoveIsApp\"\n            v-model=\"chartsDeleteCrd\"\n            label-key=\"promptRemoveApp.removeCrd\"\n            class=\"mt-10 type\"\n            @input=\"chartAddCrdToRemove\"\n          />\n        </labeledinput>\n        <template v-else>\n          <div class=\"text-warning mb-10 mt-10\">\n            {{ warning }}\n          </div>\n          <div class=\"text-error mb-10 mt-10\">\n            {{ error }}\n          </div>\n        </template>\n      </div>\n      <template #actions>\n        <button\n          class=\"btn role-secondary\"\n          @click=\"close\"\n        >\n          {{ t('generic.cancel') }}\n        </button>\n        <div class=\"spacer\" />\n        <AsyncButton\n          mode=\"delete\"\n          class=\"btn bg-error ml-10\"\n          :disabled=\"deleteDisabled\"\n          :data-testid=\"componentTestid + '-confirm-button'\"\n          @click=\"remove\"\n        />\n      </template>\n    </Card>\n  </app-modal>\n</template>\n\n<style lang='scss'>\n  .prompt-remove {\n    &.card-container {\n      box-shadow: none;\n    }\n    #confirm {\n      width: 90%;\n      margin-left: 3px;\n    }\n\n    .actions {\n      text-align: right;\n    }\n\n    .card-actions {\n      display: flex;\n\n      .spacer {\n        flex: 1;\n      }\n    }\n  }\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--16-0!../../node_modules/babel-loader/lib/index.js??ref--16-1!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./PromptRemove.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--16-0!../../node_modules/babel-loader/lib/index.js??ref--16-1!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./PromptRemove.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PromptRemove.vue?vue&type=template&id=0fe40a69&\"\nimport script from \"./PromptRemove.vue?vue&type=script&lang=js&\"\nexport * from \"./PromptRemove.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PromptRemove.vue?vue&type=style&index=0&id=0fe40a69&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/@vue/cli-service/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".prompt-remove.card-container{box-shadow:none}.prompt-remove #confirm{width:90%;margin-left:3px}.prompt-remove .actions{text-align:right}.prompt-remove .card-actions{display:flex}.prompt-remove .card-actions .spacer{flex:1}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","export * from \"-!../../node_modules/vue-style-loader/index.js??ref--9-oneOf-1-0!../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-3!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./AssignTo.vue?vue&type=style&index=0&id=8fdbe1be&prod&lang=scss&\"","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-3!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./PromptRemove.vue?vue&type=style&index=0&id=0fe40a69&prod&lang=scss&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"5722fedc\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","export * from \"-!../../node_modules/vue-style-loader/index.js??ref--9-oneOf-1-0!../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-3!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./PromptRemove.vue?vue&type=style&index=0&id=0fe40a69&prod&lang=scss&\"","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-3!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./AssignTo.vue?vue&type=style&index=0&id=8fdbe1be&prod&lang=scss&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"13cd30c4\", content, true, {\"sourceMap\":false,\"shadowMode\":false});"],"sourceRoot":""}